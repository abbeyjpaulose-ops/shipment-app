{"ast":null,"code":"import _asyncToGenerator from \"C:/AppMOBWEB/shipment-app/shipment-front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction ReportsComponent_option_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 19);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const fy_r1 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", fy_r1);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(fy_r1);\n  }\n}\nfunction ReportsComponent_span_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\"Selected: \", ctx_r1.selectedCount, \"\");\n  }\n}\nfunction ReportsComponent_div_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21);\n    i0.ɵɵtext(1, \"Loading invoices...\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ReportsComponent_div_30_tr_21_span_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const c_r6 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(c_r6.consignmentNumber);\n  }\n}\nfunction ReportsComponent_div_30_tr_21_button_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 32);\n    i0.ɵɵlistener(\"click\", function ReportsComponent_div_30_tr_21_button_18_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const inv_r5 = i0.ɵɵnextContext().$implicit;\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.togglePaymentStatus(inv_r5));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const inv_r5 = i0.ɵɵnextContext().$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"cancel\", (inv_r5.status || \"\").toLowerCase() === \"paid\");\n    i0.ɵɵproperty(\"disabled\", ctx_r1.paymentUpdatingId === inv_r5._id || ctx_r1.isDeleted(inv_r5));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", (inv_r5.status || \"\").toLowerCase() === \"paid\" ? \"Payment got cancelled\" : \"Paid\", \" \");\n  }\n}\nfunction ReportsComponent_div_30_tr_21_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 23)(2, \"input\", 27);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ReportsComponent_div_30_tr_21_Template_input_ngModelChange_2_listener($event) {\n      const inv_r5 = i0.ɵɵrestoreView(_r4).$implicit;\n      i0.ɵɵtwoWayBindingSet(inv_r5.selected, $event) || (inv_r5.selected = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\", 28);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\")(12, \"div\", 29);\n    i0.ɵɵtemplate(13, ReportsComponent_div_30_tr_21_span_13_Template, 2, 1, \"span\", 25);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"td\")(15, \"span\", 30);\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"td\");\n    i0.ɵɵtemplate(18, ReportsComponent_div_30_tr_21_button_18_Template, 2, 4, \"button\", 31);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const inv_r5 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtwoWayProperty(\"ngModel\", inv_r5.selected);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.isDeleted(inv_r5));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(inv_r5.invoiceDisplayNumber || inv_r5.invoiceCode || inv_r5.invoiceNumber);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(inv_r5.clientName || \"-\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(inv_r5.clientGSTIN || \"-\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(inv_r5.billingAddress || \"-\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", inv_r5.consignments);\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassProp(\"cancelled\", (inv_r5.status || \"\") === \"cancelled\" || (inv_r5.status || \"\") === \"deleted\");\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", inv_r5.status || \"active\", \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.isDeleted(inv_r5));\n  }\n}\nfunction ReportsComponent_div_30_tr_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 33);\n    i0.ɵɵtext(2, \"No generated invoices found.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ReportsComponent_div_30_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 22)(1, \"table\")(2, \"thead\")(3, \"tr\")(4, \"th\", 23)(5, \"input\", 24);\n    i0.ɵɵlistener(\"change\", function ReportsComponent_div_30_Template_input_change_5_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.toggleAllSelection($event));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"th\");\n    i0.ɵɵtext(7, \"Invoice #\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\");\n    i0.ɵɵtext(9, \"Client\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\");\n    i0.ɵɵtext(11, \"GSTIN\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\");\n    i0.ɵɵtext(13, \"Billing Address\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"th\");\n    i0.ɵɵtext(15, \"Consignments\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"th\");\n    i0.ɵɵtext(17, \"Status\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"th\");\n    i0.ɵɵtext(19, \"Payment\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(20, \"tbody\");\n    i0.ɵɵtemplate(21, ReportsComponent_div_30_tr_21_Template, 19, 11, \"tr\", 25)(22, ReportsComponent_div_30_tr_22_Template, 3, 0, \"tr\", 26);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(21);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.filteredInvoices);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.filteredInvoices.length);\n  }\n}\nfunction ReportsComponent_div_31_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 34)(1, \"div\", 35)(2, \"h3\");\n    i0.ɵɵtext(3, \"Delete selected generated invoices?\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 36)(7, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function ReportsComponent_div_31_Template_button_click_7_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.cancelDelete());\n    });\n    i0.ɵɵtext(8, \"Keep\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"button\", 37);\n    i0.ɵɵlistener(\"click\", function ReportsComponent_div_31_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.confirmDelete());\n    });\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate2(\" This action cannot be reverted. \", ctx_r1.deleteTargets.length, \" invoice\", ctx_r1.deleteTargets.length === 1 ? \"\" : \"s\", \" will be marked as deleted. \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.deleting);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.deleting ? \"Cancelling...\" : \"Confirm delete\", \" \");\n  }\n}\nexport let ReportsComponent = /*#__PURE__*/(() => {\n  class ReportsComponent {\n    constructor(http) {\n      this.http = http;\n      this.invoices = [];\n      this.filteredInvoices = [];\n      this.fiscalYear = '';\n      this.fiscalYearInput = '';\n      this.fiscalYears = [];\n      this.searchText = '';\n      this.categoryFilter = 'all';\n      this.loading = false;\n      this.gstPercent = 0;\n      this.invoiceTemplate = '';\n      this.showDeletePopup = false;\n      this.deleteTargets = [];\n      this.deleting = false;\n      this.paymentUpdatingId = null;\n    }\n    ngOnInit() {\n      this.initFromUrlQuery();\n      this.loadInvoices();\n      this.loadFiscalYears();\n    }\n    initFromUrlQuery() {\n      const params = new URLSearchParams(window.location.search);\n      const invoiceId = String(params.get('invoiceId') || '').trim();\n      const q = String(params.get('q') || '').trim();\n      this.searchText = invoiceId || q || this.searchText;\n    }\n    loadInvoices() {\n      this.loading = true;\n      this.http.get('http://localhost:3000/api/newshipments/generatedInvoices', {\n        params: {\n          fiscalYear: this.fiscalYearInput || ''\n        }\n      }).subscribe({\n        next: res => {\n          this.fiscalYear = res?.fiscalYear || this.fiscalYear;\n          if (!this.fiscalYearInput) {\n            this.fiscalYearInput = this.fiscalYear || '';\n          }\n          this.gstPercent = Number(res?.gstPercent) || 0;\n          this.invoices = Array.isArray(res?.invoices) ? res.invoices : [];\n          this.applyFilters();\n          this.loading = false;\n        },\n        error: err => {\n          console.error('Error loading generated invoices:', err);\n          this.invoices = [];\n          this.filteredInvoices = [];\n          this.loading = false;\n        }\n      });\n    }\n    loadFiscalYears() {\n      this.http.get('http://localhost:3000/api/newshipments/generatedInvoices/years').subscribe({\n        next: res => {\n          this.fiscalYears = Array.isArray(res?.years) ? res.years : [];\n        },\n        error: err => {\n          console.error('Error loading fiscal years:', err);\n          this.fiscalYears = [];\n        }\n      });\n    }\n    applyFilters() {\n      const q = this.searchText.trim().toLowerCase();\n      const category = this.categoryFilter;\n      if (!q) {\n        this.filteredInvoices = (this.invoices || []).filter(inv => category === 'all' || this.getInvoiceCategory(inv) === category);\n        return;\n      }\n      this.filteredInvoices = this.invoices.filter(inv => {\n        if (category !== 'all' && this.getInvoiceCategory(inv) !== category) return false;\n        const matchesHeader = String(inv._id || '').toLowerCase().includes(q) || String(inv.invoiceDisplayNumber || '').toLowerCase().includes(q) || String(inv.invoiceCode || '').toLowerCase().includes(q) || String(inv.invoiceNumber || '').toLowerCase().includes(q) || String(inv.clientName || '').toLowerCase().includes(q) || String(inv.clientGSTIN || '').toLowerCase().includes(q) || String(inv.billingAddress || '').toLowerCase().includes(q);\n        if (matchesHeader) return true;\n        return (inv.consignments || []).some(c => String(c.consignmentNumber || '').toLowerCase().includes(q));\n      });\n    }\n    getInvoiceCategory(inv) {\n      const raw = String(inv?.billingCategory || '').trim().toUpperCase();\n      if (raw === 'B' || raw === 'C') return raw;\n      const code = String(inv?.invoiceDisplayNumber || inv?.invoiceCode || '').trim().toUpperCase();\n      if (code.includes('/B/')) return 'B';\n      if (code.includes('/C/')) return 'C';\n      if (/^\\d{2}B/.test(code)) return 'B';\n      if (/^\\d{2}C/.test(code)) return 'C';\n      return 'B';\n    }\n    get selectedCount() {\n      return this.filteredInvoices.filter(inv => inv.selected).length;\n    }\n    getSelectedInvoices() {\n      return this.filteredInvoices.filter(inv => inv.selected);\n    }\n    hasDeletableSelection() {\n      return this.filteredInvoices.some(inv => inv.selected && !this.isDeleted(inv));\n    }\n    isDeleted(inv) {\n      const status = String(inv?.status || '').trim().toLowerCase();\n      return status === 'deleted' || status === 'cancelled';\n    }\n    toggleAllSelection(event) {\n      const checked = !!event?.target?.checked;\n      this.filteredInvoices.forEach(inv => {\n        if (this.isDeleted(inv)) {\n          inv.selected = false;\n        } else {\n          inv.selected = checked;\n        }\n      });\n    }\n    clearSelection() {\n      this.invoices.forEach(inv => {\n        inv.selected = false;\n      });\n    }\n    openDeletePopupForSelected() {\n      const selected = this.getSelectedInvoices().filter(inv => !this.isDeleted(inv));\n      if (!selected.length) return;\n      this.deleteTargets = selected;\n      this.showDeletePopup = true;\n    }\n    cancelDelete() {\n      this.showDeletePopup = false;\n      this.deleteTargets = [];\n    }\n    confirmDelete() {\n      if (this.deleting) return;\n      const targets = (this.deleteTargets || []).filter(inv => inv?._id && !this.isDeleted(inv));\n      if (!targets.length) {\n        this.cancelDelete();\n        return;\n      }\n      this.deleting = true;\n      let remaining = targets.length;\n      const finalizeOne = () => {\n        remaining -= 1;\n        if (remaining <= 0) {\n          this.deleting = false;\n          this.cancelDelete();\n          this.clearSelection();\n        }\n      };\n      targets.forEach(target => {\n        this.http.put(`http://localhost:3000/api/newshipments/generatedInvoices/${target._id}/cancel`, {}).subscribe({\n          next: res => {\n            const updated = res?.invoice;\n            if (updated?._id) {\n              this.invoices = this.invoices.map(inv => String(inv._id) === String(updated._id) ? {\n                ...inv,\n                ...updated\n              } : inv);\n              this.applyFilters();\n            }\n            finalizeOne();\n          },\n          error: err => {\n            console.error('Error cancelling generated invoice:', err);\n            finalizeOne();\n          }\n        });\n      });\n    }\n    togglePaymentStatus(inv) {\n      if (!inv?._id || this.paymentUpdatingId) return;\n      const current = String(inv.status || '').trim().toLowerCase();\n      const nextStatus = current === 'paid' ? 'Active' : 'Paid';\n      this.paymentUpdatingId = String(inv._id);\n      this.http.put(`http://localhost:3000/api/newshipments/generatedInvoices/${inv._id}/payment-status`, {\n        status: nextStatus\n      }).subscribe({\n        next: res => {\n          const updated = res?.invoice;\n          if (updated?._id) {\n            this.invoices = this.invoices.map(row => String(row._id) === String(updated._id) ? {\n              ...row,\n              ...updated\n            } : row);\n            this.applyFilters();\n          }\n          this.paymentUpdatingId = null;\n        },\n        error: err => {\n          console.error('Error updating payment status:', err);\n          this.paymentUpdatingId = null;\n        }\n      });\n    }\n    printInvoice(inv) {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        try {\n          const template = yield _this.getTemplate();\n          const body = _this.buildInvoiceBody(inv);\n          _this.openPrintWindow(template.replace('{{content}}', body));\n        } catch (err) {\n          console.error('Error loading invoice template:', err);\n        }\n      })();\n    }\n    printAllInvoices() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        yield _this2.printInvoices(_this2.filteredInvoices);\n      })();\n    }\n    printSelectedInvoices() {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        const selected = _this3.getSelectedInvoices();\n        if (!selected.length) return;\n        yield _this3.printInvoices(selected);\n      })();\n    }\n    printInvoices(list) {\n      var _this4 = this;\n      return _asyncToGenerator(function* () {\n        if (!list.length) {\n          return;\n        }\n        try {\n          const template = yield _this4.getTemplate();\n          const pages = list.map(inv => _this4.buildInvoiceBody(inv));\n          const body = pages.map((page, idx) => page + (idx < pages.length - 1 ? '<div class=\"page-break\"></div>' : '')).join('');\n          _this4.openPrintWindow(template.replace('{{content}}', body));\n        } catch (err) {\n          console.error('Error loading invoice template:', err);\n        }\n      })();\n    }\n    buildInvoiceBody(inv) {\n      const consignments = inv?.consignments || [];\n      const total = consignments.reduce((sum, c) => sum + Number(c.finalAmount || 0), 0);\n      const chargeKeys = ['odc', 'unloading', 'docket', 'other', 'ccc', 'consignorDiscount'];\n      const chargeTotals = chargeKeys.reduce((acc, key) => {\n        acc[key] = consignments.reduce((sum, c) => {\n          return sum + Number(c?.charges?.[key] || 0);\n        }, 0);\n        return acc;\n      }, {});\n      const gstAmount = total * (this.gstPercent / 100);\n      const grandTotal = total + gstAmount;\n      const rows = consignments.map((c, idx) => `\n      <tr>\n        <td>${idx + 1}</td>\n        <td>${c.consignmentNumber || ''}</td>\n        <td>${c.consignor || ''}</td>\n        <td>${c.deliveryAddress || ''}</td>\n        <td style=\"text-align:right\">${Number(c.finalAmount || 0).toFixed(2)}</td>\n      </tr>\n    `).join('');\n      const chargesList = chargeKeys.map(key => `\n      <div>${key}: ${Number(chargeTotals[key] || 0).toFixed(2)}</div>\n    `).join('');\n      return `\n      <h2>Invoice #${inv.invoiceDisplayNumber || inv.invoiceCode || inv.invoiceNumber || ''}</h2>\n      <div class=\"meta\">\n        <div>Client: ${inv.clientName || ''}</div>\n        <div>GSTIN: ${inv.clientGSTIN || ''}</div>\n        <div>Billing Address: ${inv.billingAddress || ''}</div>\n        <div>GST Percent: ${this.gstPercent}%</div>\n      </div>\n      <table>\n        <thead>\n          <tr>\n            <th>#</th>\n            <th>Consignment</th>\n            <th>Consignor</th>\n            <th>Delivery Address</th>\n            <th style=\"text-align:right\">Amount</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${rows || '<tr><td colspan=\"5\">No consignments</td></tr>'}\n        </tbody>\n      </table>\n      <div class=\"totals\">\n        <div>Subtotal: ${total.toFixed(2)}</div>\n        <div>GST (${this.gstPercent}%): ${gstAmount.toFixed(2)}</div>\n        <div>Grand Total: ${grandTotal.toFixed(2)}</div>\n      </div>\n      <div class=\"charges\">\n        <div class=\"charges-title\">Charges</div>\n        ${chargesList}\n      </div>\n    `;\n    }\n    getTemplate() {\n      var _this5 = this;\n      return _asyncToGenerator(function* () {\n        if (_this5.invoiceTemplate) return _this5.invoiceTemplate;\n        const res = yield fetch('assets/generated-invoice-template.html');\n        _this5.invoiceTemplate = yield res.text();\n        return _this5.invoiceTemplate;\n      })();\n    }\n    openPrintWindow(html) {\n      const win = window.open('', '_blank');\n      if (win) {\n        win.document.open();\n        win.document.write(html);\n        win.document.close();\n        win.print();\n      }\n    }\n    static {\n      this.ɵfac = function ReportsComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || ReportsComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: ReportsComponent,\n        selectors: [[\"app-reports\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 32,\n        vars: 12,\n        consts: [[1, \"reports-page\"], [1, \"header\"], [1, \"subtitle\"], [1, \"controls\"], [3, \"ngModelChange\", \"ngModel\"], [\"value\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [3, \"ngModelChange\", \"change\", \"ngModel\"], [\"value\", \"all\"], [\"value\", \"B\"], [\"value\", \"C\"], [\"type\", \"text\", \"placeholder\", \"Search by invoice, client, GSTIN, or consignment\", 3, \"ngModelChange\", \"input\", \"ngModel\"], [\"type\", \"button\", 3, \"click\"], [\"type\", \"button\", 3, \"click\", \"disabled\"], [\"type\", \"button\", 1, \"delete-btn\", 3, \"click\", \"disabled\"], [\"class\", \"selected-count\", 4, \"ngIf\"], [\"class\", \"status\", 4, \"ngIf\"], [\"class\", \"table-wrap\", 4, \"ngIf\"], [\"class\", \"popup-overlay\", 4, \"ngIf\"], [3, \"value\"], [1, \"selected-count\"], [1, \"status\"], [1, \"table-wrap\"], [1, \"check-col\"], [\"type\", \"checkbox\", 3, \"change\"], [4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [\"type\", \"checkbox\", 3, \"ngModelChange\", \"ngModel\", \"disabled\"], [1, \"address-cell\"], [1, \"consignment-list\"], [1, \"status-pill\"], [\"type\", \"button\", \"class\", \"payment-btn\", 3, \"cancel\", \"disabled\", \"click\", 4, \"ngIf\"], [\"type\", \"button\", 1, \"payment-btn\", 3, \"click\", \"disabled\"], [\"colspan\", \"8\", 1, \"empty\"], [1, \"popup-overlay\"], [1, \"popup-card\"], [1, \"popup-actions\"], [\"type\", \"button\", 1, \"danger\", 3, \"click\", \"disabled\"]],\n        template: function ReportsComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\")(3, \"h2\");\n            i0.ɵɵtext(4, \"Generated Invoices\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(5, \"p\", 2);\n            i0.ɵɵtext(6);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(7, \"p\", 2);\n            i0.ɵɵtext(8);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(9, \"div\", 3)(10, \"select\", 4);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function ReportsComponent_Template_select_ngModelChange_10_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.fiscalYearInput, $event) || (ctx.fiscalYearInput = $event);\n              return $event;\n            });\n            i0.ɵɵelementStart(11, \"option\", 5);\n            i0.ɵɵtext(12, \"Current Fiscal Year\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(13, ReportsComponent_option_13_Template, 2, 2, \"option\", 6);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(14, \"select\", 7);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function ReportsComponent_Template_select_ngModelChange_14_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.categoryFilter, $event) || (ctx.categoryFilter = $event);\n              return $event;\n            });\n            i0.ɵɵlistener(\"change\", function ReportsComponent_Template_select_change_14_listener() {\n              return ctx.applyFilters();\n            });\n            i0.ɵɵelementStart(15, \"option\", 8);\n            i0.ɵɵtext(16, \"All Categories\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(17, \"option\", 9);\n            i0.ɵɵtext(18, \"B2B\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(19, \"option\", 10);\n            i0.ɵɵtext(20, \"B2C\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(21, \"input\", 11);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function ReportsComponent_Template_input_ngModelChange_21_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.searchText, $event) || (ctx.searchText = $event);\n              return $event;\n            });\n            i0.ɵɵlistener(\"input\", function ReportsComponent_Template_input_input_21_listener() {\n              return ctx.applyFilters();\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(22, \"button\", 12);\n            i0.ɵɵlistener(\"click\", function ReportsComponent_Template_button_click_22_listener() {\n              return ctx.loadInvoices();\n            });\n            i0.ɵɵtext(23, \"Apply FY\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(24, \"button\", 13);\n            i0.ɵɵlistener(\"click\", function ReportsComponent_Template_button_click_24_listener() {\n              return ctx.printSelectedInvoices();\n            });\n            i0.ɵɵtext(25, \"Print\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(26, \"button\", 14);\n            i0.ɵɵlistener(\"click\", function ReportsComponent_Template_button_click_26_listener() {\n              return ctx.openDeletePopupForSelected();\n            });\n            i0.ɵɵtext(27, \" Delete \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(28, ReportsComponent_span_28_Template, 2, 1, \"span\", 15);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(29, ReportsComponent_div_29_Template, 2, 0, \"div\", 16)(30, ReportsComponent_div_30_Template, 23, 2, \"div\", 17);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(31, ReportsComponent_div_31_Template, 11, 4, \"div\", 18);\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(6);\n            i0.ɵɵtextInterpolate1(\"Fiscal Year: \", ctx.fiscalYear || \"Current\", \"\");\n            i0.ɵɵadvance(2);\n            i0.ɵɵtextInterpolate1(\"GST Percent: \", ctx.gstPercent || 0, \"%\");\n            i0.ɵɵadvance(2);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.fiscalYearInput);\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"ngForOf\", ctx.fiscalYears);\n            i0.ɵɵadvance();\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.categoryFilter);\n            i0.ɵɵadvance(7);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.searchText);\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"disabled\", !ctx.selectedCount);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"disabled\", !ctx.hasDeletableSelection());\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngIf\", ctx.selectedCount);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.loading);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", !ctx.loading);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.showDeletePopup);\n          }\n        },\n        dependencies: [CommonModule, i2.NgForOf, i2.NgIf, FormsModule, i3.NgSelectOption, i3.ɵNgSelectMultipleOption, i3.DefaultValueAccessor, i3.CheckboxControlValueAccessor, i3.SelectControlValueAccessor, i3.NgControlStatus, i3.NgModel],\n        styles: [\".reports-page[_ngcontent-%COMP%]{padding:20px;color:#0f172a}.header[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:16px;align-items:center;justify-content:space-between;margin-bottom:16px}.subtitle[_ngcontent-%COMP%]{margin:6px 0 0;color:#64748b;font-size:13px}.controls[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;align-items:center}.controls[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .controls[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:8px 10px;border:1px solid #cbd5f5;border-radius:10px;min-width:280px}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 14px;border-radius:10px;border:1px solid #cbd5f5;background:#fff;cursor:pointer}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{border-color:#2563eb;color:#1e3a8a}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.selected-count[_ngcontent-%COMP%]{font-size:12px;color:#475569}.status[_ngcontent-%COMP%]{padding:12px;background:#f8fafc;border:1px solid #e2e8f0;border-radius:10px}.table-wrap[_ngcontent-%COMP%]{overflow:auto;background:#fff;border:1px solid #e2e8f0;border-radius:12px}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border-bottom:1px solid #e2e8f0;padding:10px 12px;text-align:left;vertical-align:top}.check-col[_ngcontent-%COMP%]{width:38px;text-align:center}th[_ngcontent-%COMP%]{background:#f8fafc;font-weight:600}.address-cell[_ngcontent-%COMP%]{min-width:220px}.consignment-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:6px}.consignment-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:#eef2ff;color:#3730a3;padding:2px 8px;border-radius:999px;font-size:12px}.print-btn[_ngcontent-%COMP%]{padding:6px 12px;border-radius:8px;border:1px solid #2563eb;background:#2563eb;color:#fff;cursor:pointer}.print-btn[_ngcontent-%COMP%]:hover{background:#1e3a8a;border-color:#1e3a8a}.payment-btn[_ngcontent-%COMP%]{padding:6px 12px;border-radius:8px;border:1px solid #0f766e;background:#0f766e;color:#fff;cursor:pointer}.payment-btn[_ngcontent-%COMP%]:hover{background:#115e59;border-color:#115e59}.payment-btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.payment-btn.cancel[_ngcontent-%COMP%]{background:#dc2626;border-color:#dc2626}.payment-btn.cancel[_ngcontent-%COMP%]:hover{background:#b91c1c;border-color:#b91c1c}.delete-btn[_ngcontent-%COMP%]{padding:6px 12px;border-radius:8px;border:1px solid #dc2626;background:#fef2f2;color:#dc2626;cursor:pointer;margin-left:8px}.delete-btn[_ngcontent-%COMP%]:hover{background:#fee2e2}.delete-btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.status-pill[_ngcontent-%COMP%]{display:inline-block;padding:4px 10px;border-radius:999px;background:#eef2ff;color:#3730a3;font-size:12px;text-transform:capitalize}.status-pill.cancelled[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.empty[_ngcontent-%COMP%]{text-align:center;color:#64748b;padding:18px}.popup-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0f172a99;display:flex;align-items:center;justify-content:center;z-index:1100}.popup-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;width:min(420px,90vw);border:1px solid #e2e8f0;box-shadow:0 20px 40px #0f172a40}.popup-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px}.popup-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 16px;color:#475569}.popup-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px}.popup-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 12px;border-radius:8px;border:1px solid #cbd5f5;background:#fff;cursor:pointer}.popup-actions[_ngcontent-%COMP%]   .danger[_ngcontent-%COMP%]{border-color:#dc2626;background:#dc2626;color:#fff}.popup-actions[_ngcontent-%COMP%]   .danger[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}@media (max-width: 700px){.controls[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{min-width:100%}}\"]\n      });\n    }\n  }\n  return ReportsComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}