{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../../../services/branch.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction InvoiceComponent_div_8_tr_20_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\")(2, \"input\", 18);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function InvoiceComponent_div_8_tr_20_Template_input_ngModelChange_2_listener($event) {\n      const inv_r4 = i0.ɵɵrestoreView(_r3).$implicit;\n      i0.ɵɵtwoWayBindingSet(inv_r4.selected, $event) || (inv_r4.selected = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"click\", function InvoiceComponent_div_8_tr_20_Template_input_click_2_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      return i0.ɵɵresetView($event.stopPropagation());\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(3, \"td\", 9);\n    i0.ɵɵlistener(\"click\", function InvoiceComponent_div_8_tr_20_Template_td_click_3_listener() {\n      const inv_r4 = i0.ɵɵrestoreView(_r3).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.openInvoiceDetails(inv_r4));\n    });\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\")(10, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function InvoiceComponent_div_8_tr_20_Template_button_click_10_listener() {\n      const inv_r4 = i0.ɵɵrestoreView(_r3).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.editInvoice(inv_r4));\n    });\n    i0.ɵɵtext(11, \"fo?<,? Edit\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const inv_r4 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"selected\", inv_r4.selected);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtwoWayProperty(\"ngModel\", inv_r4.selected);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.isInvoicePreInvoiced(inv_r4));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(inv_r4.consignmentNumber);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(inv_r4.invoiceStatus);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.getBillingEntity(inv_r4));\n  }\n}\nfunction InvoiceComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"h3\");\n    i0.ɵɵtext(2, \"Consignments\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 8)(4, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function InvoiceComponent_div_8_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.invoiceSelected());\n    });\n    i0.ɵɵtext(5, \"Generate Pre-Invoice\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"table\", 15)(7, \"thead\")(8, \"tr\")(9, \"th\")(10, \"input\", 16);\n    i0.ɵɵlistener(\"change\", function InvoiceComponent_div_8_Template_input_change_10_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.toggleAllDeliveredSelection($event));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"th\");\n    i0.ɵɵtext(12, \"Consignment No.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"th\");\n    i0.ɵɵtext(14, \"Status\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"th\");\n    i0.ɵɵtext(16, \"Billing Entity\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"th\");\n    i0.ɵɵtext(18, \"Actions\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(19, \"tbody\");\n    i0.ɵɵtemplate(20, InvoiceComponent_div_8_tr_20_Template, 12, 7, \"tr\", 17);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(20);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.filteredDelivered);\n  }\n}\nfunction InvoiceComponent_div_19_tr_17_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const c_r5 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\" \", c_r5.consignmentNumber, \" (\", c_r5.taxableValue || 0, \") \");\n  }\n}\nfunction InvoiceComponent_div_19_tr_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtemplate(6, InvoiceComponent_div_19_tr_17_div_6_Template, 2, 2, \"div\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵpipe(12, \"date\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const pre_r6 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(pre_r6.preInvoiceNumber);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.getPreInvoiceBillingEntity(pre_r6));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", pre_r6.consignments);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(9, 5, ctx_r1.getPreInvoiceTaxableTotal(pre_r6), \"1.0-2\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(12, 8, pre_r6.createdAt, \"short\"));\n  }\n}\nfunction InvoiceComponent_div_19_p_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"No pre-invoices found.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction InvoiceComponent_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20)(1, \"div\", 21);\n    i0.ɵɵtext(2, \"Pre-Invoice Records\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"table\", 15)(4, \"thead\")(5, \"tr\")(6, \"th\");\n    i0.ɵɵtext(7, \"Pre-Invoice No.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\");\n    i0.ɵɵtext(9, \"Billing Entity\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\");\n    i0.ɵɵtext(11, \"Consignments (Taxable)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\");\n    i0.ɵɵtext(13, \"Total Taxable\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"th\");\n    i0.ɵɵtext(15, \"Created\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(16, \"tbody\");\n    i0.ɵɵtemplate(17, InvoiceComponent_div_19_tr_17_Template, 13, 11, \"tr\", 22);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(18, InvoiceComponent_div_19_p_18_Template, 2, 0, \"p\", 23);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(17);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.filteredPreInvoices);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.filteredPreInvoices.length);\n  }\n}\nfunction InvoiceComponent_div_20_li_199_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\")(1, \"span\", 37);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 38);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const p_r8 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r8.productName || p_r8.type);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Qty: \", p_r8.quantity || p_r8.amount, \"\");\n  }\n}\nfunction InvoiceComponent_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 24)(1, \"div\", 25)(2, \"button\", 26);\n    i0.ɵɵlistener(\"click\", function InvoiceComponent_div_20_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.closeInvoiceDetails());\n    });\n    i0.ɵɵtext(3, \"\\u00D7\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 27)(5, \"div\")(6, \"h2\");\n    i0.ɵɵtext(7, \"Consignment Details\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\", 28);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"span\", 29);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"div\", 30)(13, \"div\", 31)(14, \"div\", 32);\n    i0.ɵɵtext(15, \"Consignor\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"div\", 33);\n    i0.ɵɵtext(17);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(18, \"div\", 31)(19, \"div\", 32);\n    i0.ɵɵtext(20, \"Consignor GST\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"div\", 33);\n    i0.ɵɵtext(22);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(23, \"div\", 31)(24, \"div\", 32);\n    i0.ɵɵtext(25, \"Consignor Phone\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(26, \"div\", 33);\n    i0.ɵɵtext(27);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(28, \"div\", 31)(29, \"div\", 32);\n    i0.ɵɵtext(30, \"Consignor Address\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(31, \"div\", 33);\n    i0.ɵɵtext(32);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(33, \"div\", 31)(34, \"div\", 32);\n    i0.ɵɵtext(35, \"Consignee\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(36, \"div\", 33);\n    i0.ɵɵtext(37);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(38, \"div\", 31)(39, \"div\", 32);\n    i0.ɵɵtext(40, \"Consignee GST\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(41, \"div\", 33);\n    i0.ɵɵtext(42);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(43, \"div\", 31)(44, \"div\", 32);\n    i0.ɵɵtext(45, \"Consignee Phone\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(46, \"div\", 33);\n    i0.ɵɵtext(47);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(48, \"div\", 31)(49, \"div\", 32);\n    i0.ɵɵtext(50, \"Consignee Address\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(51, \"div\", 33);\n    i0.ɵɵtext(52);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(53, \"div\", 31)(54, \"div\", 32);\n    i0.ɵɵtext(55, \"Branch\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(56, \"div\", 33);\n    i0.ɵɵtext(57);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(58, \"div\", 31)(59, \"div\", 32);\n    i0.ɵɵtext(60, \"Date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(61, \"div\", 33);\n    i0.ɵɵtext(62);\n    i0.ɵɵpipe(63, \"date\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(64, \"div\", 31)(65, \"div\", 32);\n    i0.ɵɵtext(66, \"Payment Mode\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(67, \"div\", 33);\n    i0.ɵɵtext(68);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(69, \"div\", 31)(70, \"div\", 32);\n    i0.ɵɵtext(71, \"External Ref ID\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(72, \"div\", 33);\n    i0.ɵɵtext(73);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(74, \"div\", 31)(75, \"div\", 32);\n    i0.ɵɵtext(76, \"Billing Type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(77, \"div\", 33);\n    i0.ɵɵtext(78);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(79, \"div\", 31)(80, \"div\", 32);\n    i0.ɵɵtext(81, \"Billing Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(82, \"div\", 33);\n    i0.ɵɵtext(83);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(84, \"div\", 31)(85, \"div\", 32);\n    i0.ɵɵtext(86, \"Billing GSTIN\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(87, \"div\", 33);\n    i0.ɵɵtext(88);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(89, \"div\", 31)(90, \"div\", 32);\n    i0.ɵɵtext(91, \"Billing Phone\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(92, \"div\", 33);\n    i0.ɵɵtext(93);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(94, \"div\", 31)(95, \"div\", 32);\n    i0.ɵɵtext(96, \"Billing Address\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(97, \"div\", 33);\n    i0.ɵɵtext(98);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(99, \"div\", 31)(100, \"div\", 32);\n    i0.ɵɵtext(101, \"Pickup Type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(102, \"div\", 33);\n    i0.ɵɵtext(103);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(104, \"div\", 31)(105, \"div\", 32);\n    i0.ɵɵtext(106, \"Pickup Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(107, \"div\", 33);\n    i0.ɵɵtext(108);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(109, \"div\", 31)(110, \"div\", 32);\n    i0.ɵɵtext(111, \"Pickup Phone\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(112, \"div\", 33);\n    i0.ɵɵtext(113);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(114, \"div\", 31)(115, \"div\", 32);\n    i0.ɵɵtext(116, \"Pickup Address\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(117, \"div\", 33);\n    i0.ɵɵtext(118);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(119, \"div\", 31)(120, \"div\", 32);\n    i0.ɵɵtext(121, \"Pickup Pincode\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(122, \"div\", 33);\n    i0.ɵɵtext(123);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(124, \"div\", 31)(125, \"div\", 32);\n    i0.ɵɵtext(126, \"Delivery Type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(127, \"div\", 33);\n    i0.ɵɵtext(128);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(129, \"div\", 31)(130, \"div\", 32);\n    i0.ɵɵtext(131, \"Delivery To\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(132, \"div\", 33);\n    i0.ɵɵtext(133);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(134, \"div\", 31)(135, \"div\", 32);\n    i0.ɵɵtext(136, \"Delivery Phone\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(137, \"div\", 33);\n    i0.ɵɵtext(138);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(139, \"div\", 31)(140, \"div\", 32);\n    i0.ɵɵtext(141, \"Delivery Address\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(142, \"div\", 33);\n    i0.ɵɵtext(143);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(144, \"div\", 31)(145, \"div\", 32);\n    i0.ɵɵtext(146, \"Delivery Pincode\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(147, \"div\", 33);\n    i0.ɵɵtext(148);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(149, \"div\", 31)(150, \"div\", 32);\n    i0.ɵɵtext(151, \"Products\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(152, \"div\", 33);\n    i0.ɵɵtext(153);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(154, \"div\", 31)(155, \"div\", 32);\n    i0.ɵɵtext(156, \"Status\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(157, \"div\", 33);\n    i0.ɵɵtext(158);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(159, \"div\", 31)(160, \"div\", 32);\n    i0.ɵɵtext(161, \"Final Amount\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(162, \"div\", 33);\n    i0.ɵɵtext(163);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(164, \"div\", 31)(165, \"div\", 32);\n    i0.ɵɵtext(166, \"Charges - ODC\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(167, \"div\", 33);\n    i0.ɵɵtext(168);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(169, \"div\", 31)(170, \"div\", 32);\n    i0.ɵɵtext(171, \"Charges - Unloading\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(172, \"div\", 33);\n    i0.ɵɵtext(173);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(174, \"div\", 31)(175, \"div\", 32);\n    i0.ɵɵtext(176, \"Charges - Docket\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(177, \"div\", 33);\n    i0.ɵɵtext(178);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(179, \"div\", 31)(180, \"div\", 32);\n    i0.ɵɵtext(181, \"Charges - Other\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(182, \"div\", 33);\n    i0.ɵɵtext(183);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(184, \"div\", 31)(185, \"div\", 32);\n    i0.ɵɵtext(186, \"Charges - CCC\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(187, \"div\", 33);\n    i0.ɵɵtext(188);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(189, \"div\", 31)(190, \"div\", 32);\n    i0.ɵɵtext(191, \"Charges - Consignor Discount\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(192, \"div\", 33);\n    i0.ɵɵtext(193);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(194, \"div\", 34)(195, \"div\", 35)(196, \"h3\");\n    i0.ɵɵtext(197, \"Products\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(198, \"ul\", 36);\n    i0.ɵɵtemplate(199, InvoiceComponent_div_20_li_199_Template, 5, 2, \"li\", 22);\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(9);\n    i0.ɵɵtextInterpolate1(\"Consignment #\", ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.consignmentNumber, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.getDisplayStatus(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.shipmentStatus));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.consignor);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.consignorGST);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.consignorPhone);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.consignorAddress);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.consignee);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.consigneeGST);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.consigneePhone);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.consigneeAddress);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.branch);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(63, 39, ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.date, \"short\"));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.paymentMode);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.externalRefId);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.billingType);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.billingName);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.billingGSTIN);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.billingPhone);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.billingAddress);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.pickupType);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.pickupName);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.pickupPhone);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.pickupAddress);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.pickupPincode);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.deliveryType);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate((ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.deliveryName) || (ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.deliveryID));\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.deliveryPhone);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.deliveryAddress);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.deliveryPincode);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate((ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.products == null ? null : ctx_r1.selectedInvoice.products.length) || 0);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.getDisplayStatus(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.shipmentStatus));\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.finalAmount);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.charges == null ? null : ctx_r1.selectedInvoice.charges.odc);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.charges == null ? null : ctx_r1.selectedInvoice.charges.unloading);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.charges == null ? null : ctx_r1.selectedInvoice.charges.docket);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.charges == null ? null : ctx_r1.selectedInvoice.charges.other);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.charges == null ? null : ctx_r1.selectedInvoice.charges.ccc);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.charges == null ? null : ctx_r1.selectedInvoice.charges.consignorDiscount);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.selectedInvoice == null ? null : ctx_r1.selectedInvoice.products);\n  }\n}\nfunction InvoiceComponent_div_21_div_23_div_3_tr_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\")(4, \"input\", 56);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function InvoiceComponent_div_21_div_23_div_3_tr_13_Template_input_ngModelChange_4_listener($event) {\n      const product_r11 = i0.ɵɵrestoreView(_r10).$implicit;\n      i0.ɵɵtwoWayBindingSet(product_r11.amount, $event) || (product_r11.amount = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"ngModelChange\", function InvoiceComponent_div_21_div_23_div_3_tr_13_Template_input_ngModelChange_4_listener($event) {\n      const product_r11 = i0.ɵɵrestoreView(_r10).$implicit;\n      const inv_r12 = i0.ɵɵnextContext().$implicit;\n      const ctx_r1 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r1.onTotalQtyChange(inv_r12, product_r11, $event));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"td\")(6, \"input\", 57);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function InvoiceComponent_div_21_div_23_div_3_tr_13_Template_input_ngModelChange_6_listener($event) {\n      const product_r11 = i0.ɵɵrestoreView(_r10).$implicit;\n      i0.ɵɵtwoWayBindingSet(product_r11.deliveredstock, $event) || (product_r11.deliveredstock = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"ngModelChange\", function InvoiceComponent_div_21_div_23_div_3_tr_13_Template_input_ngModelChange_6_listener($event) {\n      const product_r11 = i0.ɵɵrestoreView(_r10).$implicit;\n      const inv_r12 = i0.ɵɵnextContext().$implicit;\n      const ctx_r1 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r1.onDeliveredQtyChange(inv_r12, product_r11, $event));\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const product_r11 = ctx.$implicit;\n    const p_r13 = ctx.index;\n    const i_r14 = i0.ɵɵnextContext().index;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(product_r11.type || product_r11.productName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate2(\"name\", \"total-\", i_r14, \"-\", p_r13, \"\");\n    i0.ɵɵproperty(\"min\", product_r11.deliveredstock || 0);\n    i0.ɵɵtwoWayProperty(\"ngModel\", product_r11.amount);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate2(\"name\", \"delivered-\", i_r14, \"-\", p_r13, \"\");\n    i0.ɵɵtwoWayProperty(\"ngModel\", product_r11.deliveredstock);\n  }\n}\nfunction InvoiceComponent_div_21_div_23_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20)(1, \"div\", 21);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"table\", 55)(4, \"thead\")(5, \"tr\")(6, \"th\");\n    i0.ɵɵtext(7, \"Product\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\");\n    i0.ɵɵtext(9, \"Total Qty\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\");\n    i0.ɵɵtext(11, \"Delivered Qty\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(12, \"tbody\");\n    i0.ɵɵtemplate(13, InvoiceComponent_div_21_div_23_div_3_tr_13_Template, 7, 10, \"tr\", 22);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const inv_r12 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Pre-Invoice #\", inv_r12.number, \"\");\n    i0.ɵɵadvance(11);\n    i0.ɵɵproperty(\"ngForOf\", inv_r12.products);\n  }\n}\nfunction InvoiceComponent_div_21_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 41)(1, \"h3\");\n    i0.ɵɵtext(2, \"Delivered/Pre-Invoice & Products\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, InvoiceComponent_div_21_div_23_div_3_Template, 14, 2, \"div\", 54);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.editingInvoice.invoices);\n  }\n}\nfunction InvoiceComponent_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 39)(1, \"div\", 40)(2, \"h2\");\n    i0.ɵɵtext(3, \"Edit Details\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"form\")(5, \"div\", 41)(6, \"label\", 42);\n    i0.ɵɵtext(7, \"Consignor:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"input\", 43);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function InvoiceComponent_div_21_Template_input_ngModelChange_8_listener($event) {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.editingInvoice.consignor, $event) || (ctx_r1.editingInvoice.consignor = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 41)(10, \"label\", 44);\n    i0.ɵɵtext(11, \"Delivery Address:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"textarea\", 45);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function InvoiceComponent_div_21_Template_textarea_ngModelChange_12_listener($event) {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.editingInvoice.deliveryAddress, $event) || (ctx_r1.editingInvoice.deliveryAddress = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(13, \"div\", 41)(14, \"label\", 46);\n    i0.ɵɵtext(15, \"Status:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"select\", 47);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function InvoiceComponent_div_21_Template_select_ngModelChange_16_listener($event) {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.editingInvoice.shipmentStatus, $event) || (ctx_r1.editingInvoice.shipmentStatus = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementStart(17, \"option\", 48);\n    i0.ɵɵtext(18, \"Pending\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"option\", 49);\n    i0.ɵɵtext(20, \"Delivered\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"option\", 50);\n    i0.ɵɵtext(22, \"Invoiced\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(23, InvoiceComponent_div_21_div_23_Template, 4, 1, \"div\", 51);\n    i0.ɵɵelementStart(24, \"div\", 52)(25, \"button\", 53);\n    i0.ɵɵlistener(\"click\", function InvoiceComponent_div_21_Template_button_click_25_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.saveInvoiceEdit());\n    });\n    i0.ɵɵtext(26, \"Save\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(27, \"button\", 53);\n    i0.ɵɵlistener(\"click\", function InvoiceComponent_div_21_Template_button_click_27_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.cancelEdit());\n    });\n    i0.ɵɵtext(28, \"Cancel\");\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(8);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.editingInvoice.consignor);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.editingInvoice.deliveryAddress);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.editingInvoice.shipmentStatus);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.editingInvoice == null ? null : ctx_r1.editingInvoice.invoices == null ? null : ctx_r1.editingInvoice.invoices.length);\n  }\n}\nfunction InvoiceComponent_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 39)(1, \"div\", 58)(2, \"h2\");\n    i0.ɵɵtext(3, \"Generate Invoice\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵtext(5, \"Generate invoice for the selected consignments?\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 59)(7, \"button\", 53);\n    i0.ɵɵlistener(\"click\", function InvoiceComponent_div_22_Template_button_click_7_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.confirmGenerateInvoice());\n    });\n    i0.ɵɵtext(8, \"Okay\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"button\", 53);\n    i0.ɵɵlistener(\"click\", function InvoiceComponent_div_22_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.cancelGenerateInvoice());\n    });\n    i0.ɵɵtext(10, \"Cancel\");\n    i0.ɵɵelementEnd()()()();\n  }\n}\nexport let InvoiceComponent = /*#__PURE__*/(() => {\n  class InvoiceComponent {\n    constructor(http, branchService) {\n      this.http = http;\n      this.branchService = branchService;\n      this.invoices = [];\n      this.deliveredInvoices = [];\n      this.preInvoicedInvoices = [];\n      this.preInvoices = [];\n      this.filteredDelivered = [];\n      this.filteredPreInvoiced = [];\n      this.filteredPreInvoices = [];\n      this.searchText = '';\n      this.filterDate = '';\n      this.filterConsignor = '';\n      this.selectedInvoice = null;\n      this.showInvoiceModal = false;\n      this.branch = localStorage.getItem('branch') || 'All Branches';\n      this.originLocId = localStorage.getItem('originLocId') || 'all';\n      this.hubs = [];\n      this.branches = [];\n      this.clientList = [];\n      this.clientById = new Map();\n      this.hubById = new Map();\n      this.editingInvoice = null; // �o. Track the invoice being edited\n      this.showEditPopup = false;\n      this.showGenerateInvoicePopup = false;\n      this.onStorageChange = e => {\n        if (e.key === 'branch' || e.key === 'originLocId') {\n          const current = localStorage.getItem('branch') || 'All Branches';\n          const currentId = localStorage.getItem('originLocId') || 'all';\n          if (current !== this.branch || currentId !== this.originLocId) {\n            this.branch = current;\n            this.originLocId = currentId;\n            this.loadClients();\n            this.loadInvoices();\n            this.loadPreInvoices();\n          }\n        }\n      };\n    }\n    ngOnInit() {\n      this.branch = this.branchService.currentBranch || this.branch;\n      this.originLocId = localStorage.getItem('originLocId') || 'all';\n      this.branchSub = this.branchService.branch$.subscribe(branch => {\n        if (branch !== this.branch) {\n          this.branch = branch;\n          this.originLocId = localStorage.getItem('originLocId') || 'all';\n          this.loadClients();\n          this.loadInvoices();\n          this.loadPreInvoices();\n        }\n      });\n      window.addEventListener('storage', this.onStorageChange);\n      this.loadBranches(() => this.loadHubs(() => {\n        this.loadClients();\n        this.loadInvoices();\n        this.loadPreInvoices();\n      }));\n    }\n    ngOnDestroy() {\n      this.branchSub?.unsubscribe();\n      window.removeEventListener('storage', this.onStorageChange);\n    }\n    loadBranches(onDone) {\n      this.http.get('http://localhost:3000/api/branches').subscribe({\n        next: branches => {\n          this.branches = Array.isArray(branches) ? branches : [];\n          if (onDone) onDone();\n        },\n        error: () => {\n          this.branches = [];\n          if (onDone) onDone();\n        }\n      });\n    }\n    loadHubs(onDone) {\n      this.http.get('http://localhost:3000/api/hubs').subscribe({\n        next: hubs => {\n          this.hubs = Array.isArray(hubs) ? hubs : [];\n          this.hubById = new Map();\n          this.hubs.forEach(hub => {\n            const id = this.normalizeId(hub?._id);\n            if (id) this.hubById.set(id, hub);\n          });\n          if (onDone) onDone();\n        },\n        error: () => {\n          this.hubs = [];\n          this.hubById = new Map();\n          if (onDone) onDone();\n        }\n      });\n    }\n    loadClients(onDone) {\n      const originLocId = localStorage.getItem('originLocId') || this.originLocId || 'all';\n      this.http.get('http://localhost:3000/api/clients/clientslist', {\n        params: {\n          originLocId\n        }\n      }).subscribe({\n        next: clients => {\n          this.clientList = Array.isArray(clients) ? clients : [];\n          this.clientById = new Map();\n          this.clientList.forEach(client => {\n            const id = this.normalizeId(client?._id);\n            if (id) this.clientById.set(id, client);\n          });\n          if (onDone) onDone();\n        },\n        error: () => {\n          this.clientList = [];\n          this.clientById = new Map();\n          if (onDone) onDone();\n        }\n      });\n    }\n    loadInvoices() {\n      const storedOriginLocId = this.originLocId || localStorage.getItem('originLocId') || 'all';\n      const branchLabel = String(localStorage.getItem('branch') || '').trim();\n      const selectedBranchId = this.resolveSelectedBranchId(storedOriginLocId, branchLabel);\n      const normalizedOriginId = selectedBranchId || this.normalizeId(storedOriginLocId);\n      const hasBranchSelection = storedOriginLocId && storedOriginLocId !== 'all' && storedOriginLocId !== 'all-hubs';\n      const hasHubsForBranch = hasBranchSelection && this.hubs.some(h => this.normalizeId(h?.originLocId) === normalizedOriginId);\n      const originLocIdParam = hasBranchSelection && (!this.isObjectId(storedOriginLocId) || hasHubsForBranch) ? 'all' : storedOriginLocId;\n      this.http.get('http://localhost:3000/api/newshipments', {\n        params: {\n          username: localStorage.getItem('username') || '',\n          originLocId: originLocIdParam\n        }\n      }).subscribe({\n        next: res => {\n          const raw = Array.isArray(res) ? res : res?.value || [];\n          // �o. Only show shipments with status 'Delivered'\n          //onsole.log('�Y\"� IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIInvoices loaded:', res);\n          const normalized = (raw || []).map(s => ({\n            ...s,\n            _normalizedStatus: this.normalizeStatus(s?.shipmentStatus)\n          }));\n          const nonDeleted = normalized.filter(s => !this.isDeletedStatus(s?.shipmentStatus));\n          this.invoices = nonDeleted;\n          this.deliveredInvoices = nonDeleted;\n          this.preInvoicedInvoices = nonDeleted.filter(s => s._normalizedStatus === 'pre-invoiced');\n          this.applyFilters();\n          console.log('A??,f??A? Filtered Delivered consignments:', this.filteredDelivered);\n          console.log('A??,f??A? Filtered Pre-Invoiced consignments:', this.filteredPreInvoiced);\n        },\n        error: err => console.error('�O Error loading invoices:', err)\n      });\n    }\n    loadPreInvoices() {\n      if (!this.hasSpecificBranchSelection()) {\n        this.preInvoices = [];\n        this.filteredPreInvoices = [];\n        return;\n      }\n      const storedOriginLocId = this.originLocId || localStorage.getItem('originLocId') || '';\n      const branchLabel = String(localStorage.getItem('branch') || '').trim();\n      const selectedBranchId = this.resolveSelectedBranchId(String(storedOriginLocId || ''), branchLabel);\n      const originLocIdParam = selectedBranchId || (this.isObjectId(storedOriginLocId) ? storedOriginLocId : '');\n      if (!originLocIdParam) {\n        this.preInvoices = [];\n        this.filteredPreInvoices = [];\n        return;\n      }\n      this.http.get('http://localhost:3000/api/newshipments/preInvoices', {\n        params: {\n          originLocId: originLocIdParam\n        }\n      }).subscribe({\n        next: res => {\n          const list = Array.isArray(res) ? res : res?.preInvoices || [];\n          const safe = Array.isArray(list) ? list : [];\n          this.preInvoices = safe.map(p => ({\n            ...p,\n            selected: false\n          }));\n          this.applyFilters();\n        },\n        error: err => {\n          console.error('Error loading pre-invoices:', err);\n          this.preInvoices = [];\n          this.filteredPreInvoices = [];\n        }\n      });\n    }\n    hasSpecificBranchSelection() {\n      const originLocId = String(this.originLocId || localStorage.getItem('originLocId') || '').trim();\n      return Boolean(originLocId && originLocId !== 'all' && originLocId !== 'all-hubs');\n    }\n    normalizeStatus(status) {\n      const value = String(status || '').trim().toLowerCase();\n      if (!value) return '';\n      if (value === 'dpending') return 'delivered';\n      if (value.includes('delivered')) return 'delivered';\n      if (value === 'pre invoiced' || value === 'preinvoiced' || value.includes('pre-invoiced')) {\n        return 'pre-invoiced';\n      }\n      return value;\n    }\n    isDeletedStatus(status) {\n      return String(status || '').trim().toLowerCase().includes('deleted');\n    }\n    isInvoiceOnProcess(shipment) {\n      return String(shipment?.invoiceStatus || '').trim().toLowerCase() === 'onprocess';\n    }\n    isInvoicePreInvoiced(shipment) {\n      const value = String(shipment?.invoiceStatus || '').trim().toLowerCase();\n      if (!value) return false;\n      return value === 'pre-invoiced' || value === 'pre invoiced' || value === 'preinvoiced';\n    }\n    getDisplayStatus(status) {\n      const value = String(status || '').trim();\n      const lower = value.toLowerCase();\n      if (!value) return '';\n      if (lower === 'dpending') return 'Delivered';\n      if (lower.includes('delivered')) return 'Delivered';\n      if (lower === 'pre invoiced' || lower === 'preinvoiced' || lower.includes('pre-invoiced')) {\n        return 'Pre-Invoiced';\n      }\n      return value;\n    }\n    normalizeId(value) {\n      if (value === undefined || value === null) return '';\n      if (typeof value === 'string') return value.trim();\n      if (value?._id) return String(value._id).trim();\n      if (value?.$oid) return String(value.$oid).trim();\n      return String(value).trim();\n    }\n    isObjectId(value) {\n      return /^[a-f\\d]{24}$/i.test(String(value || '').trim());\n    }\n    resolveSelectedBranchId(originLocId, branchLabel) {\n      const normalizedOrigin = this.normalizeId(originLocId);\n      if (this.isObjectId(normalizedOrigin)) return normalizedOrigin;\n      const label = String(branchLabel || originLocId || '').trim().toLowerCase();\n      if (!label) return '';\n      const match = (this.branches || []).find(b => {\n        const prefix = String(b?.prefix || '').trim().toLowerCase();\n        const name = String(b?.branchName || '').trim().toLowerCase();\n        return prefix && prefix === label || name && name === label;\n      });\n      return match ? this.normalizeId(match?._id) : '';\n    }\n    matchesBranchLabel(currentBranch, branchLabel) {\n      const current = String(currentBranch || '').trim().toLowerCase();\n      const label = String(branchLabel || '').trim().toLowerCase();\n      if (!current || !label) return false;\n      if (label === current) return true;\n      if (label.startsWith(`${current}-`)) return true;\n      const labelPrefix = label.split('-')[0].trim();\n      return Boolean(labelPrefix) && labelPrefix === current;\n    }\n    matchesSelectedBranch(shipment) {\n      const originLocId = String(this.originLocId || localStorage.getItem('originLocId') || '').trim();\n      const branchLabel = String(localStorage.getItem('branch') || '').trim();\n      const originId = this.normalizeId(shipment?.originLocId || shipment?.branch || shipment?.branchName);\n      const originLabel = String(shipment?.branchName || shipment?.branch || '').trim();\n      if (originLocId && originLocId !== 'all' && originLocId !== 'all-hubs') {\n        const normalizedOrigin = this.resolveSelectedBranchId(originLocId, branchLabel) || this.normalizeId(originLocId);\n        if (originId && originId === normalizedOrigin) return true;\n        const hubMatch = this.hubs.find(h => this.normalizeId(h?._id) === originId);\n        const hubBranchId = this.normalizeId(hubMatch?.originLocId);\n        if (hubBranchId && hubBranchId === normalizedOrigin) return true;\n        const labelTarget = branchLabel && branchLabel !== 'All Branches' && branchLabel !== 'All Hubs' ? branchLabel : originLocId;\n        if (labelTarget) {\n          const labelLower = String(labelTarget || '').trim().toLowerCase();\n          const originLower = originLabel.toLowerCase();\n          return originLower === labelLower || this.matchesBranchLabel(originLabel, String(labelTarget || ''));\n        }\n        return false;\n      }\n      if (originLocId === 'all' || originLocId === 'all-hubs') {\n        return true;\n      }\n      if (branchLabel && branchLabel !== 'All Branches' && branchLabel !== 'All Hubs') {\n        const labelLower = branchLabel.toLowerCase();\n        const originLower = originLabel.toLowerCase();\n        return originLower === labelLower || this.matchesBranchLabel(originLabel, branchLabel);\n      }\n      return true;\n    }\n    getBillingEntity(shipment) {\n      if (!shipment) return '';\n      const billingType = String(shipment?.billingType || '').trim().toLowerCase();\n      if (!billingType || billingType === 'consignor') {\n        return shipment?.consignor || '';\n      }\n      const fromData = String(shipment?.billingName || '').trim();\n      if (fromData) return fromData;\n      const billingId = this.normalizeId(shipment?.billingClientId);\n      if (billingId) {\n        const client = this.clientById.get(billingId);\n        if (client?.clientName) return client.clientName;\n        const hub = this.hubById.get(billingId);\n        if (hub?.hubName) return hub.hubName;\n      }\n      return '';\n    }\n    getPreInvoiceBillingEntity(pre) {\n      if (!pre) return '';\n      const fromData = String(pre?.billingEntityName || pre?.billingName || '').trim();\n      if (fromData) return fromData;\n      const billingId = this.normalizeId(pre?.billingEntityId || pre?.billingClientId);\n      if (billingId) {\n        const client = this.clientById.get(billingId);\n        if (client?.clientName) return client.clientName;\n        const hub = this.hubById.get(billingId);\n        if (hub?.hubName) return hub.hubName;\n      }\n      return '';\n    }\n    getPreInvoiceTaxableTotal(pre) {\n      return (pre?.consignments || []).reduce((sum, c) => sum + Number(c?.taxableValue || 0), 0);\n    }\n    applyFilters() {\n      if (!this.hasSpecificBranchSelection()) {\n        this.filteredDelivered = [];\n        this.filteredPreInvoiced = [];\n        this.filteredPreInvoices = [];\n        return;\n      }\n      const matches = s => this.matchesSelectedBranch(s) && (this.searchText ? s.consignmentNumber?.includes(this.searchText) || this.getBillingEntity(s).includes(this.searchText) : true) && (this.filterDate ? new Date(s.date).toISOString().split('T')[0] === this.filterDate : true) && (this.filterConsignor ? this.getBillingEntity(s).toLowerCase().includes(this.filterConsignor.toLowerCase()) : true);\n      this.filteredDelivered = this.deliveredInvoices.filter(s => matches(s) && (this.isInvoiceOnProcess(s) || this.isInvoicePreInvoiced(s)));\n      this.filteredDelivered.forEach(s => {\n        if (this.isInvoicePreInvoiced(s)) s.selected = false;\n      });\n      this.filteredPreInvoiced = this.preInvoicedInvoices.filter(matches);\n      const search = String(this.searchText || '').trim().toLowerCase();\n      const billingFilter = String(this.filterConsignor || '').trim().toLowerCase();\n      const filterDate = this.filterDate;\n      const matchesPre = p => {\n        const billingName = this.getPreInvoiceBillingEntity(p).toLowerCase();\n        const number = String(p?.preInvoiceNumber || '').toLowerCase();\n        const consignmentNumbers = (p?.consignments || []).map(c => String(c?.consignmentNumber || '').toLowerCase()).filter(Boolean);\n        const created = p?.createdAt ? new Date(p.createdAt).toISOString().split('T')[0] : '';\n        const matchesSearch = !search || billingName.includes(search) || number.includes(search) || consignmentNumbers.some(c => c.includes(search));\n        const matchesBilling = !billingFilter || billingName.includes(billingFilter);\n        const matchesDate = !filterDate || created === filterDate;\n        return matchesSearch && matchesBilling && matchesDate;\n      };\n      this.filteredPreInvoices = this.preInvoices.filter(p => matchesPre(p));\n    }\n    toggleAllDeliveredSelection(event) {\n      const checked = event.target.checked;\n      this.filteredDelivered.forEach(i => {\n        if (this.isInvoicePreInvoiced(i)) return;\n        i.selected = checked;\n      });\n    }\n    toggleAllPreInvoicedSelection(event) {\n      const checked = event.target.checked;\n      this.filteredPreInvoiced.forEach(i => i.selected = checked);\n    }\n    toggleAllPreInvoicesSelection(event) {\n      const checked = event.target.checked;\n      this.filteredPreInvoices.forEach(i => i.selected = checked);\n    }\n    openInvoiceDetails(invoice) {\n      this.selectedInvoice = invoice;\n      this.showInvoiceModal = true;\n    }\n    closeInvoiceDetails() {\n      this.showInvoiceModal = false;\n      this.selectedInvoice = null;\n    }\n    // �o. Function to mark selected Delivered consignments as Invoiced\n    invoiceSelected() {\n      const selectedConsignments = this.filteredDelivered.filter(i => i.selected && !this.isInvoicePreInvoiced(i));\n      if (selectedConsignments.length === 0) {\n        console.warn('No consignments selected for invoicing.');\n        return;\n      }\n      const billingIds = selectedConsignments.map(c => this.normalizeId(c?.billingClientId)).filter(Boolean);\n      if (billingIds.length !== selectedConsignments.length) {\n        alert('Missing Billing Entity');\n        return;\n      }\n      const uniqueBilling = new Set(billingIds);\n      if (uniqueBilling.size > 1) {\n        alert('Different Billing Entity');\n        return;\n      }\n      const consignmentNumbers = selectedConsignments.map(c => String(c?.consignmentNumber || '').trim()).filter(Boolean);\n      this.http.post('http://localhost:3000/api/newshipments/preInvoices', {\n        consignmentNumbers\n      }).subscribe({\n        next: () => {\n          this.filteredDelivered.forEach(i => i.selected = false);\n          this.loadInvoices();\n          this.loadPreInvoices();\n        },\n        error: err => {\n          console.error('Error creating pre-invoice:', err);\n          alert(err?.error?.message || 'Error creating pre-invoice');\n        }\n      });\n    }\n    editInvoice(invoice) {\n      console.log('Edit invoice:', invoice);\n      const cloned = JSON.parse(JSON.stringify(invoice || {}));\n      if (Array.isArray(cloned.ewaybills) && cloned.ewaybills.length) {\n        cloned.invoices = this.flattenInvoices(cloned.ewaybills);\n      } else {\n        cloned.invoices = cloned.invoices || [];\n      }\n      this.editingInvoice = cloned;\n      this.captureOriginalDelivered(this.editingInvoice);\n      this.showEditPopup = true;\n    }\n    flattenInvoices(ewaybills) {\n      return (ewaybills || []).flatMap(ewb => ewb.invoices || []);\n    }\n    captureOriginalDelivered(invoice) {\n      (invoice?.invoices || []).forEach(inv => {\n        (inv.products || []).forEach(prod => {\n          prod._originalDelivered = Number(prod.deliveredstock) || 0;\n        });\n      });\n    }\n    deleteDelivered() {\n      this.deleteConsignments(this.filteredDelivered);\n    }\n    deletePreInvoiced() {\n      this.deleteConsignments(this.filteredPreInvoiced);\n    }\n    deleteInvoice() {\n      this.deleteConsignments([...this.filteredDelivered, ...this.filteredPreInvoiced]);\n    }\n    finalizePreInvoiced() {\n      const selectedConsignments = (this.filteredPreInvoiced || []).filter(i => i.selected);\n      if (selectedConsignments.length === 0) {\n        console.warn('No consignments selected for invoicing.');\n        return;\n      }\n      selectedConsignments.forEach(consignment => {\n        const updatedConsignment = {\n          ...consignment,\n          shipmentStatus: 'Invoiced'\n        };\n        this.http.put(`http://localhost:3000/api/newshipments/${consignment.consignmentNumber}`, updatedConsignment).subscribe({\n          next: () => {\n            console.log(`Consignment ${consignment.consignmentNumber} updated to Invoiced`);\n            this.loadInvoices();\n          },\n          error: err => {\n            console.error(`Error updating consignment ${consignment.consignmentNumber}:`, err);\n          }\n        });\n      });\n      this.filteredPreInvoiced.forEach(i => i.selected = false);\n    }\n    openGenerateInvoicePopup() {\n      const selectedConsignments = (this.filteredPreInvoiced || []).filter(i => i.selected);\n      if (selectedConsignments.length === 0) {\n        console.warn('No consignments selected for invoicing.');\n        return;\n      }\n      this.showGenerateInvoicePopup = true;\n    }\n    confirmGenerateInvoice() {\n      const selectedConsignments = (this.filteredPreInvoiced || []).filter(i => i.selected);\n      if (selectedConsignments.length === 0) {\n        console.warn('No consignments selected for invoicing.');\n        this.showGenerateInvoicePopup = false;\n        return;\n      }\n      const consignmentNumbers = selectedConsignments.map(s => s.consignmentNumber);\n      this.http.post('http://localhost:3000/api/newshipments/generateInvoices', {\n        consignmentNumbers\n      }).subscribe({\n        next: () => {\n          this.showGenerateInvoicePopup = false;\n          this.filteredPreInvoiced.forEach(i => i.selected = false);\n          this.loadInvoices();\n        },\n        error: err => {\n          console.error('Error generating invoices:', err);\n          this.showGenerateInvoicePopup = false;\n        }\n      });\n    }\n    cancelGenerateInvoice() {\n      this.showGenerateInvoicePopup = false;\n    }\n    deleteConsignments(list) {\n      const selectedConsignments = (list || []).filter(i => i.selected);\n      if (selectedConsignments.length === 0) {\n        console.warn('No consignments selected for invoicing.');\n        return;\n      }\n      selectedConsignments.forEach(consignment => {\n        const updatedConsignment = {\n          ...consignment,\n          shipmentStatus: ' Cancelled-' + consignment.shipmentStatus\n        };\n        this.http.put(`http://localhost:3000/api/newshipments/${consignment.consignmentNumber}`, updatedConsignment).subscribe({\n          next: () => {\n            console.log(`Consignment ${consignment.consignmentNumber} updated to Invoiced`);\n            this.loadInvoices();\n          },\n          error: err => {\n            console.error(`Error updating consignment ${consignment.consignmentNumber}:`, err);\n          }\n        });\n      });\n      (list || []).forEach(i => i.selected = false);\n    }\n    printDelivered() {\n      this.printConsignments(this.filteredDelivered);\n    }\n    printPreInvoiced() {\n      this.printConsignments(this.filteredPreInvoiced);\n    }\n    printInvoice() {\n      this.printConsignments([...this.filteredDelivered, ...this.filteredPreInvoiced]);\n    }\n    printConsignments(list) {\n      const selected = (list || []).filter(inv => inv.selected);\n      if (selected.length === 0) {\n        alert('No invoices selected.');\n        return;\n      }\n      fetch('assets/invoice-template.html').then(res => res.text()).then(template => {\n        let fullHtml = `\n      <html>\n        <head>\n          <style>\n            body { font-family: Arial, sans-serif; padding: 20px; }\n            h2 { margin-bottom: 0; }\n            table { width: 100%; border-collapse: collapse; margin-top: 10px; }\n            th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }\n            th { background-color: #f2f2f2; }\n            .page-break { page-break-after: always; }\n            .totals { margin-top: 15px; font-weight: bold; }\n          </style>\n        </head>\n        <body>\n    `;\n        selected.forEach((inv, index) => {\n          let subtotal = 0;\n          const rows = (inv.invoices || []).map(i => (i.products || []).map(p => {\n            const lineTotal = (p.price || 0) * (p.deliveredstock || 0);\n            subtotal += lineTotal;\n            return `\n          <tr>\n          <td>${inv.consignmentNumber}</td>\n          <td>${inv.shipmentStatus}</td>\n          <td>${inv.consignor}</td>\n          <td>${inv.deliveryAddress}</td>\n          <td>${p.type}</td>\n          <td>${p.deliveredstock}</td>\n          <td>${p.price || 0}</td>\n          <td>${lineTotal.toFixed(2)}</td>\n          </tr>\n          `;\n          }).join('')).join('');\n          const ctype = localStorage.getItem('companyType') || 'default';\n          const gst = inv.finalAmount * (parseInt(ctype, 10) / 100);\n          const grandTotal = inv.finalAmount + gst;\n          const htmlContent = template.replace('{{consignmentNumber}}', inv.consignmentNumber).replace('{{consignor}}', inv.consignor).replace('{{deliveryAddress}}', inv.deliveryAddress).replace('{{status}}', inv.shipmentStatus).replace('{{rows}}', rows).replace('{{subtotal}}', subtotal.toFixed(2)).replace('{{gst}}', gst.toFixed(2)).replace('{{grandTotal}}', grandTotal.toFixed(2));\n          fullHtml += htmlContent;\n          if (index < selected.length - 1) {\n            fullHtml += `<div class=\"page-break\"></div>`;\n          }\n        });\n        fullHtml += `</body></html>`;\n        const printWindow = window.open('', '_blank');\n        if (printWindow) {\n          printWindow.document.open();\n          printWindow.document.write(fullHtml);\n          printWindow.document.close();\n          printWindow.print();\n        }\n      }).catch(err => console.error('Error loading invoice template:', err));\n    }\n    printPreInvoices() {\n      const selected = (this.filteredPreInvoices || []).filter(p => p.selected);\n      if (!selected.length) {\n        alert('No pre-invoices selected.');\n        return;\n      }\n      let fullHtml = `\n      <html>\n        <head>\n          <style>\n            body { font-family: Arial, sans-serif; padding: 20px; }\n            h2 { margin-bottom: 0; }\n            table { width: 100%; border-collapse: collapse; margin-top: 10px; }\n            th, td { border: 1px solid #ccc; padding: 8px; text-align: left; vertical-align: top; }\n            th { background-color: #f2f2f2; }\n            .page-break { page-break-after: always; }\n            .muted { color: #6b7280; font-size: 12px; }\n          </style>\n        </head>\n        <body>\n          <h2>Pre-Invoice Records</h2>\n    `;\n      selected.forEach((pre, index) => {\n        const billing = this.getPreInvoiceBillingEntity(pre);\n        const consignmentRows = (pre?.consignments || []).map(c => `\n          <tr>\n            <td>${c.consignmentNumber || ''}</td>\n            <td>${Number(c.taxableValue || 0).toFixed(2)}</td>\n          </tr>\n        `).join('');\n        const totalTaxable = this.getPreInvoiceTaxableTotal(pre);\n        const createdAt = pre?.createdAt ? new Date(pre.createdAt).toLocaleString() : '';\n        fullHtml += `\n        <table>\n          <tr>\n            <th>Pre-Invoice No.</th>\n            <td>${pre.preInvoiceNumber || ''}</td>\n            <th>Billing Entity</th>\n            <td>${billing || ''}</td>\n          </tr>\n          <tr>\n            <th>Created</th>\n            <td colspan=\"3\">${createdAt}</td>\n          </tr>\n        </table>\n        <table>\n          <thead>\n            <tr>\n              <th>Consignment No.</th>\n              <th>Taxable Value</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${consignmentRows || '<tr><td colspan=\"2\" class=\"muted\">No consignments</td></tr>'}\n          </tbody>\n          <tfoot>\n            <tr>\n              <th>Total Taxable</th>\n              <th>${Number(totalTaxable || 0).toFixed(2)}</th>\n            </tr>\n          </tfoot>\n        </table>\n      `;\n        if (index < selected.length - 1) {\n          fullHtml += `<div class=\"page-break\"></div>`;\n        }\n      });\n      fullHtml += `</body></html>`;\n      const printWindow = window.open('', '_blank');\n      if (printWindow) {\n        printWindow.document.open();\n        printWindow.document.write(fullHtml);\n        printWindow.document.close();\n        printWindow.print();\n      }\n    }\n    static {\n      this.ɵfac = function InvoiceComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || InvoiceComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.BranchService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: InvoiceComponent,\n        selectors: [[\"app-invoice\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 23,\n        vars: 8,\n        consts: [[1, \"invoice-container\"], [1, \"filters\"], [\"type\", \"text\", \"placeholder\", \"Search by Consignment / Billing Entity\", 3, \"ngModelChange\", \"input\", \"ngModel\"], [\"type\", \"date\", 3, \"ngModelChange\", \"change\", \"ngModel\"], [\"type\", \"text\", \"placeholder\", \"Filter by Billing Entity\", 3, \"ngModelChange\", \"input\", \"ngModel\"], [1, \"invoice-sections\"], [\"class\", \"invoice-section\", 4, \"ngIf\"], [1, \"invoice-section\"], [1, \"action-bar\"], [3, \"click\"], [1, \"delete-btn\", 3, \"click\"], [1, \"print-btn\", 3, \"click\"], [\"class\", \"invoice-block\", 4, \"ngIf\"], [\"class\", \"modal details-modal\", 4, \"ngIf\"], [\"class\", \"popup-overlay\", 4, \"ngIf\"], [1, \"invoice-table\"], [\"type\", \"checkbox\", 3, \"change\"], [3, \"selected\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"checkbox\", 3, \"ngModelChange\", \"click\", \"ngModel\", \"disabled\"], [1, \"edit-btn\", 3, \"click\"], [1, \"invoice-block\"], [1, \"invoice-title\"], [4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [1, \"modal\", \"details-modal\"], [1, \"modal-content\", \"details-content\"], [\"type\", \"button\", 1, \"details-close\", 3, \"click\"], [1, \"details-header\"], [1, \"details-sub\"], [1, \"details-status\"], [1, \"details-grid\"], [1, \"details-item\"], [1, \"details-label\"], [1, \"details-value\"], [1, \"details-products\"], [1, \"details-invoice\"], [1, \"details-product-list\"], [1, \"product-name\"], [1, \"product-meta\"], [1, \"popup-overlay\"], [1, \"popup-content\"], [1, \"form-row\"], [\"for\", \"consignor\"], [\"type\", \"text\", \"id\", \"consignor\", \"name\", \"consignor\", 3, \"ngModelChange\", \"ngModel\"], [\"for\", \"deliveryAddress\"], [\"id\", \"deliveryAddress\", \"name\", \"deliveryAddress\", 3, \"ngModelChange\", \"ngModel\"], [\"for\", \"status\"], [\"id\", \"status\", \"name\", \"status\", 3, \"ngModelChange\", \"ngModel\"], [\"value\", \"Pending\"], [\"value\", \"Delivered\"], [\"value\", \"Invoiced\"], [\"class\", \"form-row\", 4, \"ngIf\"], [1, \"button-section\"], [\"type\", \"button\", 3, \"click\"], [\"class\", \"invoice-block\", 4, \"ngFor\", \"ngForOf\"], [1, \"product-table\"], [\"type\", \"number\", \"min\", \"0\", 3, \"ngModelChange\", \"min\", \"ngModel\", \"name\"], [\"type\", \"number\", \"min\", \"0\", 3, \"ngModelChange\", \"ngModel\", \"name\"], [1, \"popup-content\", \"confirm-popup\"], [1, \"button-section\", \"confirm-actions\"]],\n        template: function InvoiceComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n            i0.ɵɵtext(2, \"\\uD83D\\uDCE6 Delivered/Pre-Invoice Management\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(3, \"div\", 1)(4, \"input\", 2);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function InvoiceComponent_Template_input_ngModelChange_4_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.searchText, $event) || (ctx.searchText = $event);\n              return $event;\n            });\n            i0.ɵɵlistener(\"input\", function InvoiceComponent_Template_input_input_4_listener() {\n              return ctx.applyFilters();\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(5, \"input\", 3);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function InvoiceComponent_Template_input_ngModelChange_5_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.filterDate, $event) || (ctx.filterDate = $event);\n              return $event;\n            });\n            i0.ɵɵlistener(\"change\", function InvoiceComponent_Template_input_change_5_listener() {\n              return ctx.applyFilters();\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(6, \"input\", 4);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function InvoiceComponent_Template_input_ngModelChange_6_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.filterConsignor, $event) || (ctx.filterConsignor = $event);\n              return $event;\n            });\n            i0.ɵɵlistener(\"input\", function InvoiceComponent_Template_input_input_6_listener() {\n              return ctx.applyFilters();\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(7, \"div\", 5);\n            i0.ɵɵtemplate(8, InvoiceComponent_div_8_Template, 21, 1, \"div\", 6);\n            i0.ɵɵelementStart(9, \"div\", 7)(10, \"h3\");\n            i0.ɵɵtext(11, \"Pre-Invoiced\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(12, \"div\", 8)(13, \"button\", 9);\n            i0.ɵɵlistener(\"click\", function InvoiceComponent_Template_button_click_13_listener() {\n              return ctx.openGenerateInvoicePopup();\n            });\n            i0.ɵɵtext(14, \"Generate Invoice\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(15, \"button\", 10);\n            i0.ɵɵlistener(\"click\", function InvoiceComponent_Template_button_click_15_listener() {\n              return ctx.deletePreInvoiced();\n            });\n            i0.ɵɵtext(16, \"Delete\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(17, \"button\", 11);\n            i0.ɵɵlistener(\"click\", function InvoiceComponent_Template_button_click_17_listener() {\n              return ctx.printPreInvoiced();\n            });\n            i0.ɵɵtext(18, \"Print Manifest\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(19, InvoiceComponent_div_19_Template, 19, 2, \"div\", 12);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(20, InvoiceComponent_div_20_Template, 200, 42, \"div\", 13)(21, InvoiceComponent_div_21_Template, 29, 4, \"div\", 14)(22, InvoiceComponent_div_22_Template, 11, 0, \"div\", 14);\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(4);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.searchText);\n            i0.ɵɵadvance();\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.filterDate);\n            i0.ɵɵadvance();\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.filterConsignor);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngIf\", ctx.hasSpecificBranchSelection());\n            i0.ɵɵadvance(11);\n            i0.ɵɵproperty(\"ngIf\", ctx.hasSpecificBranchSelection());\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.showInvoiceModal);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.showEditPopup);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.showGenerateInvoicePopup);\n          }\n        },\n        dependencies: [CommonModule, i3.NgForOf, i3.NgIf, i3.DecimalPipe, i3.DatePipe, FormsModule, i4.ɵNgNoValidate, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.DefaultValueAccessor, i4.NumberValueAccessor, i4.CheckboxControlValueAccessor, i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.MinValidator, i4.NgModel, i4.NgForm],\n        styles: [\".invoice-container[_ngcontent-%COMP%]{padding:20px;color:var(--text)}[_nghost-%COMP%]{--page-bg: #f6f8fb;--card: #ffffff;--border: #e5e7eb;--text: #0f172a;--muted: #6b7280;--primary: #2563eb;--primary-strong: #1e3a8a;--danger: #dc2626}.filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:15px}.filters[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filters[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:8px 10px;border:1px solid var(--border);border-radius:10px;background:#fff;color:var(--text);flex:1 1 190px;min-width:0}.action-bar[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center}.invoice-sections[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:24px;width:100%}.invoice-section[_ngcontent-%COMP%]{min-width:0}.invoice-section[_ngcontent-%COMP%]{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:16px;box-shadow:0 10px 24px #0f172a14}.invoice-section[_ngcontent-%COMP%] > h3[_ngcontent-%COMP%]{margin-top:0}.invoice-section[_ngcontent-%COMP%]   .action-bar[_ngcontent-%COMP%]{margin:8px 0 12px;flex-wrap:wrap}.action-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 14px;border-radius:10px;border:1px solid var(--border);background:#fff;color:var(--text);cursor:pointer}.action-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{border-color:var(--primary);color:var(--primary-strong)}.print-btn[_ngcontent-%COMP%]{background:var(--primary);color:#fff;border:1px solid var(--primary)}.print-btn[_ngcontent-%COMP%]:hover{background:var(--primary-strong);border-color:var(--primary-strong);color:#fff}.invoice-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden}.invoice-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .invoice-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid var(--border);padding:8px;text-align:left}.invoice-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f8fafc;font-weight:600}.invoice-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f8fafc}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:#0009;z-index:2000}.modal-content[_ngcontent-%COMP%]{position:relative}.edit-btn[_ngcontent-%COMP%]{background:var(--primary);color:#fff;border:1px solid var(--primary);padding:4px 8px;border-radius:4px;cursor:pointer}.edit-btn[_ngcontent-%COMP%]:hover{background:var(--primary-strong)}.modal-actions[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:space-between}.popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0f172a8c;display:flex;align-items:center;justify-content:center;z-index:1000}.popup-content[_ngcontent-%COMP%]{background:var(--card);padding:20px;border-radius:12px;width:520px;max-width:90%;border:1px solid var(--border);box-shadow:0 18px 40px #0f172a33}.details-modal[_ngcontent-%COMP%]{background:#0f172a8c}.details-content[_ngcontent-%COMP%]{background:#fff;color:var(--text);width:min(860px,92vw);max-height:85vh;border-radius:16px;border:1px solid var(--border);box-shadow:0 18px 40px #0f172a33;padding:20px;position:relative}.details-close[_ngcontent-%COMP%]{position:absolute;right:18px;top:12px;background:transparent;border:none;font-size:24px;cursor:pointer;color:var(--muted)}.details-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:16px;gap:12px}.details-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:22px}.details-sub[_ngcontent-%COMP%]{margin:6px 0 0;color:var(--muted);font-size:13px}.details-status[_ngcontent-%COMP%]{background:#e0f2fe;color:#0ea5e9;padding:6px 10px;border-radius:999px;font-size:12px;font-weight:600;white-space:nowrap}.details-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px 16px;background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px;margin-bottom:16px}.details-products[_ngcontent-%COMP%]{display:grid;gap:12px}.details-invoice[_ngcontent-%COMP%]{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px}.details-product-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;display:grid;gap:8px}.details-product-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;justify-content:space-between;border-bottom:1px solid var(--border);padding-bottom:6px}.details-product-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{border-bottom:none}.product-name[_ngcontent-%COMP%]{font-weight:600}.product-meta[_ngcontent-%COMP%]{color:var(--muted);font-size:13px}@media (max-width: 700px){.details-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.details-product-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}@media (max-width: 1200px){.filters[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filters[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:7px 9px;font-size:13px}.action-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:7px 12px;font-size:13px}.invoice-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .invoice-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .product-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .product-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:7px;font-size:13px}}@media (max-width: 992px){.filters[_ngcontent-%COMP%]{gap:8px}.filters[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filters[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:6px 8px;font-size:12px}.action-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 10px;font-size:12px}.invoice-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .invoice-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .product-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .product-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:6px;font-size:12px}}@media (max-width: 768px){.filters[_ngcontent-%COMP%]{gap:6px}.filters[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filters[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:5px 7px;font-size:11px}.action-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px 8px;font-size:11px}.invoice-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .invoice-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .product-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .product-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px;font-size:11px}}.form-row[_ngcontent-%COMP%]{margin-bottom:12px}.form-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-weight:700}.form-row[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:6px;box-sizing:border-box;border:1px solid var(--border);border-radius:8px}.button-section[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px}.delete-btn[_ngcontent-%COMP%]{background-color:#fef2f2;color:var(--danger);border:1px solid #fecaca;padding:5px 10px;margin-left:5px;cursor:pointer;border-radius:4px}.delete-btn[_ngcontent-%COMP%]:hover{background-color:#fee2e2}.invoice-block[_ngcontent-%COMP%]{margin-top:12px;padding:10px;border:1px solid #e5e7eb;border-radius:6px;background:#f9fafb}.invoice-title[_ngcontent-%COMP%]{font-weight:600;margin-bottom:8px}.product-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.product-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .product-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #e5e7eb;padding:6px 8px;text-align:left}.product-table[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{width:100%;padding:4px 6px;box-sizing:border-box}.confirm-popup[_ngcontent-%COMP%]{max-width:420px}.confirm-actions[_ngcontent-%COMP%]{justify-content:flex-end}.confirm-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:100px}\"]\n      });\n    }\n  }\n  return InvoiceComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}