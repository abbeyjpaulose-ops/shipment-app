{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/forms\";\nfunction ManifestComponent_option_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const route_r1 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", route_r1);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(route_r1);\n  }\n}\nfunction ManifestComponent_select_18_option_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const h_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", h_r4._id);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(h_r4.hubName);\n  }\n}\nfunction ManifestComponent_select_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"select\", 21);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_select_18_Template_select_ngModelChange_0_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.selectedHubFilterId, $event) || (ctx_r2.selectedHubFilterId = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"ngModelChange\", function ManifestComponent_select_18_Template_select_ngModelChange_0_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.onHubFilterChange($event));\n    });\n    i0.ɵɵtemplate(1, ManifestComponent_select_18_option_1_Template, 2, 2, \"option\", 11);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.selectedHubFilterId);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.getAllHubsFilterOptions());\n  }\n}\nfunction ManifestComponent_tr_44_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 4);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_tr_44_Template_tr_click_0_listener() {\n      const s_r6 = i0.ɵɵrestoreView(_r5).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.openStockDetails(s_r6));\n    });\n    i0.ɵɵelementStart(1, \"td\")(2, \"input\", 22);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_tr_44_Template_input_ngModelChange_2_listener($event) {\n      const s_r6 = i0.ɵɵrestoreView(_r5).$implicit;\n      i0.ɵɵtwoWayBindingSet(s_r6.selected, $event) || (s_r6.selected = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"click\", function ManifestComponent_tr_44_Template_input_click_2_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      return i0.ɵɵresetView($event.stopPropagation());\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\");\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"td\")(16, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_tr_44_Template_button_click_16_listener($event) {\n      const s_r6 = i0.ɵɵrestoreView(_r5).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      ctx_r2.editStock(s_r6);\n      return i0.ɵɵresetView($event.stopPropagation());\n    });\n    i0.ɵɵtext(17, \"Edit\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const s_r6 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtwoWayProperty(\"ngModel\", s_r6.selected);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(s_r6.consignmentNumber);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(s_r6.shipmentStatus);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(s_r6.consignor);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.getOriginBranchDisplay(s_r6));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.getCurrentBranchDisplay(s_r6));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.getInvoiceAmountTotal(s_r6.invoices));\n  }\n}\nfunction ManifestComponent_div_45_div_173_li_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\")(1, \"span\", 36);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 37);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"span\", 37);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const product_r8 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(product_r8.type);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"In Stock: \", product_r8.instock, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Total: \", product_r8.amount, \"\");\n  }\n}\nfunction ManifestComponent_div_45_div_173_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 32)(1, \"div\", 33);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ul\", 34);\n    i0.ɵɵtemplate(4, ManifestComponent_div_45_div_173_li_4_Template, 7, 3, \"li\", 35);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const invoice_r9 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Invoice #\", invoice_r9.number, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", invoice_r9.products);\n  }\n}\nfunction ManifestComponent_div_45_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 23)(1, \"div\", 24)(2, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_45_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.closeStockDetails());\n    });\n    i0.ɵɵtext(3, \"\\u00D7\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 26)(5, \"div\")(6, \"h2\");\n    i0.ɵɵtext(7, \"Shipment Details\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\", 27);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"span\", 28);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"div\", 29)(13, \"p\")(14, \"strong\");\n    i0.ɵɵtext(15, \"Consignment No.:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"p\")(18, \"strong\");\n    i0.ɵɵtext(19, \"Status:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"p\")(22, \"strong\");\n    i0.ɵɵtext(23, \"Branch:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(25, \"p\")(26, \"strong\");\n    i0.ɵɵtext(27, \"Current Branch:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(29, \"p\")(30, \"strong\");\n    i0.ɵɵtext(31, \"Consignor:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(32);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(33, \"p\")(34, \"strong\");\n    i0.ɵɵtext(35, \"Consignor GST:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(36);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(37, \"p\")(38, \"strong\");\n    i0.ɵɵtext(39, \"Consignor Phone:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(40);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(41, \"p\")(42, \"strong\");\n    i0.ɵɵtext(43, \"Consignor Address:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(44);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(45, \"p\")(46, \"strong\");\n    i0.ɵɵtext(47, \"Consignee:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(48);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(49, \"p\")(50, \"strong\");\n    i0.ɵɵtext(51, \"Consignee GST:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(52);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(53, \"p\")(54, \"strong\");\n    i0.ɵɵtext(55, \"Consignee Phone:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(56);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(57, \"p\")(58, \"strong\");\n    i0.ɵɵtext(59, \"Consignee Address:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(60);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(61, \"p\")(62, \"strong\");\n    i0.ɵɵtext(63, \"Payment Mode:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(64);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(65, \"p\")(66, \"strong\");\n    i0.ɵɵtext(67, \"External Ref ID:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(68);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(69, \"p\")(70, \"strong\");\n    i0.ɵɵtext(71, \"Billing Type:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(72);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(73, \"p\")(74, \"strong\");\n    i0.ɵɵtext(75, \"Billing Name:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(76);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(77, \"p\")(78, \"strong\");\n    i0.ɵɵtext(79, \"Billing GSTIN:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(80);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(81, \"p\")(82, \"strong\");\n    i0.ɵɵtext(83, \"Billing Phone:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(84);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(85, \"p\")(86, \"strong\");\n    i0.ɵɵtext(87, \"Billing Address:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(88);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(89, \"p\")(90, \"strong\");\n    i0.ɵɵtext(91, \"Pickup Type:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(92);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(93, \"p\")(94, \"strong\");\n    i0.ɵɵtext(95, \"Pickup Name:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(96);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(97, \"p\")(98, \"strong\");\n    i0.ɵɵtext(99, \"Pickup Phone:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(100);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(101, \"p\")(102, \"strong\");\n    i0.ɵɵtext(103, \"Pickup Address:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(104);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(105, \"p\")(106, \"strong\");\n    i0.ɵɵtext(107, \"Pickup Pincode:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(108);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(109, \"p\")(110, \"strong\");\n    i0.ɵɵtext(111, \"Delivery Type:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(112);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(113, \"p\")(114, \"strong\");\n    i0.ɵɵtext(115, \"Delivery To:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(116);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(117, \"p\")(118, \"strong\");\n    i0.ɵɵtext(119, \"Delivery Phone:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(120);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(121, \"p\")(122, \"strong\");\n    i0.ɵɵtext(123, \"Delivery Address:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(124);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(125, \"p\")(126, \"strong\");\n    i0.ɵɵtext(127, \"Delivery Pincode:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(128);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(129, \"p\")(130, \"strong\");\n    i0.ɵɵtext(131, \"Date:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(132);\n    i0.ɵɵpipe(133, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(134, \"p\")(135, \"strong\");\n    i0.ɵɵtext(136, \"Final Amount:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(137);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(138, \"p\")(139, \"strong\");\n    i0.ɵɵtext(140, \"Charges - ODC:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(141);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(142, \"p\")(143, \"strong\");\n    i0.ɵɵtext(144, \"Charges - Unloading:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(145);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(146, \"p\")(147, \"strong\");\n    i0.ɵɵtext(148, \"Charges - Docket:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(149);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(150, \"p\")(151, \"strong\");\n    i0.ɵɵtext(152, \"Charges - Other:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(153);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(154, \"p\")(155, \"strong\");\n    i0.ɵɵtext(156, \"Charges - CCC:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(157);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(158, \"p\")(159, \"strong\");\n    i0.ɵɵtext(160, \"Charges - Consignor Discount:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(161);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(162, \"p\")(163, \"strong\");\n    i0.ɵɵtext(164, \"Products in stock:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(165);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(166, \"p\")(167, \"strong\");\n    i0.ɵɵtext(168, \"No. of Products:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(169);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(170, \"h3\");\n    i0.ɵɵtext(171, \"Products\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(172, \"div\", 30);\n    i0.ɵɵtemplate(173, ManifestComponent_div_45_div_173_Template, 5, 2, \"div\", 31);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(9);\n    i0.ɵɵtextInterpolate1(\"Consignment \", ctx_r2.selectedStock.consignmentNumber, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.selectedStock.shipmentStatus);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.consignmentNumber, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.shipmentStatus, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.getOriginBranchDisplay(ctx_r2.selectedStock), \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.getCurrentBranchDisplay(ctx_r2.selectedStock), \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.consignor, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.consignorGST, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.consignorPhone, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.consignorAddress, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.consignee, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.consigneeGST, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.consigneePhone, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.consigneeAddress, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.paymentMode, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.externalRefId, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.billingType, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.billingName, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.billingGSTIN, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.billingPhone, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.billingAddress, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.pickupType, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.pickupName, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.pickupPhone, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.pickupAddress, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.pickupPincode, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.deliveryType, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.getDeliveryDisplayName(ctx_r2.selectedStock), \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.deliveryPhone, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.deliveryAddress, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.deliveryPincode, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(133, 42, ctx_r2.selectedStock.date, \"short\"), \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock.finalAmount, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock == null ? null : ctx_r2.selectedStock.charges == null ? null : ctx_r2.selectedStock.charges.odc, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock == null ? null : ctx_r2.selectedStock.charges == null ? null : ctx_r2.selectedStock.charges.unloading, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock == null ? null : ctx_r2.selectedStock.charges == null ? null : ctx_r2.selectedStock.charges.docket, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock == null ? null : ctx_r2.selectedStock.charges == null ? null : ctx_r2.selectedStock.charges.other, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock == null ? null : ctx_r2.selectedStock.charges == null ? null : ctx_r2.selectedStock.charges.ccc, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.selectedStock == null ? null : ctx_r2.selectedStock.charges == null ? null : ctx_r2.selectedStock.charges.consignorDiscount, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.getInStockAmountTotal(ctx_r2.selectedStock.invoices), \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.getInvoiceAmountTotal(ctx_r2.selectedStock.invoices), \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.selectedStock.invoices);\n  }\n}\nfunction ManifestComponent_div_46_div_24_option_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const client_r12 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", client_r12.clientName);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\"\", client_r12.clientName, \", \", client_r12.address, \"\");\n  }\n}\nfunction ManifestComponent_div_46_div_24_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 43)(1, \"label\");\n    i0.ɵɵtext(2, \"Consignor: \");\n    i0.ɵɵelementStart(3, \"select\", 9);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_24_Template_select_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.consignor, $event) || (ctx_r2.editingStock.consignor = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"change\", function ManifestComponent_div_46_div_24_Template_select_change_3_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.onConsignorSelect(ctx_r2.editingStock.consignor));\n    });\n    i0.ɵɵtemplate(4, ManifestComponent_div_46_div_24_option_4_Template, 2, 3, \"option\", 11);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"label\");\n    i0.ɵɵtext(6, \"GSTIN: \");\n    i0.ɵɵelementStart(7, \"input\", 56);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_24_Template_input_ngModelChange_7_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.consignorGST, $event) || (ctx_r2.editingStock.consignorGST = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"label\");\n    i0.ɵɵtext(9, \"Address: \");\n    i0.ɵɵelementStart(10, \"input\", 56);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_24_Template_input_ngModelChange_10_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.consignorAddress, $event) || (ctx_r2.editingStock.consignorAddress = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"label\");\n    i0.ɵɵtext(12, \"Phone: \");\n    i0.ɵɵelementStart(13, \"input\", 56);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_24_Template_input_ngModelChange_13_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.consignorPhone, $event) || (ctx_r2.editingStock.consignorPhone = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.consignor);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.clientList);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.consignorGST);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.consignorAddress);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.consignorPhone);\n  }\n}\nfunction ManifestComponent_div_46_div_25_option_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const guest_r14 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", guest_r14.guestName);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\"\", guest_r14.guestName, \", \", guest_r14.address, \"\");\n  }\n}\nfunction ManifestComponent_div_46_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 43)(1, \"label\");\n    i0.ɵɵtext(2, \"Guest Name: \");\n    i0.ɵɵelementStart(3, \"select\", 9);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_25_Template_select_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.consignor, $event) || (ctx_r2.editingStock.consignor = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"change\", function ManifestComponent_div_46_div_25_Template_select_change_3_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.onConsignorGuestSelect(ctx_r2.editingStock.consignor));\n    });\n    i0.ɵɵtemplate(4, ManifestComponent_div_46_div_25_option_4_Template, 2, 3, \"option\", 11);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"label\");\n    i0.ɵɵtext(6, \"Address: \");\n    i0.ɵɵelementStart(7, \"input\", 56);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_25_Template_input_ngModelChange_7_listener($event) {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.consignorAddress, $event) || (ctx_r2.editingStock.consignorAddress = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"label\");\n    i0.ɵɵtext(9, \"Phone: \");\n    i0.ɵɵelementStart(10, \"input\", 56);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_25_Template_input_ngModelChange_10_listener($event) {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.consignorPhone, $event) || (ctx_r2.editingStock.consignorPhone = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.consignor);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.guestList);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.consignorAddress);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.consignorPhone);\n  }\n}\nfunction ManifestComponent_div_46_div_34_option_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const client_r16 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", client_r16.clientName);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\"\", client_r16.clientName, \", \", client_r16.address, \"\");\n  }\n}\nfunction ManifestComponent_div_46_div_34_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 43)(1, \"label\");\n    i0.ɵɵtext(2, \"Consignee: \");\n    i0.ɵɵelementStart(3, \"select\", 9);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_34_Template_select_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.consignee, $event) || (ctx_r2.editingStock.consignee = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"change\", function ManifestComponent_div_46_div_34_Template_select_change_3_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.onConsigneeSelect(ctx_r2.editingStock.consignee));\n    });\n    i0.ɵɵtemplate(4, ManifestComponent_div_46_div_34_option_4_Template, 2, 3, \"option\", 11);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"label\");\n    i0.ɵɵtext(6, \"GSTIN: \");\n    i0.ɵɵelementStart(7, \"input\", 56);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_34_Template_input_ngModelChange_7_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.consigneeGST, $event) || (ctx_r2.editingStock.consigneeGST = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"label\");\n    i0.ɵɵtext(9, \"Address: \");\n    i0.ɵɵelementStart(10, \"input\", 56);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_34_Template_input_ngModelChange_10_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.consigneeAddress, $event) || (ctx_r2.editingStock.consigneeAddress = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"label\");\n    i0.ɵɵtext(12, \"Phone: \");\n    i0.ɵɵelementStart(13, \"input\", 56);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_34_Template_input_ngModelChange_13_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.consigneePhone, $event) || (ctx_r2.editingStock.consigneePhone = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.consignee);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.clientList);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.consigneeGST);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.consigneeAddress);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.consigneePhone);\n  }\n}\nfunction ManifestComponent_div_46_div_35_option_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const guest_r18 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", guest_r18.guestName);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\"\", guest_r18.guestName, \", \", guest_r18.address, \"\");\n  }\n}\nfunction ManifestComponent_div_46_div_35_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 43)(1, \"label\");\n    i0.ɵɵtext(2, \"Guest Name: \");\n    i0.ɵɵelementStart(3, \"select\", 9);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_35_Template_select_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.consignee, $event) || (ctx_r2.editingStock.consignee = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"change\", function ManifestComponent_div_46_div_35_Template_select_change_3_listener() {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.onConsigneeGuestSelect(ctx_r2.editingStock.consignee));\n    });\n    i0.ɵɵtemplate(4, ManifestComponent_div_46_div_35_option_4_Template, 2, 3, \"option\", 11);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"label\");\n    i0.ɵɵtext(6, \"Address: \");\n    i0.ɵɵelementStart(7, \"input\", 56);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_35_Template_input_ngModelChange_7_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.consigneeAddress, $event) || (ctx_r2.editingStock.consigneeAddress = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"label\");\n    i0.ɵɵtext(9, \"Phone: \");\n    i0.ɵɵelementStart(10, \"input\", 56);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_35_Template_input_ngModelChange_10_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.consigneePhone, $event) || (ctx_r2.editingStock.consigneePhone = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.consignee);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.guestList);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.consigneeAddress);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.consigneePhone);\n  }\n}\nfunction ManifestComponent_div_46_div_59_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 43)(1, \"label\");\n    i0.ɵɵtext(2, \"Name: \");\n    i0.ɵɵelementStart(3, \"input\", 21);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_59_Template_input_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.billingName, $event) || (ctx_r2.editingStock.billingName = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"label\");\n    i0.ɵɵtext(5, \"GSTIN: \");\n    i0.ɵɵelementStart(6, \"input\", 21);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_59_Template_input_ngModelChange_6_listener($event) {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.billingGSTIN, $event) || (ctx_r2.editingStock.billingGSTIN = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"label\");\n    i0.ɵɵtext(8, \"Address: \");\n    i0.ɵɵelementStart(9, \"textarea\", 21);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_59_Template_textarea_ngModelChange_9_listener($event) {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.billingAddress, $event) || (ctx_r2.editingStock.billingAddress = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.billingName);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.billingGSTIN);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.billingAddress);\n  }\n}\nfunction ManifestComponent_div_46_div_63_div_8_option_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const pkgItem_r25 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", pkgItem_r25.pkgName);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(pkgItem_r25.pkgName);\n  }\n}\nfunction ManifestComponent_div_46_div_63_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r23 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 63)(1, \"select\", 9);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_63_div_8_Template_select_ngModelChange_1_listener($event) {\n      const pkg_r24 = i0.ɵɵrestoreView(_r23).$implicit;\n      i0.ɵɵtwoWayBindingSet(pkg_r24.type, $event) || (pkg_r24.type = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"change\", function ManifestComponent_div_46_div_63_div_8_Template_select_change_1_listener() {\n      const pkg_r24 = i0.ɵɵrestoreView(_r23).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r2.onPackageList(pkg_r24.pkgName));\n    });\n    i0.ɵɵtemplate(2, ManifestComponent_div_46_div_63_div_8_option_2_Template, 2, 2, \"option\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"input\", 64);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_63_div_8_Template_input_ngModelChange_3_listener($event) {\n      const pkg_r24 = i0.ɵɵrestoreView(_r23).$implicit;\n      i0.ɵɵtwoWayBindingSet(pkg_r24.amount, $event) || (pkg_r24.amount = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 61);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_46_div_63_div_8_Template_button_click_4_listener() {\n      const j_r26 = i0.ɵɵrestoreView(_r23).index;\n      const i_r22 = i0.ɵɵnextContext().index;\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.deletePackage(i_r22, j_r26));\n    });\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const pkg_r24 = ctx.$implicit;\n    const j_r26 = ctx.index;\n    const i_r22 = i0.ɵɵnextContext().index;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵtwoWayProperty(\"ngModel\", pkg_r24.type);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.pkgList);\n    i0.ɵɵadvance();\n    i0.ɵɵtwoWayProperty(\"ngModel\", pkg_r24.amount);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"dY-`?,? Delete Package \", i_r22, \"/\", j_r26, \"\");\n  }\n}\nfunction ManifestComponent_div_46_div_63_div_13_option_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const productItem_r29 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", productItem_r29.productName);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\" \", productItem_r29.hsnNum, \" - \", productItem_r29.productName, \" \");\n  }\n}\nfunction ManifestComponent_div_46_div_63_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r27 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 63)(1, \"select\", 9);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_63_div_13_Template_select_ngModelChange_1_listener($event) {\n      const product_r28 = i0.ɵɵrestoreView(_r27).$implicit;\n      i0.ɵɵtwoWayBindingSet(product_r28.type, $event) || (product_r28.type = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"change\", function ManifestComponent_div_46_div_63_div_13_Template_select_change_1_listener() {\n      const product_r28 = i0.ɵɵrestoreView(_r27).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r2.onPackageList(product_r28.productName));\n    });\n    i0.ɵɵtemplate(2, ManifestComponent_div_46_div_63_div_13_option_2_Template, 2, 3, \"option\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"input\", 65);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_63_div_13_Template_input_ngModelChange_3_listener($event) {\n      const product_r28 = i0.ɵɵrestoreView(_r27).$implicit;\n      i0.ɵɵtwoWayBindingSet(product_r28.amount, $event) || (product_r28.amount = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"focus\", function ManifestComponent_div_46_div_63_div_13_Template_input_focus_3_listener() {\n      const product_r28 = i0.ɵɵrestoreView(_r27).$implicit;\n      const ctx_r29 = i0.ɵɵnextContext();\n      const invoice_r21 = ctx_r29.$implicit;\n      const i_r22 = ctx_r29.index;\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.onProductAmountFocus(invoice_r21, product_r28, i_r22));\n    })(\"ngModelChange\", function ManifestComponent_div_46_div_63_div_13_Template_input_ngModelChange_3_listener($event) {\n      const product_r28 = i0.ɵɵrestoreView(_r27).$implicit;\n      const ctx_r29 = i0.ɵɵnextContext();\n      const invoice_r21 = ctx_r29.$implicit;\n      const i_r22 = ctx_r29.index;\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.onProductAmountChange(invoice_r21, product_r28, $event, i_r22));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 61);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_46_div_63_div_13_Template_button_click_4_listener() {\n      const k_r31 = i0.ɵɵrestoreView(_r27).index;\n      const i_r22 = i0.ɵɵnextContext().index;\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.deleteProduct(i_r22, k_r31));\n    });\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const product_r28 = ctx.$implicit;\n    const k_r31 = ctx.index;\n    const i_r22 = i0.ɵɵnextContext().index;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵtwoWayProperty(\"ngModel\", product_r28.type);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.productList);\n    i0.ɵɵadvance();\n    i0.ɵɵtwoWayProperty(\"ngModel\", product_r28.amount);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"dY-`?,? Delete Product \", i_r22, \"/\", k_r31, \"\");\n  }\n}\nfunction ManifestComponent_div_46_div_63_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 57)(1, \"div\", 58)(2, \"input\", 59);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_63_Template_input_ngModelChange_2_listener($event) {\n      const invoice_r21 = i0.ɵɵrestoreView(_r20).$implicit;\n      i0.ɵɵtwoWayBindingSet(invoice_r21.number, $event) || (invoice_r21.number = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"input\", 60);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_div_63_Template_input_ngModelChange_3_listener($event) {\n      const invoice_r21 = i0.ɵɵrestoreView(_r20).$implicit;\n      i0.ɵɵtwoWayBindingSet(invoice_r21.value, $event) || (invoice_r21.value = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 61);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_46_div_63_Template_button_click_4_listener() {\n      const i_r22 = i0.ɵɵrestoreView(_r20).index;\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.deleteInvoice(i_r22));\n    });\n    i0.ɵɵtext(5, \"Delete Invoice\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"h4\");\n    i0.ɵɵtext(7, \"Packages\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(8, ManifestComponent_div_46_div_63_div_8_Template, 6, 5, \"div\", 62);\n    i0.ɵɵelementStart(9, \"button\", 51);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_46_div_63_Template_button_click_9_listener() {\n      const i_r22 = i0.ɵɵrestoreView(_r20).index;\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.addPackage(i_r22));\n    });\n    i0.ɵɵtext(10, \"+ Add Package\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"h4\");\n    i0.ɵɵtext(12, \"Products\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(13, ManifestComponent_div_46_div_63_div_13_Template, 6, 5, \"div\", 62);\n    i0.ɵɵelementStart(14, \"button\", 51);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_46_div_63_Template_button_click_14_listener() {\n      const i_r22 = i0.ɵɵrestoreView(_r20).index;\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.addProduct(i_r22));\n    });\n    i0.ɵɵtext(15, \"+ Add Product\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const invoice_r21 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtwoWayProperty(\"ngModel\", invoice_r21.number);\n    i0.ɵɵadvance();\n    i0.ɵɵtwoWayProperty(\"ngModel\", invoice_r21.value);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngForOf\", invoice_r21.packages);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngForOf\", invoice_r21.products);\n  }\n}\nfunction ManifestComponent_div_46_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 38)(1, \"div\", 39)(2, \"div\", 40)(3, \"div\")(4, \"h3\");\n    i0.ɵɵtext(5, \"Edit Stock\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 41);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(8, \"div\", 42)(9, \"div\", 43)(10, \"label\");\n    i0.ɵɵtext(11, \"E-way Bill No: \");\n    i0.ɵɵelementStart(12, \"input\", 21);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_Template_input_ngModelChange_12_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.ewaybillNumber, $event) || (ctx_r2.editingStock.ewaybillNumber = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(13, \"label\");\n    i0.ɵɵtext(14, \"Date: \");\n    i0.ɵɵelementStart(15, \"input\", 44);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_Template_input_ngModelChange_15_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.date, $event) || (ctx_r2.editingStock.date = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(16, \"div\", 42)(17, \"h4\");\n    i0.ɵɵtext(18, \"Consignor\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"div\", 45)(20, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_46_Template_button_click_20_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.editingStock.consignorTab = \"consignor\");\n    });\n    i0.ɵɵtext(21, \"Consignor\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_46_Template_button_click_22_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.editingStock.consignorTab = \"guest\");\n    });\n    i0.ɵɵtext(23, \"Guest\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(24, ManifestComponent_div_46_div_24_Template, 14, 5, \"div\", 46)(25, ManifestComponent_div_46_div_25_Template, 11, 4, \"div\", 46);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(26, \"div\", 42)(27, \"h4\");\n    i0.ɵɵtext(28, \"Consignee\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(29, \"div\", 45)(30, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_46_Template_button_click_30_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.editingStock.consigneeTab = \"consignee\");\n    });\n    i0.ɵɵtext(31, \"Consignee\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(32, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_46_Template_button_click_32_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.editingStock.consigneeTab = \"guest\");\n    });\n    i0.ɵɵtext(33, \"Guest\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(34, ManifestComponent_div_46_div_34_Template, 14, 5, \"div\", 46)(35, ManifestComponent_div_46_div_35_Template, 11, 4, \"div\", 46);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(36, \"div\", 42)(37, \"div\", 43)(38, \"label\");\n    i0.ɵɵtext(39, \"Payment Mode: \");\n    i0.ɵɵelementStart(40, \"select\", 21);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_Template_select_ngModelChange_40_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.paymentMode, $event) || (ctx_r2.editingStock.paymentMode = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementStart(41, \"option\");\n    i0.ɵɵtext(42, \"Account Credit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(43, \"option\");\n    i0.ɵɵtext(44, \"Paid\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(45, \"option\");\n    i0.ɵɵtext(46, \"To Pay\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(47, \"label\");\n    i0.ɵɵtext(48, \"External Ref ID: \");\n    i0.ɵɵelementStart(49, \"input\", 21);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_Template_input_ngModelChange_49_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.externalRefId, $event) || (ctx_r2.editingStock.externalRefId = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(50, \"h4\");\n    i0.ɵɵtext(51, \"Billing Type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(52, \"div\", 47)(53, \"label\")(54, \"input\", 48);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_Template_input_ngModelChange_54_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.billingType, $event) || (ctx_r2.editingStock.billingType = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(55, \" Consignor's GST Address\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(56, \"label\")(57, \"input\", 49);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_Template_input_ngModelChange_57_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.billingType, $event) || (ctx_r2.editingStock.billingType = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(58, \" Different Address\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(59, ManifestComponent_div_46_div_59_Template, 10, 3, \"div\", 46);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(60, \"section\", 42)(61, \"h3\");\n    i0.ɵɵtext(62, \"4. Invoice\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(63, ManifestComponent_div_46_div_63_Template, 16, 4, \"div\", 50);\n    i0.ɵɵelementStart(64, \"button\", 51);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_46_Template_button_click_64_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.addInvoice());\n    });\n    i0.ɵɵtext(65, \"+ Add Invoice\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(66, \"div\", 42)(67, \"h4\");\n    i0.ɵɵtext(68, \"Charges\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(69, \"div\", 43)(70, \"label\");\n    i0.ɵɵtext(71, \"ODC: \");\n    i0.ɵɵelementStart(72, \"input\", 52);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_Template_input_ngModelChange_72_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.charges.odc, $event) || (ctx_r2.editingStock.charges.odc = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(73, \"label\");\n    i0.ɵɵtext(74, \"Unloading: \");\n    i0.ɵɵelementStart(75, \"input\", 52);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_Template_input_ngModelChange_75_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.charges.unloading, $event) || (ctx_r2.editingStock.charges.unloading = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(76, \"label\");\n    i0.ɵɵtext(77, \"Docket: \");\n    i0.ɵɵelementStart(78, \"input\", 52);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_Template_input_ngModelChange_78_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.charges.docket, $event) || (ctx_r2.editingStock.charges.docket = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(79, \"label\");\n    i0.ɵɵtext(80, \"Other: \");\n    i0.ɵɵelementStart(81, \"input\", 52);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_Template_input_ngModelChange_81_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.charges.other, $event) || (ctx_r2.editingStock.charges.other = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(82, \"label\");\n    i0.ɵɵtext(83, \"CCC: \");\n    i0.ɵɵelementStart(84, \"input\", 52);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_Template_input_ngModelChange_84_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.charges.ccc, $event) || (ctx_r2.editingStock.charges.ccc = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(85, \"label\");\n    i0.ɵɵtext(86, \"Final Amount: \");\n    i0.ɵɵelementStart(87, \"input\", 52);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_46_Template_input_ngModelChange_87_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.editingStock.finalAmount, $event) || (ctx_r2.editingStock.finalAmount = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(88, \"div\", 53)(89, \"button\", 54);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_46_Template_button_click_89_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.calculateFinalAmount());\n    });\n    i0.ɵɵtext(90, \"Calculate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(91, \"button\", 55);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_46_Template_button_click_91_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.saveStockEdit());\n    });\n    i0.ɵɵtext(92, \"Save\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(93, \"button\", 54);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_46_Template_button_click_93_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.cancelEdit());\n    });\n    i0.ɵɵtext(94, \"Cancel\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate2(\"Consignment No: \", ctx_r2.editingStock.consignmentNumber, \" | Status: \", ctx_r2.editingStock.shipmentStatus, \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.ewaybillNumber);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.date);\n    i0.ɵɵadvance(5);\n    i0.ɵɵclassProp(\"active\", ctx_r2.editingStock.consignorTab === \"consignor\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassProp(\"active\", ctx_r2.editingStock.consignorTab === \"guest\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.editingStock.consignorTab === \"consignor\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.editingStock.consignorTab === \"guest\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵclassProp(\"active\", ctx_r2.editingStock.consigneeTab === \"consignee\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassProp(\"active\", ctx_r2.editingStock.consigneeTab === \"guest\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.editingStock.consigneeTab === \"consignee\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.editingStock.consigneeTab === \"guest\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.paymentMode);\n    i0.ɵɵadvance(9);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.externalRefId);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.billingType);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.billingType);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.editingStock.billingType === \"different\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.editingStock.invoices);\n    i0.ɵɵadvance(9);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.charges.odc);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.charges.unloading);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.charges.docket);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.charges.other);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.charges.ccc);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.editingStock.finalAmount);\n  }\n}\nfunction ManifestComponent_div_47_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r33 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"p\")(2, \"strong\");\n    i0.ɵɵtext(3, \"Consignment:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\")(6, \"strong\");\n    i0.ɵɵtext(7, \"Product:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"p\")(10, \"strong\");\n    i0.ɵɵtext(11, \"New Total Qty:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"p\")(14, \"strong\");\n    i0.ɵɵtext(15, \"In Stock Qty:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"input\", 71);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_47_div_4_Template_input_ngModelChange_16_listener($event) {\n      i0.ɵɵrestoreView(_r33);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.pendingManifestAdjustment.popupInstock, $event) || (ctx_r2.pendingManifestAdjustment.popupInstock = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"ngModelChange\", function ManifestComponent_div_47_div_4_Template_input_ngModelChange_16_listener($event) {\n      i0.ɵɵrestoreView(_r33);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.onPopupInstockChange($event));\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.pendingManifestAdjustment.consignmentNumber, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.pendingManifestAdjustment.productType, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.getPopupTargetTotal(), \" \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.pendingManifestAdjustment.popupInstock);\n  }\n}\nfunction ManifestComponent_div_47_table_5_tr_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r34 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\")(9, \"input\", 71);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_47_table_5_tr_12_Template_input_ngModelChange_9_listener($event) {\n      const line_r35 = i0.ɵɵrestoreView(_r34).$implicit;\n      i0.ɵɵtwoWayBindingSet(line_r35.newManifestQty, $event) || (line_r35.newManifestQty = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"ngModelChange\", function ManifestComponent_div_47_table_5_tr_12_Template_input_ngModelChange_9_listener() {\n      const line_r35 = i0.ɵɵrestoreView(_r34).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r2.onManifestQtyChange(line_r35));\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const line_r35 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(line_r35.manifestationNumber);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(5, 4, line_r35.date, \"short\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(line_r35.invoiceNumber);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtwoWayProperty(\"ngModel\", line_r35.newManifestQty);\n  }\n}\nfunction ManifestComponent_div_47_table_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 14)(1, \"thead\")(2, \"tr\")(3, \"th\");\n    i0.ɵɵtext(4, \"Manifest No.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6, \"Date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\");\n    i0.ɵɵtext(8, \"Invoice\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"Qty\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(11, \"tbody\");\n    i0.ɵɵtemplate(12, ManifestComponent_div_47_table_5_tr_12_Template, 10, 7, \"tr\", 35);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(12);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.manifestAdjustmentLines);\n  }\n}\nfunction ManifestComponent_div_47_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r32 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 66)(1, \"div\", 67)(2, \"h3\");\n    i0.ɵɵtext(3, \"Adjust Manifest Quantities\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, ManifestComponent_div_47_div_4_Template, 17, 4, \"div\", 68)(5, ManifestComponent_div_47_table_5_Template, 13, 1, \"table\", 69);\n    i0.ɵɵelementStart(6, \"p\")(7, \"strong\");\n    i0.ɵɵtext(8, \"Manifest Total:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(9);\n    i0.ɵɵelementStart(10, \"strong\");\n    i0.ɵɵtext(11, \"Delivered Total:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"div\", 70)(14, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_47_Template_button_click_14_listener() {\n      i0.ɵɵrestoreView(_r32);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.applyManifestAdjustments());\n    });\n    i0.ɵɵtext(15, \"Apply\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_47_Template_button_click_16_listener() {\n      i0.ɵɵrestoreView(_r32);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.cancelManifestAdjustments());\n    });\n    i0.ɵɵtext(17, \"Cancel\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.pendingManifestAdjustment);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.manifestAdjustmentLines.length > 0);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.getManifestLineTotal(), \" | \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.getPopupDeliveredTotal(), \"\");\n  }\n}\nfunction ManifestComponent_div_48_div_6_div_2_p_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\")(1, \"strong\");\n    i0.ɵɵtext(2, \"Eway Bill created:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const consignment_r38 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", consignment_r38.ewaybillNumber, \" \");\n  }\n}\nfunction ManifestComponent_div_48_div_6_div_2_ng_template_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\")(1, \"strong\");\n    i0.ɵɵtext(2, \"Eway Bill created:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \" No\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ManifestComponent_div_48_div_6_div_2_li_12_li_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r39 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\")(1, \"div\", 78)(2, \"span\")(3, \"strong\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"span\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"span\")(8, \"input\", 79);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_div_48_div_6_div_2_li_12_li_5_Template_input_ngModelChange_8_listener($event) {\n      const product_r40 = i0.ɵɵrestoreView(_r39).$implicit;\n      i0.ɵɵtwoWayBindingSet(product_r40.manifestQty, $event) || (product_r40.manifestQty = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const product_r40 = ctx.$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(product_r40.type);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" Total: \", product_r40.amount, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"max\", product_r40.instock);\n    i0.ɵɵtwoWayProperty(\"ngModel\", product_r40.manifestQty);\n  }\n}\nfunction ManifestComponent_div_48_div_6_div_2_li_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\")(1, \"strong\");\n    i0.ɵɵtext(2, \"Invoice:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3);\n    i0.ɵɵelementStart(4, \"ul\");\n    i0.ɵɵtemplate(5, ManifestComponent_div_48_div_6_div_2_li_12_li_5_Template, 9, 4, \"li\", 35);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const invoice_r41 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", invoice_r41.number, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", invoice_r41.products);\n  }\n}\nfunction ManifestComponent_div_48_div_6_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 76)(1, \"h4\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 77);\n    i0.ɵɵtemplate(4, ManifestComponent_div_48_div_6_div_2_p_4_Template, 4, 1, \"p\", 74)(5, ManifestComponent_div_48_div_6_div_2_ng_template_5_Template, 4, 0, \"ng-template\", null, 1, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"p\")(8, \"strong\");\n    i0.ɵɵtext(9, \"Consignor:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"ul\");\n    i0.ɵɵtemplate(12, ManifestComponent_div_48_div_6_div_2_li_12_Template, 6, 2, \"li\", 35);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(13, \"hr\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const consignment_r38 = ctx.$implicit;\n    const ewayNotCreated_r42 = i0.ɵɵreference(6);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Consignment: \", consignment_r38.consignmentNumber, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", consignment_r38.ewaybillNumber)(\"ngIfElse\", ewayNotCreated_r42);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\" \", consignment_r38.consignor, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", consignment_r38.invoices);\n  }\n}\nfunction ManifestComponent_div_48_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r37 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"hr\");\n    i0.ɵɵtemplate(2, ManifestComponent_div_48_div_6_div_2_Template, 14, 5, \"div\", 75);\n    i0.ɵɵelementStart(3, \"div\", 70)(4, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_48_div_6_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r37);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.finalizeManifestation());\n    });\n    i0.ɵɵtext(5, \"Delivered\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_48_div_6_Template_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r37);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.closeManifestationPopup());\n    });\n    i0.ɵɵtext(7, \"Cancel\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.selectedForManifestation);\n  }\n}\nfunction ManifestComponent_div_48_ng_template_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r43 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"No consignments selected for manifestation.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_48_ng_template_7_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r43);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.closeManifestationPopup());\n    });\n    i0.ɵɵtext(3, \"Close\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ManifestComponent_div_48_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r36 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 66)(1, \"div\", 72)(2, \"span\", 73);\n    i0.ɵɵlistener(\"click\", function ManifestComponent_div_48_Template_span_click_2_listener() {\n      i0.ɵɵrestoreView(_r36);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.closeManifestationPopup());\n    });\n    i0.ɵɵtext(3, \"\\u00D7\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"h2\");\n    i0.ɵɵtext(5, \"Delivered Terminal\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, ManifestComponent_div_48_div_6_Template, 8, 1, \"div\", 74)(7, ManifestComponent_div_48_ng_template_7_Template, 4, 0, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const noSelection_r44 = i0.ɵɵreference(8);\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.selectedForManifestation.length > 0)(\"ngIfElse\", noSelection_r44);\n  }\n}\nexport let ManifestComponent = /*#__PURE__*/(() => {\n  class ManifestComponent {\n    constructor() {\n      this.stocks = [];\n      this.filteredStocks = [];\n      this.activeTab = 'stocks';\n      this.searchText = '';\n      this.filterDate = '';\n      this.filterConsignor = '';\n      this.filterRoute = '';\n      this.filterStatus = 'Manifestation';\n      this.routeOptions = [];\n      this.selectedHubFilterId = null;\n      this.selectedHubFilterName = '';\n      this.selectedStock = null;\n      this.editingStock = null;\n    }\n    static {\n      this.ɵfac = function ManifestComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || ManifestComponent)();\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: ManifestComponent,\n        selectors: [[\"app-manifest\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 49,\n        vars: 17,\n        consts: [[\"noSelection\", \"\"], [\"ewayNotCreated\", \"\"], [1, \"stocks-container\"], [1, \"stocks-tabs\"], [3, \"click\"], [1, \"filters\"], [\"type\", \"text\", \"placeholder\", \"Search by consignment no. or consignor\", 3, \"ngModelChange\", \"input\", \"ngModel\"], [\"type\", \"date\", 3, \"ngModelChange\", \"change\", \"ngModel\"], [\"type\", \"text\", \"placeholder\", \"Filter by consignor\", 3, \"ngModelChange\", \"input\", \"ngModel\"], [3, \"ngModelChange\", \"change\", \"ngModel\"], [\"value\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [3, \"ngModel\", \"ngModelChange\", 4, \"ngIf\"], [1, \"actions\"], [1, \"stocks-table\"], [\"type\", \"checkbox\", 3, \"change\"], [3, \"click\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"modal details-modal\", 4, \"ngIf\"], [\"class\", \"modal edit-stock-modal\", 4, \"ngIf\"], [\"class\", \"modal\", 4, \"ngIf\"], [3, \"value\"], [3, \"ngModelChange\", \"ngModel\"], [\"type\", \"checkbox\", 3, \"ngModelChange\", \"click\", \"ngModel\"], [1, \"modal\", \"details-modal\"], [1, \"modal-content\", \"details-content\"], [\"type\", \"button\", 1, \"details-close\", 3, \"click\"], [1, \"details-header\"], [1, \"details-sub\"], [1, \"details-status\"], [1, \"stock-details\", \"details-grid\"], [1, \"details-products\"], [\"class\", \"details-invoice\", 4, \"ngFor\", \"ngForOf\"], [1, \"details-invoice\"], [1, \"details-invoice-title\"], [1, \"details-product-list\"], [4, \"ngFor\", \"ngForOf\"], [1, \"product-name\"], [1, \"product-meta\"], [1, \"modal\", \"edit-stock-modal\"], [1, \"modal-content\", \"edit-stock-content\"], [1, \"edit-stock-header\"], [1, \"edit-stock-meta\"], [1, \"edit-stock-section\"], [1, \"edit-stock-grid\"], [\"type\", \"date\", 3, \"ngModelChange\", \"ngModel\"], [1, \"tabs\", \"edit-stock-tabs\"], [\"class\", \"edit-stock-grid\", 4, \"ngIf\"], [1, \"edit-stock-radio\"], [\"type\", \"radio\", \"name\", \"billing\", \"value\", \"consignor\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"radio\", \"name\", \"billing\", \"value\", \"different\", 3, \"ngModelChange\", \"ngModel\"], [\"class\", \"invoice-block\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"button\", 1, \"ghost\", 3, \"click\"], [\"type\", \"number\", 3, \"ngModelChange\", \"ngModel\"], [1, \"edit-stock-actions\"], [1, \"ghost\", 3, \"click\"], [1, \"primary\", 3, \"click\"], [\"readonly\", \"\", 3, \"ngModelChange\", \"ngModel\"], [1, \"invoice-block\"], [1, \"grid-3\"], [\"placeholder\", \"Invoice Number\", 3, \"ngModelChange\", \"ngModel\"], [\"placeholder\", \"Invoice Value\", \"type\", \"number\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"button\", 1, \"danger\", 3, \"click\"], [\"class\", \"grid-4\", 4, \"ngFor\", \"ngForOf\"], [1, \"grid-4\"], [\"placeholder\", \"Amount*\", \"type\", \"number\", 3, \"ngModelChange\", \"ngModel\"], [\"placeholder\", \"Amount*\", \"type\", \"number\", 3, \"ngModelChange\", \"focus\", \"ngModel\"], [1, \"modal\"], [1, \"modal-content\"], [4, \"ngIf\"], [\"class\", \"stocks-table\", 4, \"ngIf\"], [1, \"terminal-buttons\"], [\"type\", \"number\", \"min\", \"0\", 3, \"ngModelChange\", \"ngModel\"], [1, \"modal-content\", \"terminal-style\"], [1, \"close\", 3, \"click\"], [4, \"ngIf\", \"ngIfElse\"], [\"class\", \"consignment-block\", 4, \"ngFor\", \"ngForOf\"], [1, \"consignment-block\"], [1, \"ewaybill-section\"], [1, \"product-line\"], [\"type\", \"number\", \"min\", \"0\", \"readonly\", \"\", \"disabled\", \"\", 1, \"manifest-input\", 3, \"ngModelChange\", \"max\", \"ngModel\"]],\n        template: function ManifestComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 2)(1, \"h2\");\n            i0.ɵɵtext(2, \"Manifested/ On Delivery\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(3, \"div\", 3)(4, \"button\", 4);\n            i0.ɵɵlistener(\"click\", function ManifestComponent_Template_button_click_4_listener() {\n              return ctx.setActiveTab(\"stocks\");\n            });\n            i0.ɵɵtext(5, \" Stocks \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(6, \"button\", 4);\n            i0.ɵɵlistener(\"click\", function ManifestComponent_Template_button_click_6_listener() {\n              return ctx.setActiveTab(\"other-branch\");\n            });\n            i0.ɵɵtext(7, \" Stocks in Other branch \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(8, \"button\", 4);\n            i0.ɵɵlistener(\"click\", function ManifestComponent_Template_button_click_8_listener() {\n              return ctx.setActiveTab(\"others-in-branch\");\n            });\n            i0.ɵɵtext(9, \" Others stocks in our branch \");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(10, \"div\", 5)(11, \"input\", 6);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_Template_input_ngModelChange_11_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.searchText, $event) || (ctx.searchText = $event);\n              return $event;\n            });\n            i0.ɵɵlistener(\"input\", function ManifestComponent_Template_input_input_11_listener() {\n              return ctx.applyFilters();\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(12, \"input\", 7);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_Template_input_ngModelChange_12_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.filterDate, $event) || (ctx.filterDate = $event);\n              return $event;\n            });\n            i0.ɵɵlistener(\"change\", function ManifestComponent_Template_input_change_12_listener() {\n              return ctx.applyFilters();\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(13, \"input\", 8);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_Template_input_ngModelChange_13_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.filterConsignor, $event) || (ctx.filterConsignor = $event);\n              return $event;\n            });\n            i0.ɵɵlistener(\"input\", function ManifestComponent_Template_input_input_13_listener() {\n              return ctx.applyFilters();\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(14, \"select\", 9);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function ManifestComponent_Template_select_ngModelChange_14_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.filterRoute, $event) || (ctx.filterRoute = $event);\n              return $event;\n            });\n            i0.ɵɵlistener(\"change\", function ManifestComponent_Template_select_change_14_listener() {\n              return ctx.applyFilters();\n            });\n            i0.ɵɵelementStart(15, \"option\", 10);\n            i0.ɵɵtext(16, \"All routes\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(17, ManifestComponent_option_17_Template, 2, 2, \"option\", 11);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(18, ManifestComponent_select_18_Template, 2, 2, \"select\", 12);\n            i0.ɵɵelementStart(19, \"button\", 4);\n            i0.ɵɵlistener(\"click\", function ManifestComponent_Template_button_click_19_listener() {\n              return ctx.openManifestationPopup();\n            });\n            i0.ɵɵtext(20, \"Delivery\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(21, \"button\", 4);\n            i0.ɵɵlistener(\"click\", function ManifestComponent_Template_button_click_21_listener() {\n              return ctx.printReceipts();\n            });\n            i0.ɵɵtext(22, \"??? Print Receipts\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelement(23, \"div\", 13);\n            i0.ɵɵelementStart(24, \"table\", 14)(25, \"thead\")(26, \"tr\")(27, \"th\")(28, \"input\", 15);\n            i0.ɵɵlistener(\"change\", function ManifestComponent_Template_input_change_28_listener($event) {\n              return ctx.toggleAllSelection($event);\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(29, \"th\");\n            i0.ɵɵtext(30, \"Consignment No.\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(31, \"th\");\n            i0.ɵɵtext(32, \"Status\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(33, \"th\");\n            i0.ɵɵtext(34, \"Consignor\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(35, \"th\");\n            i0.ɵɵtext(36, \"Branch\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(37, \"th\");\n            i0.ɵɵtext(38, \"Current Branch\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(39, \"th\");\n            i0.ɵɵtext(40, \"No. of Products\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(41, \"th\");\n            i0.ɵɵtext(42, \"Actions\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(43, \"tbody\");\n            i0.ɵɵtemplate(44, ManifestComponent_tr_44_Template, 18, 7, \"tr\", 16);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵtemplate(45, ManifestComponent_div_45_Template, 174, 45, \"div\", 17)(46, ManifestComponent_div_46_Template, 95, 28, \"div\", 18)(47, ManifestComponent_div_47_Template, 18, 4, \"div\", 19)(48, ManifestComponent_div_48_Template, 9, 2, \"div\", 19);\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(4);\n            i0.ɵɵclassProp(\"active\", ctx.activeTab === \"stocks\");\n            i0.ɵɵadvance(2);\n            i0.ɵɵclassProp(\"active\", ctx.activeTab === \"other-branch\");\n            i0.ɵɵadvance(2);\n            i0.ɵɵclassProp(\"active\", ctx.activeTab === \"others-in-branch\");\n            i0.ɵɵadvance(3);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.searchText);\n            i0.ɵɵadvance();\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.filterDate);\n            i0.ɵɵadvance();\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.filterConsignor);\n            i0.ɵɵadvance();\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.filterRoute);\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"ngForOf\", ctx.routeOptions);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.branchId === \"all-hubs\");\n            i0.ɵɵadvance(26);\n            i0.ɵɵproperty(\"ngForOf\", ctx.filteredStocks);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.selectedStock);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.editingStock);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.showManifestAdjustmentPopup);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.showManifestationPopup);\n          }\n        },\n        dependencies: [CommonModule, i1.NgForOf, i1.NgIf, i1.DatePipe, FormsModule, i2.NgSelectOption, i2.ɵNgSelectMultipleOption, i2.DefaultValueAccessor, i2.NumberValueAccessor, i2.CheckboxControlValueAccessor, i2.SelectControlValueAccessor, i2.RadioControlValueAccessor, i2.NgControlStatus, i2.MinValidator, i2.MaxValidator, i2.NgModel],\n        styles: [\".stocks-container[_ngcontent-%COMP%]{padding:20px;color:var(--stock-text)}[_nghost-%COMP%]{--stock-bg: #f6f8fb;--stock-card: #ffffff;--stock-border: #e5e7eb;--stock-text: #0f172a;--stock-muted: #6b7280;--stock-primary: #2563eb;--stock-primary-strong: #1e3a8a;--stock-danger: #dc2626}.filters[_ngcontent-%COMP%]{display:flex;gap:10px;margin-bottom:15px;flex-wrap:wrap}.stocks-tabs[_ngcontent-%COMP%]{display:flex;gap:10px;margin-bottom:12px}.stocks-tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 14px;border-radius:999px;border:1px solid var(--stock-border);background:#fff;color:var(--stock-muted);cursor:pointer}.stocks-tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#eef2ff;border-color:#c7d2fe;color:var(--stock-primary-strong);font-weight:600}.filters[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filters[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:8px 10px;border:1px solid var(--stock-border);border-radius:10px;background:#fff;color:var(--stock-text);flex:1 1 190px;min-width:0}.filters[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 14px;border-radius:10px;border:1px solid var(--stock-border);background:#fff;color:var(--stock-text);cursor:pointer;flex:0 0 auto}.filters[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{border-color:var(--stock-primary);color:var(--stock-primary-strong)}@media (max-width: 1200px){.filters[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filters[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:7px 9px;font-size:13px}.filters[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .stocks-tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:7px 12px;font-size:13px}.stocks-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .stocks-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:7px;font-size:13px}}@media (max-width: 992px){.filters[_ngcontent-%COMP%]{gap:8px}.filters[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filters[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:6px 8px;font-size:12px}.filters[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .stocks-tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 10px;font-size:12px}.stocks-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .stocks-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:6px;font-size:12px}}@media (max-width: 768px){.filters[_ngcontent-%COMP%]{gap:6px}.filters[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filters[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:5px 7px;font-size:11px}.filters[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .stocks-tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px 8px;font-size:11px}.stocks-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .stocks-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px;font-size:11px}}.stocks-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background:var(--stock-card);border:1px solid var(--stock-border);border-radius:12px;overflow:hidden}.stocks-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .stocks-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid var(--stock-border);padding:8px;text-align:left}.stocks-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f8fafc;font-weight:600}.stocks-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8fafc;cursor:pointer}.stocks-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border-radius:10px;border:1px solid var(--stock-primary);background:var(--stock-primary);color:#fff;cursor:pointer}.stocks-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:var(--stock-primary-strong);border-color:var(--stock-primary-strong)}.actions[_ngcontent-%COMP%]{margin-top:15px}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0009;display:flex;align-items:center;justify-content:center}.modal-content[_ngcontent-%COMP%]{background:#fff;padding:20px;width:500px;max-height:80vh;overflow-y:auto;border-radius:8px;position:relative}.details-modal[_ngcontent-%COMP%]{background:#0f172a8c}.details-content[_ngcontent-%COMP%]{background:var(--stock-bg);color:var(--stock-text);width:min(860px,92vw);max-height:85vh;border-radius:16px;border:1px solid var(--stock-border);box-shadow:0 18px 40px #0f172a33}.details-close[_ngcontent-%COMP%]{position:absolute;right:18px;top:12px;background:transparent;border:none;font-size:24px;cursor:pointer;color:var(--stock-muted)}.details-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:16px;gap:12px}.details-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:22px}.details-sub[_ngcontent-%COMP%]{margin:6px 0 0;color:var(--stock-muted);font-size:13px}.details-status[_ngcontent-%COMP%]{background:#e0f2fe;color:#0ea5e9;padding:6px 10px;border-radius:999px;font-size:12px;font-weight:600;white-space:nowrap}.details-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px 16px;background:var(--stock-card);border:1px solid var(--stock-border);border-radius:12px;padding:12px;margin-bottom:16px}.details-products[_ngcontent-%COMP%]{display:grid;gap:12px}.details-invoice[_ngcontent-%COMP%]{background:var(--stock-card);border:1px solid var(--stock-border);border-radius:12px;padding:12px}.details-invoice-title[_ngcontent-%COMP%]{font-weight:600;margin-bottom:8px}.details-product-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;display:grid;gap:8px}.details-product-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;justify-content:space-between;border-bottom:1px solid var(--stock-border);padding-bottom:6px}.details-product-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{border-bottom:none}.product-name[_ngcontent-%COMP%]{font-weight:600}.product-meta[_ngcontent-%COMP%]{color:var(--stock-muted);font-size:13px}@media (max-width: 700px){.details-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.details-product-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}.edit-stock-modal[_ngcontent-%COMP%]{background:#0f172a8c}.edit-stock-content[_ngcontent-%COMP%]{background:var(--stock-bg);color:var(--stock-text);width:min(1100px,92vw);max-height:85vh;border-radius:16px;border:1px solid var(--stock-border);box-shadow:0 18px 40px #0f172a33}.edit-stock-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:16px}.edit-stock-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:22px;color:var(--stock-text)}.edit-stock-meta[_ngcontent-%COMP%]{margin:6px 0 0;color:var(--stock-muted);font-size:13px}.edit-stock-section[_ngcontent-%COMP%]{background:var(--stock-card);border:1px solid var(--stock-border);border-radius:12px;padding:14px;margin-bottom:14px}.edit-stock-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 10px;font-size:15px}.edit-stock-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}.edit-stock-content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;font-weight:600;font-size:13px;color:var(--stock-text)}.edit-stock-content[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .edit-stock-content[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .edit-stock-content[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{border:1px solid var(--stock-border);border-radius:10px;padding:8px 10px;font-size:13px;background:#fff;color:var(--stock-text)}.edit-stock-content[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{min-height:80px;resize:vertical}.edit-stock-tabs[_ngcontent-%COMP%]{display:flex;gap:8px;margin-bottom:12px}.edit-stock-tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;border-radius:999px;border:1px solid var(--stock-border);background:#fff;color:var(--stock-muted);cursor:pointer}.edit-stock-tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#eef2ff;border-color:#c7d2fe;color:var(--stock-primary-strong);font-weight:600}.edit-stock-radio[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:12px;margin:10px 0 4px;color:var(--stock-muted);font-size:13px}.edit-stock-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;margin-top:12px}.edit-stock-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:10px;border:1px solid var(--stock-border);padding:8px 14px;font-size:13px;cursor:pointer;background:#fff;color:var(--stock-text)}.edit-stock-content[_ngcontent-%COMP%]   button.primary[_ngcontent-%COMP%]{background:var(--stock-primary);border-color:var(--stock-primary);color:#fff}.edit-stock-content[_ngcontent-%COMP%]   button.ghost[_ngcontent-%COMP%]{background:#f8fafc;color:var(--stock-text)}.edit-stock-content[_ngcontent-%COMP%]   button.danger[_ngcontent-%COMP%]{border-color:#fecaca;background:#fef2f2;color:var(--stock-danger)}.edit-stock-content[_ngcontent-%COMP%]   .grid-3[_ngcontent-%COMP%], .edit-stock-content[_ngcontent-%COMP%]   .grid-4[_ngcontent-%COMP%]{gap:10px}.edit-stock-content[_ngcontent-%COMP%]   .grid-3[_ngcontent-%COMP%], .edit-stock-content[_ngcontent-%COMP%]   .grid-4[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,minmax(0,1fr))}@media (max-width: 900px){.edit-stock-grid[_ngcontent-%COMP%], .edit-stock-content[_ngcontent-%COMP%]   .grid-3[_ngcontent-%COMP%], .edit-stock-content[_ngcontent-%COMP%]   .grid-4[_ngcontent-%COMP%]{grid-template-columns:1fr}.edit-stock-actions[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}}.close[_ngcontent-%COMP%]{position:absolute;right:15px;top:10px;font-size:24px;cursor:pointer}.modal-content.terminal-style[_ngcontent-%COMP%]{background-color:#1e1e1e;color:#d4d4d4;font-family:Courier New,monospace;border-radius:10px;padding:20px;width:80%;max-height:80vh;overflow-y:auto}.consignment-block[_ngcontent-%COMP%]{background:#2a2a2a;padding:10px;border-radius:6px;margin-bottom:10px}.terminal-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:15px}.terminal-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 20px;border:none;border-radius:6px;cursor:pointer}.terminal-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{background-color:#007acc;color:#fff}.terminal-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{background-color:#555;color:#fff}.product-line[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:4px 0}.manifest-input[_ngcontent-%COMP%]{width:60px;padding:4px;margin-left:4px;background-color:#333;color:#fff;border:1px solid #555;border-radius:4px;text-align:right}.eway-toggle-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;position:relative;cursor:pointer;-webkit-user-select:none;user-select:none}.eway-toggle-input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.eway-toggle-slider[_ngcontent-%COMP%]{position:relative;width:40px;height:20px;background-color:#ccc;border-radius:20px;transition:background-color .3s}.eway-toggle-slider[_ngcontent-%COMP%]:before{content:\\\"\\\";position:absolute;height:16px;width:16px;left:2px;bottom:2px;background-color:#fff;border-radius:50%;transition:transform .3s}.eway-toggle-input[_ngcontent-%COMP%]:checked + .eway-toggle-slider[_ngcontent-%COMP%]{background-color:#4caf50}.eway-toggle-input[_ngcontent-%COMP%]:checked + .eway-toggle-slider[_ngcontent-%COMP%]:before{transform:translate(20px)}.eway-toggle-text[_ngcontent-%COMP%]{font-weight:500}.routing-section[_ngcontent-%COMP%]{margin-top:20px}.routing-controls[_ngcontent-%COMP%]{display:flex;gap:10px;margin-bottom:10px}.route-list[_ngcontent-%COMP%]{list-style:none;padding-left:0}.route-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.remove-btn[_ngcontent-%COMP%]{background:none;border:none;color:red;cursor:pointer}\"]\n      });\n    }\n  }\n  return ManifestComponent;\n})(); // G�� track which stock is being edited  // BillingbillingType: 'consignor' | 'different' = 'consignor';billingName = '';billingAddress = '';billingGSTIN = '';billingPhone = '';clientList: any[] = [];guestList: any[] = [];pkgList: any[] = [];productList: any[] = [];// PickuppickupType: 'consignor' | 'different' = 'consignor';pickupName = '';pickupAddress = '';pickupPhone = '';// DeliverydeliveryType: 'consignee' | 'different' = 'consignee';deliveryName = '';deliveryAddress = '';deliveryPhone = ''; consignorTab: 'consignor' | 'guest' = 'consignor';consigneeTab: 'consignee' | 'guest' = 'consignee';email: string = '';username: string = '';branch: string = localStorage.getItem('branch') || 'All Branches';branchId: string = localStorage.getItem('branchId') || 'all';consignmentNumber: string = localStorage.getItem('consignmentNumber')||'-999'; // will be loaded asynchronouslydate: string = new Date().toISOString().split('T')[0];ewaybillNumber: string = '';consignor: string = '';consignorGST: string = '';consignorAddress: string = '';consignorPhone: string = '';consignee: string = '';consigneeGST: string = '';consigneeAddress: string = '';consigneePhone: string = '';paymentMode: string = 'Account Credit';externalRefId: string = '';invoices = [{ number: '', value: 0 }];packages = [{ type: '', amount: 1 }];products = [{ type: '', amount: 1 }];charges = { odc: 0, unloading: 0, docket: 0, other: 0, ccc: 0 };finalAmount: number = 0;shipmentStatus: string = 'Pending';shipmentStatusDetails: string = '';branches: any[] = [];hubs: any[] = [];  availableRoutePoints: { name: string; type: 'Branch' | 'Hub'; vehicles: string[] }[] = [];  shipmentRoute: { name: string; type: 'Branch' | 'Hub'; vehicleNo: string }[] = [];  selectedRoutePoint: any = null;  selectedRouteVehicle: string = '';  routeBaskets: Array<{ labelKey: string; qty: number }> = [];  private branchSub?: Subscription;  private branchCheck: any;  constructor(    private http: HttpClient,    private branchService: BranchService  ) {} // --- Methods ---addInvoice() {  this.editingStock.invoices.push({    number: '',    value: 0,    packages: [],    products: []  });}deleteInvoice(index: number) {  this.editingStock.invoices.splice(index, 1);}addPackage(invoiceIndex: number) {  const invoice = this.editingStock.invoices[invoiceIndex];  if (!invoice.packages) {    invoice.packages = [];  }  invoice.packages.push({ type: '', amount: 1 });}deletePackage(invoiceIndex: number, packageIndex: number) {  const invoice = this.editingStock.invoices[invoiceIndex];  if (invoice.packages && invoice.packages.length > packageIndex) {    invoice.packages.splice(packageIndex, 1);  }}addProduct(invoiceIndex: number) {  const invoice = this.editingStock.invoices[invoiceIndex];  if (!invoice.products) {    invoice.products = [];  }  invoice.products.push({ type: '', amount: 1, instock: 0, intransitstock: 0, deliveredstock: 0 });}deleteProduct(invoiceIndex: number, productIndex: number) {  const invoice = this.editingStock.invoices[invoiceIndex];  if (invoice.products && invoice.products.length > productIndex) {    const product = invoice.products[productIndex];    if (this.isProductManifested(product)) {      alert('This product has been manifested and cannot be deleted.');      return;    }    invoice.products.splice(productIndex, 1);  }}calculateFinalAmount() {  const invoiceTotal = this.editingStock.invoices.reduce((sum: number, i: { value: number }) => sum + (i.value || 0), 0);  const packageTotal = this.editingStock.packages.reduce((sum: number, p: { amount: number }) => sum + (p.amount || 0), 0);  const chargeTotal = Object.values(this.charges).reduce((sum: number, c: any) => sum + (Number(c) || 0), 0);  this.editingStock.finalAmount = invoiceTotal + packageTotal + chargeTotal;}  loadStocks() {    const username = this.username || localStorage.getItem('username') || '';    const branchId = this.branchId || localStorage.getItem('branchId') || 'all';    if (!username) {      console.error('Missing username for loading stocks');      return;    }    const branchParamRaw = this.activeTab === 'stocks' ? branchId : 'all';    const branchParam = branchParamRaw === 'all-hubs' ? 'all' : branchParamRaw;    this.http.get<any[]>('http://localhost:3000/api/newshipments', {      params: {        username,        branchId: branchParam      }    }).subscribe({      next: (res: any[]) => {        const normalized = (res || []).map((stock) => ({          ...stock,          invoices: this.flattenInvoices(stock.ewaybills || stock.invoices || [])        }));        this.stocks = this.getBaseStocks(normalized)          .sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());        this.routeOptions = this.buildRouteOptions(this.stocks);        this.applyFilters();      },      error: (err: any) => console.error('Error loading shipments:', err)    });  }  private flattenInvoices(ewaybills: any[]): any[] {    return (ewaybills || []).flatMap((ewb) => ewb.invoices || []);  }  getInStockAmountTotal(invoices: any[]): number {    let total = 0;    (invoices || []).forEach((inv) => {      (inv.products || []).forEach((prod: any) => {        total += Number(prod.instock || 0);      });    });    return total;  }  getInvoiceAmountTotal(invoices: any[]): number {    let total = 0;    (invoices || []).forEach((inv) => {      (inv.products || []).forEach((prod: any) => {        total += Number(prod.amount || 0);      });    });    return total;  }  getRoutesDisplay(stock: any): string {    const routes = this.getRoutesForStock(stock);    return routes.length ? routes.join(', ') : '-';  }  private getRoutesForStock(stock: any): string[] {    const routes = (stock?.ewaybills || [])      .map((ewb: any) => String(ewb?.routes || '').trim())      .map((route: string) => route.replace(/\\$\\$/g, '').trim())      .filter((route: string) => route);    return Array.from(new Set(routes));  }  private normalizeId(value: any): string {    if (!value) return '';    if (typeof value === 'string') return value;    if (value?._id) return String(value._id);    if (value?.$oid) return String(value.$oid);    return String(value);  }  private formatLocationDisplay(idValue: any, labelValue: any): string {    const rawId = this.normalizeId(idValue);    const rawLabel = String(labelValue || '').trim();    let resolvedId = rawId;    let resolvedName = '';    const branchById = rawId      ? (this.branches || []).find((b) => this.normalizeId(b?._id) === rawId)      : null;    if (branchById?._id) {      resolvedId = this.normalizeId(branchById._id);      resolvedName = String(branchById.branchName || '').trim();    } else {      const hubById = rawId        ? (this.hubs || []).find((h) => this.normalizeId(h?._id) === rawId)        : null;      if (hubById?._id) {        resolvedId = this.normalizeId(hubById._id);        resolvedName = String(hubById.hubName || '').trim();      }    }    if (!resolvedName && rawLabel) {      const labelLower = rawLabel.toLowerCase();      const branchByName = (this.branches || []).find(        (b) => String(b?.branchName || '').trim().toLowerCase() === labelLower      );      if (branchByName?._id) {        resolvedId = this.normalizeId(branchByName._id);        resolvedName = String(branchByName.branchName || '').trim();      } else {        const hubByName = (this.hubs || []).find(          (h) => String(h?.hubName || '').trim().toLowerCase() === labelLower        );        if (hubByName?._id) {          resolvedId = this.normalizeId(hubByName._id);          resolvedName = String(hubByName.hubName || '').trim();        }      }    }    const name = resolvedName || rawLabel || resolvedId || '-';    if (!resolvedId) return name;    if (name.toLowerCase() === String(resolvedId).toLowerCase()) return name;    return `${name}$$${resolvedId}`;  }  getOriginBranchDisplay(stock: any): string {    return this.formatLocationDisplay(stock?.branchId || stock?.branch, stock?.branch);  }  getCurrentBranchDisplay(stock: any): string {    return this.formatLocationDisplay(      stock?.currentLocationId || stock?.currentBranchId || stock?.currentBranch,      stock?.currentBranch    );  }  private getBranchIdByName(name: string): string {    const target = String(name || '').trim().toLowerCase();    if (!target) return '';    const branch = (this.branches || []).find((b) =>      String(b?.branchName || '').trim().toLowerCase() === target    );    return branch?._id ? String(branch._id) : '';  }  private getBranchNameById(id: string): string {    const target = this.normalizeId(id);    if (!target) return '';    const branch = (this.branches || []).find((b) => this.normalizeId(b?._id) === target);    return branch?.branchName ? String(branch.branchName) : '';  }  private getHubById(id: string): any | null {    const target = this.normalizeId(id);    if (!target) return null;    return (this.hubs || []).find((h) => this.normalizeId(h?._id) === target) || null;  }  private matchesSelectedBranch(branchIdValue: string, branchLabel: string, selectedBranchId: string): boolean {    if (!selectedBranchId) return false;    const normalizedSelected = this.normalizeId(selectedBranchId);    if (branchIdValue && this.normalizeId(branchIdValue) === normalizedSelected) return true;    const hub = this.getHubById(normalizedSelected);    if (hub) {      const hubBranchId = this.normalizeId(hub?.branchId || hub?.branch);      if (hubBranchId && this.normalizeId(branchIdValue) === hubBranchId) return true;      const hubName = String(hub?.hubName || '').trim();      if (hubName && branchLabel) {        if (String(branchLabel).trim().toLowerCase() === hubName.toLowerCase()) return true;      }      const hubBranchName = this.getBranchNameById(hubBranchId);      if (hubBranchName && branchLabel) {        if (String(branchLabel).trim().toLowerCase() === hubBranchName.toLowerCase()) return true;      }    }    const selectedName = this.getBranchNameById(normalizedSelected);    if (selectedName && branchLabel) {      return String(branchLabel).trim().toLowerCase() === String(selectedName).trim().toLowerCase();    }    return false;  }  private isCurrentBranchMatch(currentBranchId: string, uiBranchId: string): boolean {    if (!currentBranchId || !uiBranchId) return false;    if (this.normalizeId(currentBranchId) === this.normalizeId(uiBranchId)) return true;    const uiBranchName = this.getBranchNameById(uiBranchId);    if (      uiBranchName &&      String(currentBranchId || '').trim().toLowerCase() === String(uiBranchName).trim().toLowerCase()    ) {      return true;    }    const hub = (this.hubs || []).find((h) => this.normalizeId(h?._id) === this.normalizeId(currentBranchId));    if (!hub?.branch) return false;    const branchId = this.getBranchIdByName(hub.branch);    return branchId ? this.normalizeId(branchId) === this.normalizeId(uiBranchId) : false;  }  private matchesBranchLabel(currentBranch: string, branchLabel: string): boolean {    const current = String(currentBranch || '').trim().toLowerCase();    const label = String(branchLabel || '').trim().toLowerCase();    if (!current || !label) return false;    if (label === current) return true;    if (label.startsWith(`${current}-`)) return true;    const labelPrefix = label.split('-')[0].trim();    return Boolean(labelPrefix) && labelPrefix === current;  }  private isAllowedManifestStatus(status: string): boolean {    return status === 'Manifestation' ||      status === 'Out for Delivery' ||      status === 'Will be Picked-Up';  }  private isAllowedDeliveryStatus(status: string): boolean {    return status === 'DManifestation' ||      status === 'D-Out for Delivery' ||      status === 'D-Will be Picked-Up';  }  private isCompanyMatch(stock: any): boolean {    const gstinId = String(localStorage.getItem('GSTIN_ID') || '').trim();    if (!gstinId) return true;    const stockGstin = String(stock?.GSTIN_ID ?? stock?.gstinId ?? '').trim();    if (!stockGstin) return false;    return stockGstin === gstinId;  }  private getLastStatusDetailBranchId(statusDetails: string): string {    if (!statusDetails) return '';    const parts = String(statusDetails)      .split('$$')      .map((part) => String(part || '').trim())      .filter(Boolean);    return parts.length ? parts[parts.length - 1] : '';  }  private getBaseStocks(allStocks: any[]): any[] {    const branchId = this.branchId || localStorage.getItem('branchId') || 'all';    if (branchId === 'all') {      if (this.activeTab === 'other-branch' || this.activeTab === 'others-in-branch') {        return (allStocks || []).filter(stock => {          const status = String(stock.shipmentStatus || '').trim();          if (!this.isAllowedDeliveryStatus(status)) return false;          const originBranchId = this.normalizeId(stock.branchId || stock.branch);          const currentBranchId = this.normalizeId(            stock.currentLocationId || stock.currentBranchId || stock.currentBranch          );          return originBranchId && currentBranchId && originBranchId !== currentBranchId;        });      }      return (allStocks || []).filter(stock => {        const status = String(stock.shipmentStatus || '').trim();        return this.isAllowedManifestStatus(status);      });    }    if (this.activeTab === 'other-branch') {      const branchId = this.branchId || localStorage.getItem('branchId') || 'all';      const selectedLocationId = branchId === 'all-hubs'        ? this.normalizeId(this.selectedHubFilterId)        : this.normalizeId(branchId);      if (!selectedLocationId || selectedLocationId === 'all') return [];      const selectedBranch = (this.branches || []).find(        (b) => this.normalizeId(b?._id) === selectedLocationId      );      const selectedHub = selectedBranch        ? null        : (this.hubs || []).find((h) => this.normalizeId(h?._id) === selectedLocationId);      const selectedName = String(selectedBranch?.branchName || selectedHub?.hubName || '').trim();      const selectedNameLower = selectedName.toLowerCase();      return (allStocks || []).filter(stock => {        const status = String(stock.shipmentStatus || '').trim();        if (!this.isAllowedDeliveryStatus(status)) return false;        const originBranchId = this.normalizeId(stock.branchId || stock.branch);        const originBranchLabel = String(stock.branch || '').trim();        const currentBranchId = this.normalizeId(          stock.currentLocationId || stock.currentBranchId || stock.currentBranch        );        const isIdMatch = Boolean(originBranchId) && originBranchId === selectedLocationId;        const isNameMatch = Boolean(selectedName) && Boolean(originBranchLabel) && (          originBranchLabel.toLowerCase() === selectedNameLower ||          this.matchesBranchLabel(originBranchLabel, selectedName)        );        return originBranchId && currentBranchId && (isIdMatch || isNameMatch) && originBranchId !== currentBranchId;      });    }    if (this.activeTab === 'others-in-branch') {      const branchId = this.branchId || localStorage.getItem('branchId') || 'all';      const selectedLocationId = branchId === 'all-hubs'        ? this.normalizeId(this.selectedHubFilterId)        : this.normalizeId(branchId);      if (!selectedLocationId || selectedLocationId === 'all') return [];      const selectedBranch = (this.branches || []).find(        (b) => this.normalizeId(b?._id) === selectedLocationId      );      const selectedHub = selectedBranch        ? null        : (this.hubs || []).find((h) => this.normalizeId(h?._id) === selectedLocationId);      const selectedName = String(selectedBranch?.branchName || selectedHub?.hubName || '').trim();      const selectedNameLower = selectedName.toLowerCase();      return (allStocks || []).filter(stock => {        const status = String(stock.shipmentStatus || '').trim();        if (!this.isAllowedDeliveryStatus(status)) return false;        const originBranchId = this.normalizeId(stock.branchId || stock.branch);        const currentBranchId = this.normalizeId(          stock.currentLocationId || stock.currentBranchId || stock.currentBranch        );        const currentBranchLabel = String(stock.currentBranch || '').trim();        const isIdMatch = Boolean(currentBranchId) && currentBranchId === selectedLocationId;        const isNameMatch = Boolean(selectedName) && Boolean(currentBranchLabel) && (          currentBranchLabel.toLowerCase() === selectedNameLower ||          this.matchesBranchLabel(currentBranchLabel, selectedName)        );        return originBranchId && currentBranchId && (isIdMatch || isNameMatch) && originBranchId !== currentBranchId;      });    }    const selectedBranchId = this.getSelectedManifestBranchId();    if (!selectedBranchId) return [];    return (allStocks || []).filter(stock => {      const status = String(stock.shipmentStatus || '').trim();      if (!this.isAllowedManifestStatus(status)) return false;      const currentBranchId = this.normalizeId(        stock.currentLocationId || stock.currentBranchId || stock.currentBranch      );      const currentBranchLabel = String(stock.currentBranch || '').trim();      return currentBranchId && this.matchesSelectedBranch(currentBranchId, currentBranchLabel, selectedBranchId);    });  }  private getSelectedManifestBranchId(): string {    const branchId = this.branchId || localStorage.getItem('branchId') || 'all';    if (branchId === 'all-hubs') {      return this.normalizeId(this.selectedHubFilterId);    }    if (!branchId || branchId === 'all') return '';    return this.normalizeId(branchId);  }  getDeliveryDisplayName(stock: any): string {    const name = String(stock?.deliveryName || '').trim();    if (name) return name;    const deliveryId = this.normalizeId(stock?.deliveryID);    if (!deliveryId) return '-';    const branch = (this.branches || []).find(b => this.normalizeId(b?._id) === deliveryId);    if (branch?.branchName) return branch.branchName;    const client = (this.clientList || []).find(c => this.normalizeId(c?._id) === deliveryId);    if (client?.clientName) return client.clientName;    const guest = (this.guestList || []).find(g => this.normalizeId(g?._id) === deliveryId);    if (guest?.guestName) return guest.guestName;    return deliveryId;  }  private firstNonEmpty(...values: any[]): string {    for (const value of values) {      if (value === undefined || value === null) continue;      const text = String(value).trim();      if (text) return text;    }    return '-';  }  private resolveClientByIdOrName(id: any, name: any): any | null {    const normId = this.normalizeId(id);    const normName = String(name || '').trim().toLowerCase();    return (this.clientList || []).find((c) =>      (normId && this.normalizeId(c?._id) === normId) ||      (normName && String(c?.clientName || '').trim().toLowerCase() === normName)    ) || null;  }  private resolveGuestByIdOrName(id: any, name: any): any | null {    const normId = this.normalizeId(id);    const normName = String(name || '').trim().toLowerCase();    return (this.guestList || []).find((g) =>      (normId && this.normalizeId(g?._id) === normId) ||      (normName && String(g?.guestName || '').trim().toLowerCase() === normName)    ) || null;  }  private resolveBranchByIdOrName(id: any, name: any): any | null {    const normId = this.normalizeId(id);    const normName = String(name || '').trim().toLowerCase();    return (this.branches || []).find((b) =>      (normId && this.normalizeId(b?._id) === normId) ||      (normName && String(b?.branchName || '').trim().toLowerCase() === normName)    ) || null;  }  private resolveHubByIdOrName(id: any, name: any): any | null {    const normId = this.normalizeId(id);    const normName = String(name || '').trim().toLowerCase();    return (this.hubs || []).find((h) =>      (normId && this.normalizeId(h?._id) === normId) ||      (normName && String(h?.hubName || '').trim().toLowerCase() === normName)    ) || null;  }  private resolveBranchByVehicle(vehicleNo: string): any | null {    const target = String(vehicleNo || '').trim().toLowerCase();    if (!target) return null;    return (this.branches || []).find((b) =>      (b?.vehicles || []).some((v: any) => String(v?.vehicleNo || '').trim().toLowerCase() === target)    ) || null;  }  private resolveHubByVehicle(vehicleNo: string): any | null {    const target = String(vehicleNo || '').trim().toLowerCase();    if (!target) return null;    return (this.hubs || []).find((h) =>      (h?.deliveryAddresses || []).some((addr: any) =>        (addr?.vehicles || []).some((v: any) => String(v?.vehicleNo || '').trim().toLowerCase() === target)      )    ) || null;  }  private findVehicleStatus(vehicleNo: string): string {    const target = String(vehicleNo || '').trim().toLowerCase();    if (!target) return '';    for (const branch of this.branches || []) {      const match = (branch?.vehicles || []).find((v: any) =>        String(v?.vehicleNo || '').trim().toLowerCase() === target      );      if (match) return String(match?.vehicleStatus || '').trim().toLowerCase();    }    for (const hub of this.hubs || []) {      for (const addr of hub?.deliveryAddresses || []) {        const match = (addr?.vehicles || []).find((v: any) =>          String(v?.vehicleNo || '').trim().toLowerCase() === target        );        if (match) return String(match?.vehicleStatus || '').trim().toLowerCase();      }    }    return '';  }  private resolveVehicleOwner(    vehicleNo: string,    fallbackType?: any,    fallbackId?: any  ): { ownerType: 'Branch' | 'Hub' | ''; ownerId: string } {    const ownerTypeRaw = String(fallbackType || '').trim().toLowerCase();    const ownerIdRaw = String(fallbackId || '').trim();    if (ownerIdRaw && (ownerTypeRaw === 'branch' || ownerTypeRaw === 'hub')) {      return { ownerType: ownerTypeRaw === 'branch' ? 'Branch' : 'Hub', ownerId: ownerIdRaw };    }    const ownerBranch = this.resolveBranchByVehicle(vehicleNo);    if (ownerBranch?._id) return { ownerType: 'Branch', ownerId: String(ownerBranch._id) };    const ownerHub = this.resolveHubByVehicle(vehicleNo);    if (ownerHub?._id) return { ownerType: 'Hub', ownerId: String(ownerHub._id) };    return { ownerType: '', ownerId: '' };  }  private resolveClientLocation(client: any, locationId: any): any | null {    if (!client) return null;    const normId = this.normalizeId(locationId);    const locations = client?.deliveryLocations || [];    if (!normId) return locations[0] || null;    return locations.find((loc: any) => this.normalizeId(loc?.delivery_id) === normId) || null;  }  private enrichShipmentDetails(stock: any): any {    const enriched = { ...stock };    const consignor = stock?.consignorTab === 'guest'      ? this.resolveGuestByIdOrName(stock?.consignorId, stock?.consignor)      : this.resolveClientByIdOrName(stock?.consignorId, stock?.consignor);    const consignee = stock?.consigneeTab === 'guest'      ? this.resolveGuestByIdOrName(stock?.consigneeId, stock?.consignee)      : this.resolveClientByIdOrName(stock?.consigneeId, stock?.consignee);    enriched.consignor = this.firstNonEmpty(enriched.consignor, consignor?.clientName, consignor?.guestName);    enriched.consignorGST = this.firstNonEmpty(enriched.consignorGST, consignor?.GSTIN, stock?.consignorTab === 'guest' ? 'GUEST' : '');    enriched.consignorPhone = this.firstNonEmpty(enriched.consignorPhone, consignor?.phoneNum);    enriched.consignorAddress = this.firstNonEmpty(enriched.consignorAddress, consignor?.address);    enriched.consignee = this.firstNonEmpty(enriched.consignee, consignee?.clientName, consignee?.guestName);    enriched.consigneeGST = this.firstNonEmpty(enriched.consigneeGST, consignee?.GSTIN, stock?.consigneeTab === 'guest' ? 'GUEST' : '');    enriched.consigneePhone = this.firstNonEmpty(enriched.consigneePhone, consignee?.phoneNum);    enriched.consigneeAddress = this.firstNonEmpty(enriched.consigneeAddress, consignee?.address);    if (stock?.billingType === 'consignor') {      enriched.billingName = this.firstNonEmpty(enriched.billingName, enriched.consignor);      enriched.billingGSTIN = this.firstNonEmpty(enriched.billingGSTIN, enriched.consignorGST);      enriched.billingPhone = this.firstNonEmpty(enriched.billingPhone, enriched.consignorPhone);      enriched.billingAddress = this.firstNonEmpty(enriched.billingAddress, enriched.consignorAddress);    } else {      const billingClient = this.resolveClientByIdOrName(stock?.billingClientId, stock?.billingName);      enriched.billingName = this.firstNonEmpty(enriched.billingName, billingClient?.clientName);      enriched.billingGSTIN = this.firstNonEmpty(enriched.billingGSTIN, billingClient?.GSTIN);      enriched.billingPhone = this.firstNonEmpty(enriched.billingPhone, billingClient?.phoneNum);      enriched.billingAddress = this.firstNonEmpty(enriched.billingAddress, billingClient?.address);    }    if (stock?.pickupType === 'branch') {      const pickupBranch = this.resolveBranchByIdOrName(stock?.pickupLocationId, stock?.pickupName) ||        this.resolveBranchByIdOrName(null, stock?.branch);      enriched.pickupName = this.firstNonEmpty(enriched.pickupName, pickupBranch?.branchName);      enriched.pickupAddress = this.firstNonEmpty(enriched.pickupAddress, pickupBranch?.address);      enriched.pickupPhone = this.firstNonEmpty(enriched.pickupPhone, pickupBranch?.phoneNum);      enriched.pickupPincode = this.firstNonEmpty(enriched.pickupPincode, pickupBranch?.pinCode);    } else if (stock?.pickupType === 'consignor') {      enriched.pickupName = this.firstNonEmpty(enriched.pickupName, enriched.consignor);      enriched.pickupAddress = this.firstNonEmpty(enriched.pickupAddress, enriched.consignorAddress);      enriched.pickupPhone = this.firstNonEmpty(enriched.pickupPhone, enriched.consignorPhone);      enriched.pickupPincode = this.firstNonEmpty(enriched.pickupPincode, consignor?.pinCode);    }    const isSelfPickup =      stock?.deliveryType === 'Customer self pick up' ||      stock?.deliveryType === 'branch' ||      stock?.deliveryType === 'hub';    if (isSelfPickup) {      const deliveryBranch = this.resolveBranchByIdOrName(stock?.deliveryID, stock?.deliveryName);      const deliveryHub = deliveryBranch ? null : this.resolveHubByIdOrName(stock?.deliveryID, stock?.deliveryName);      enriched.deliveryName = this.firstNonEmpty(enriched.deliveryName, deliveryBranch?.branchName, deliveryHub?.hubName);      enriched.deliveryAddress = this.firstNonEmpty(enriched.deliveryAddress, deliveryBranch?.address, deliveryHub?.address);      enriched.deliveryPhone = this.firstNonEmpty(enriched.deliveryPhone, deliveryBranch?.phoneNum, deliveryHub?.phoneNum);      enriched.deliveryPincode = this.firstNonEmpty(enriched.deliveryPincode, deliveryBranch?.pinCode, deliveryHub?.pinCode);    } else {      const deliveryClient = this.resolveClientByIdOrName(stock?.deliveryID, stock?.deliveryName);      const deliveryGuest = this.resolveGuestByIdOrName(stock?.deliveryID, stock?.deliveryName);      const deliveryLocation = this.resolveClientLocation(deliveryClient, stock?.deliveryLocationId);      enriched.deliveryName = this.firstNonEmpty(enriched.deliveryName, deliveryClient?.clientName, deliveryGuest?.guestName, enriched.consignee);      enriched.deliveryAddress = this.firstNonEmpty(enriched.deliveryAddress, deliveryLocation?.address, deliveryClient?.address, deliveryGuest?.address, enriched.consigneeAddress);      enriched.deliveryPhone = this.firstNonEmpty(enriched.deliveryPhone, deliveryClient?.phoneNum, deliveryGuest?.phoneNum, enriched.consigneePhone);      enriched.deliveryPincode = this.firstNonEmpty(enriched.deliveryPincode, deliveryLocation?.pinCode, deliveryClient?.pinCode, deliveryGuest?.pinCode);    }    return enriched;  }  private buildRouteOptions(stocks: any[]): string[] {    const allRoutes = new Set<string>();    (stocks || []).forEach(stock => {      this.getRoutesForStock(stock).forEach(route => allRoutes.add(route));    });    return Array.from(allRoutes).sort((a, b) => a.localeCompare(b));  }  getProductTotal(ewaybills: any[], field: string): number {    let total = 0;    ewaybills.forEach(ewaybill => {      ewaybill.invoices.forEach((invoice: any) => {        invoice.products.forEach((product: any) => {          total += product[field] || 0;        });      });    });    return total;  }  applyFilters() {    const branchId = this.branchId || localStorage.getItem('branchId') || 'all';    const hubFilterId = this.normalizeId(this.selectedHubFilterId);    const useHubFilter = branchId === 'all-hubs' && (this.activeTab === 'stocks' || this.activeTab === 'other-branch' || this.activeTab === 'others-in-branch');    if (useHubFilter && !hubFilterId) {      const storedHubId = this.normalizeId(localStorage.getItem('hubId'));      const storedHubName = String(localStorage.getItem('hubName') || '').trim();      if (storedHubId) {        const hub = (this.hubs || []).find((h) => this.normalizeId(h?._id) === storedHubId);        this.selectedHubFilterId = storedHubId;        this.selectedHubFilterName = String(hub?.hubName || storedHubName || '').trim();      } else {        const options = this.getAllHubsFilterOptions();        const firstHubId = this.normalizeId(options?.[0]?._id);        this.selectedHubFilterId = firstHubId || null;        this.selectedHubFilterName = String(options?.[0]?.hubName || '').trim();      }    }    const effectiveHubFilterId = this.normalizeId(this.selectedHubFilterId);    if (effectiveHubFilterId && !this.selectedHubFilterName) {      const hub = (this.hubs || []).find((h) => this.normalizeId(h?._id) === effectiveHubFilterId);      this.selectedHubFilterName = String(hub?.hubName || '').trim();    }    const effectiveHubName = this.selectedHubFilterName;    this.filteredStocks = this.stocks.filter(s =>      (this.searchText ? s.consignmentNumber?.includes(this.searchText) || s.consignor?.includes(this.searchText) : true) &&      (this.filterDate ? new Date(s.date).toISOString().split('T')[0] === this.filterDate : true) &&      (this.filterConsignor ? s.consignor?.toLowerCase().includes(this.filterConsignor.toLowerCase()) : true) &&      (this.filterRoute ? this.getRoutesForStock(s).includes(this.filterRoute) : true) &&      (this.filterStatus ? String(s.shipmentStatus || '').trim() === this.filterStatus : true) &&      (!useHubFilter || (effectiveHubFilterId && this.matchesHubFilter(s, effectiveHubFilterId, effectiveHubName)))    );  }  onHubFilterChange(value: string | null) {    this.selectedHubFilterId = value;    const hub = (this.hubs || []).find((h) => this.normalizeId(h?._id) === this.normalizeId(value));    this.selectedHubFilterName = String(hub?.hubName || '').trim();    if (value) {      localStorage.setItem('hubId', String(value));      localStorage.setItem('hubName', this.selectedHubFilterName);    }    this.applyFilters();  }  getAllHubsFilterOptions(): any[] {    return this.hubs || [];  }  private matchesHubFilter(stock: any, hubId: string, hubName: string): boolean {    if (!hubId) return false;    const hasHubName = Boolean(hubName);    if (this.activeTab === 'stocks') {      const currentBranchId = this.normalizeId(        stock?.currentLocationId || stock?.currentBranchId || stock?.currentBranch      );      const currentBranchLabel = String(stock?.currentBranch || '').trim();      return (        currentBranchId === hubId ||        (hasHubName && currentBranchLabel.toLowerCase() === hubName.toLowerCase()) ||        (hasHubName && this.matchesBranchLabel(currentBranchLabel, hubName))      );    }    if (this.activeTab === 'other-branch') {      const originBranchId = this.normalizeId(stock?.branchId || stock?.branch);      const originBranchLabel = String(stock?.branch || '').trim();      return (        originBranchId === hubId ||        (hasHubName && originBranchLabel.toLowerCase() === hubName.toLowerCase()) ||        (hasHubName && this.matchesBranchLabel(originBranchLabel, hubName))      );    }    if (this.activeTab === 'others-in-branch') {      const currentBranchId = this.normalizeId(        stock?.currentLocationId || stock?.currentBranchId || stock?.currentBranch      );      const currentBranchLabel = String(stock?.currentBranch || '').trim();      return (        currentBranchId === hubId ||        (hasHubName && currentBranchLabel.toLowerCase() === hubName.toLowerCase()) ||        (hasHubName && this.matchesBranchLabel(currentBranchLabel, hubName))      );    }    return this.getStockHubId(stock) === hubId;  }  private getStockHubId(stock: any): string {    return (      this.normalizeId(stock?.branchId) ||      this.normalizeId(stock?.currentLocationId || stock?.currentBranchId || stock?.currentBranch)    );  }  toggleAllSelection(event: any) {    const checked = event.target.checked;    this.filteredStocks.forEach(s => s.selected = checked);  }  setActiveTab(tab: 'stocks' | 'other-branch' | 'others-in-branch') {    if (this.activeTab === tab) return;    this.activeTab = tab;    // Ensure the status filter does not hide delivery-status rows on delivery tabs.    if (tab === 'stocks') {      if (this.isAllowedDeliveryStatus(String(this.filterStatus || '').trim())) {        this.filterStatus = 'Manifestation';      }    } else {      if (!this.isAllowedDeliveryStatus(String(this.filterStatus || '').trim())) {        this.filterStatus = '';      }    }    this.loadStocks();  }  openStockDetails(stock: any) {    this.selectedStock = this.enrichShipmentDetails(stock);  }  closeStockDetails() {    this.selectedStock = null;  }    editStock(stock: any) {    console.log('�o?�,? Edit stock:', stock);    const cloned = JSON.parse(JSON.stringify(stock));    cloned.invoices = this.flattenInvoices(cloned.ewaybills || cloned.invoices || []);    this.editingStock = cloned;    this.manifestEditsById = {};    this.pendingManifestAdjustment = null;    this.manifestAdjustmentLines = [];    this.showManifestAdjustmentPopup = false;    this.captureOriginalProductValues(this.editingStock);  }  saveStockEdit() {    if (!this.editingStock) return;    if (this.pendingManifestAdjustment || this.showManifestAdjustmentPopup) {      this.applyManifestAdjustments();      if (this.pendingManifestAdjustment || this.showManifestAdjustmentPopup) {        return;      }    }    this.syncEwaybillsFromInvoices();    console.log(\"kkkkkkkkkkklllllllllllllllll\" + this.editingStock.consignmentNumber);    const payload = this.buildShipmentPayload();    const manifestUpdates = Object.values(this.manifestEditsById || {});    const updateManifests$ = manifestUpdates.length      ? forkJoin(manifestUpdates.map((m: any) =>        this.http.put(`http://localhost:3000/api/manifest/${m._id}`, m)      ))      : of([]);    updateManifests$.subscribe({      next: () => {        this.http.put(`http://localhost:3000/api/newshipments/${payload.consignmentNumber}`, payload)          .subscribe({            next: () => {              console.log('�o. Stock updated');              this.loadStocks();          // reload updated data              this.editingStock = null;   // close modal            },            error: (err) => console.error('�?O Error updating stock:', err)          });      },      error: (err) => {        console.error('�?O Error updating manifests:', err);        alert('Failed to update manifests. Please try again.');      }    });  }  cancelEdit() {    this.editingStock = null;    this.pendingManifestAdjustment = null;    this.manifestAdjustmentLines = [];    this.showManifestAdjustmentPopup = false;  }  private captureOriginalProductValues(stock: any) {    (stock?.invoices || []).forEach((inv: any) => {      (inv.products || []).forEach((prod: any) => {        prod._originalAmount = Number(prod.amount) || 0;        prod._originalInstock = Number(prod.instock) || 0;        prod._originalIntransit = Number(prod.intransitstock) || 0;        prod._originalDelivered = Number(prod.deliveredstock) || 0;      });    });  }  private resetProductToOriginal(product: any) {    product.amount = Number(product._originalAmount) || 0;    product.instock = Number(product._originalInstock) || 0;    product.intransitstock = Number(product._originalIntransit) || 0;    product.deliveredstock = Number(product._originalDelivered) || 0;  }  private normalizeInvoiceNumber(invoice: any): string {    return String(invoice?.number || invoice?.invoicenum || '').trim();  }  private normalizeProductType(product: any): string {    return String(product?.type || '').trim();  }  private getManifestTotals() {    const lines = this.manifestAdjustmentLines || [];    const deliveredTotal = lines      .filter((line) => line?.isDelivered)      .reduce((sum, line) => sum + (Number(line.newManifestQty) || 0), 0);    const manifestTotal = lines.reduce((sum, line) => sum + (Number(line.newManifestQty) || 0), 0);    const intransitTotal = Math.max(0, manifestTotal - deliveredTotal);    return { manifestTotal, deliveredTotal, intransitTotal };  }  private syncEwaybillsFromInvoices() {    if (!this.editingStock?.ewaybills?.length || !this.editingStock?.invoices?.length) return;    for (const flatInv of this.editingStock.invoices || []) {      const flatInvNumber = this.normalizeInvoiceNumber(flatInv);      for (const ewb of this.editingStock.ewaybills || []) {        for (const inv of ewb.invoices || []) {          if (this.normalizeInvoiceNumber(inv) !== flatInvNumber) continue;          for (const prod of inv.products || []) {            const flatProd = (flatInv.products || []).find(              (p: any) => this.normalizeProductType(p) === this.normalizeProductType(prod)            );            if (!flatProd) continue;            prod.amount = flatProd.amount;            prod.instock = flatProd.instock;            prod.intransitstock = flatProd.intransitstock;            prod.deliveredstock = flatProd.deliveredstock;            if (flatProd.manifestQty !== undefined) {              prod.manifestQty = flatProd.manifestQty;            }          }        }      }    }  }  private applyProductUpdate(    invoices: any[],    invoiceNumber: string,    productType: string,    update: (prod: any) => void  ) {    const normalizedInvoice = String(invoiceNumber || '').trim();    const normalizedProduct = String(productType || '').trim();    (invoices || []).forEach((inv: any) => {      const invNumber = this.normalizeInvoiceNumber(inv);      if (normalizedInvoice && invNumber !== normalizedInvoice) return;      (inv.products || []).forEach((prod: any) => {        if (this.normalizeProductType(prod) !== normalizedProduct) return;        update(prod);      });    });  }  private isProductManifested(product: any): boolean {    return Number(product?._originalIntransit ?? product?.intransitstock ?? 0) > 0;  }  onProductAmountFocus(invoice: any, product: any, invoiceIndex?: number) {    if (!this.isProductManifested(product)) return;    this.openManifestAdjustmentPopup(invoice, product, product.amount, invoiceIndex);  }  onProductAmountChange(invoice: any, product: any, rawValue: any, invoiceIndex?: number) {    if (!this.editingStock) return;    let newAmount = Number(rawValue);    if (!Number.isFinite(newAmount)) newAmount = 0;    if (newAmount < 0) newAmount = 0;    const originalAmount = Number(product._originalAmount) || 0;    const originalInstock = Number(product._originalInstock) || 0;    const originalIntransit = Number(product._originalIntransit) || 0;    const originalDelivered = Number(product._originalDelivered) || 0;    if (!this.isProductManifested(product)) {      if (newAmount >= originalAmount) {        const delta = newAmount - originalAmount;        product.amount = newAmount;        product.instock = originalInstock + delta;        product.intransitstock = originalIntransit;        product.deliveredstock = originalDelivered;        return;      }      const reduction = originalAmount - newAmount;      if (reduction <= originalInstock) {        product.amount = newAmount;        product.instock = originalInstock - reduction;        product.intransitstock = originalIntransit;        product.deliveredstock = originalDelivered;        return;      }      alert('Reduction exceeds available in-stock quantity.');      this.resetProductToOriginal(product);      return;    }    const reduction = originalAmount - newAmount;    if (reduction > (originalInstock + originalIntransit)) {      alert('Reduction exceeds available in-stock and manifested quantity.');      this.resetProductToOriginal(product);      return;    }    if (!this.pendingManifestAdjustment || this.pendingManifestAdjustment.productRef !== product) {      this.openManifestAdjustmentPopup(invoice, product, newAmount, invoiceIndex);      return;    }    this.pendingManifestAdjustment.targetAmount = newAmount;    product.amount = newAmount;  }  private openManifestAdjustmentPopup(invoice: any, product: any, targetAmount: any, invoiceIndex?: number) {    const consignmentNumber = this.editingStock?.consignmentNumber;    if (!consignmentNumber) return;    let invoiceNumber = this.normalizeInvoiceNumber(invoice);    if (!invoiceNumber && Number.isFinite(invoiceIndex)) {      invoiceNumber = `MAN-${String(consignmentNumber || '').trim()}-${Number(invoiceIndex) + 1}`;    }    this.pendingManifestAdjustment = {      consignmentNumber,      invoiceNumber,      productType: this.normalizeProductType(product),      targetAmount: Number(targetAmount) || 0,      popupInstock: Number(product._originalInstock) || 0,      originalAmount: Number(product._originalAmount) || 0,      originalInstock: Number(product._originalInstock) || 0,      originalIntransit: Number(product._originalIntransit) || 0,      originalDelivered: Number(product._originalDelivered) || 0,      productRef: product    };    this.http.get<any[]>(`http://localhost:3000/api/manifest/by-consignment/${encodeURIComponent(consignmentNumber)}`)      .subscribe({        next: (res: any[]) => {          this.manifestAdjustments = res || [];          this.buildManifestAdjustmentLines();        },        error: (err) => {          console.error('Error loading manifests:', err);          alert('Failed to load manifests for adjustment.');          this.cancelManifestAdjustments();        }      });  }  private buildManifestAdjustmentLines() {    const pending = this.pendingManifestAdjustment;    if (!pending) return;    const productType = pending.productType;    const consignmentNumber = pending.consignmentNumber;    const lines: any[] = [];    for (const manifest of this.manifestAdjustments || []) {      for (const cons of manifest.consignments || []) {        if (String(cons.consignmentNumber || '').trim() !== consignmentNumber) continue;        for (const inv of cons.invoices || []) {          const invNumber = this.normalizeInvoiceNumber(inv);          if (pending.invoiceNumber && invNumber !== pending.invoiceNumber) continue;          for (const prod of inv.products || []) {            if (this.normalizeProductType(prod) !== productType) continue;            const originalManifestQty = Number(prod.manifestQty) || 0;            lines.push({              manifestId: manifest._id,              manifestationNumber: manifest.manifestationNumber,              date: manifest.date,              manifestStatus: manifest.mshipmentStatus,              consignmentNumber,              invoiceNumber: invNumber,              productType,              originalManifestQty,              newManifestQty: originalManifestQty,              isDelivered: String(manifest.mshipmentStatus || '').toLowerCase() === 'delivered'            });          }        }      }    }    if (!lines.length) {      alert('No manifest lines found for this product.');      this.cancelManifestAdjustments();      return;    }    this.manifestAdjustmentLines = lines;    this.syncPopupInstockWithTarget();    this.showManifestAdjustmentPopup = true;  }  onManifestQtyChange(line: any) {    let value = Number(line.newManifestQty);    if (!Number.isFinite(value)) value = 0;    if (value < 0) value = 0;    line.newManifestQty = value;    const pending = this.pendingManifestAdjustment;    if (!pending) return;    const totals = this.getManifestTotals();    pending.targetAmount = (Number(pending.popupInstock) || 0) + totals.manifestTotal;    if (pending.productRef) {      pending.productRef.amount = Number(pending.targetAmount) || 0;    }  }  getManifestLineTotal(): number {    return this.getManifestTotals().manifestTotal;  }  getPopupTargetTotal(): number {    const pending = this.pendingManifestAdjustment;    if (!pending) return 0;    return Number(pending.targetAmount) || 0;  }  getPopupDeliveredTotal(): number {    return this.getManifestTotals().deliveredTotal;  }  getPopupInstockTotal(): number {    const pending = this.pendingManifestAdjustment;    if (!pending) return 0;    const totals = this.getManifestTotals();    return (Number(pending.targetAmount) || 0) - totals.manifestTotal;  }  private syncPopupInstockWithTarget() {    const pending = this.pendingManifestAdjustment;    if (!pending) return;    const totals = this.getManifestTotals();    const targetAmount = Number(pending.targetAmount) || 0;    const computedInstock = targetAmount - totals.manifestTotal;    pending.popupInstock = Math.max(0, computedInstock);    pending.targetAmount = pending.popupInstock + totals.manifestTotal;  }  private syncTargetFromInstock() {    const pending = this.pendingManifestAdjustment;    if (!pending) return;    const popupInstock = Math.max(0, Number(pending.popupInstock) || 0);    pending.popupInstock = popupInstock;    const totals = this.getManifestTotals();    pending.targetAmount = popupInstock + totals.manifestTotal;  }  onPopupTargetAmountChange(rawValue: any) {    const pending = this.pendingManifestAdjustment;    if (!pending) return;    let newAmount = Number(rawValue);    if (!Number.isFinite(newAmount)) newAmount = 0;    if (newAmount < 0) newAmount = 0;    pending.targetAmount = newAmount;    this.syncPopupInstockWithTarget();    if (pending.productRef) {      pending.productRef.amount = newAmount;    }  }  onPopupInstockChange(rawValue: any) {    const pending = this.pendingManifestAdjustment;    if (!pending) return;    let newInstock = Number(rawValue);    if (!Number.isFinite(newInstock)) newInstock = 0;    if (newInstock < 0) newInstock = 0;    pending.popupInstock = newInstock;    this.syncTargetFromInstock();    if (pending.productRef) {      pending.productRef.amount = Number(pending.targetAmount) || 0;    }  }  applyManifestAdjustments() {    const pending = this.pendingManifestAdjustment;    if (!pending) return;    const totals = this.getManifestTotals();    const instockTotal = Math.max(0, Number(pending.popupInstock) || 0);    const targetAmount = instockTotal + totals.manifestTotal;    if (instockTotal < 0) {      alert('New Total Qty must be at least manifest + delivered quantities.');      return;    }    for (const line of this.manifestAdjustmentLines || []) {      line.updatedAmount = targetAmount;      line.updatedInstock = instockTotal;      line.updatedIntransit = totals.intransitTotal;      line.updatedDelivered = totals.deliveredTotal;    }    for (const line of this.manifestAdjustmentLines || []) {      this.queueManifestUpdate(line);    }    const updateTotals = (prod: any) => {      prod.amount = targetAmount;      prod.instock = instockTotal;      prod.intransitstock = totals.intransitTotal;      prod.deliveredstock = totals.deliveredTotal;      prod.manifestQty = totals.manifestTotal;    };    if (pending.productRef) {      updateTotals(pending.productRef);    }    this.applyProductUpdate(this.editingStock?.invoices || [], pending.invoiceNumber, pending.productType, updateTotals);    (this.editingStock?.ewaybills || []).forEach((ewb: any) => {      this.applyProductUpdate(ewb.invoices || [], pending.invoiceNumber, pending.productType, updateTotals);    });    this.pendingManifestAdjustment = null;    this.manifestAdjustmentLines = [];    this.showManifestAdjustmentPopup = false;  }  cancelManifestAdjustments() {    const pending = this.pendingManifestAdjustment;    if (pending?.productRef) this.resetProductToOriginal(pending.productRef);    this.pendingManifestAdjustment = null;    this.manifestAdjustmentLines = [];    this.showManifestAdjustmentPopup = false;  }  private queueManifestUpdate(line: any) {    const manifest = (this.manifestAdjustments || []).find((m: any) => m._id === line.manifestId);    if (!manifest) return;    for (const cons of manifest.consignments || []) {      if (String(cons.consignmentNumber || '').trim() !== line.consignmentNumber) continue;      for (const inv of cons.invoices || []) {        const invNumber = this.normalizeInvoiceNumber(inv);        if (invNumber !== line.invoiceNumber) continue;        for (const prod of inv.products || []) {          if (this.normalizeProductType(prod) !== line.productType) continue;          prod.manifestQty = Number(line.newManifestQty) || 0;          if (line.updatedAmount !== undefined) {            prod.amount = Number(line.updatedAmount) || 0;            prod.instock = Number(line.updatedInstock) || 0;            prod.intransitstock = Number(line.updatedIntransit) || 0;            prod.deliveredstock = Number(line.updatedDelivered) || 0;          }        }      }    }    this.manifestEditsById[manifest._id] = manifest;  }  private buildShipmentPayload() {    const payload = JSON.parse(JSON.stringify(this.editingStock));    const cleanProduct = (prod: any) => {      delete prod._originalAmount;      delete prod._originalInstock;      delete prod._originalIntransit;      delete prod._originalDelivered;    };    (payload.ewaybills || []).forEach((ewb: any) => {      (ewb.invoices || []).forEach((inv: any) => {        (inv.products || []).forEach((prod: any) => cleanProduct(prod));      });    });    (payload.invoices || []).forEach((inv: any) => {      (inv.products || []).forEach((prod: any) => cleanProduct(prod));    });    return payload;  }  onConsignorSelect(name: string) {    const selectedconignor = this.clientList.find(c => c.clientName === name);    if (selectedconignor) {      this.editingStock.consignorGST = selectedconignor.GSTIN;      this.editingStock.consignorAddress = selectedconignor.address;      this.editingStock.consignorPhone = selectedconignor.phoneNum;    }  }  onConsigneeSelect(name: string) {    const selectedconignee = this.clientList.find(c => c.clientName === name);    if (selectedconignee) {      this.editingStock.consigneeGST = selectedconignee.GSTIN;      this.editingStock.consigneeAddress = selectedconignee.address;      this.editingStock.consigneePhone = selectedconignee.phoneNum;    }  }  onConsignorGuestSelect(name: string) {    const selectedguestconignor = this.guestList.find(c => c.guestName === name);    if (selectedguestconignor) {      this.editingStock.consignorGST = 'GUEST';      this.editingStock.consignorAddress = selectedguestconignor.address;      this.editingStock.consignorPhone = selectedguestconignor.phoneNum;    }  }  onConsigneeGuestSelect(name: string) {    const selectedguestconignee = this.guestList.find(c => c.guestName === name);    if (selectedguestconignee) {      this.editingStock.consigneeGST = 'GUEST';      this.editingStock.consigneeAddress = selectedguestconignee.address;      this.editingStock.consigneePhone = selectedguestconignee.phoneNum;    }  }  onPackageList(name: string) {    const selectedpackage = this.pkgList.find(c => c.pkgName === name);  }  onProductList(name: string) {    const selectedproduct = this.productList.find(c => c.productName === name);  }addRoutePoint() {  if (!this.selectedRoutePoint) return;  const vehicleNo = this.selectedRouteVehicle || '';  this.shipmentRoute.push({    name: this.selectedRoutePoint.name,    type: this.selectedRoutePoint.type,    vehicleNo  });  this.selectedRoutePoint = null;  this.selectedRouteVehicle = '';}removeRoutePoint(index: number) {  this.shipmentRoute.splice(index, 1);}loadBranches() {  const email = localStorage.getItem('email');  this.http.get<any[]>(`http://localhost:3000/api/branches?email=${email}`)    .subscribe({      next: (data) => {        console.log(\"Branches loaded:\", data);        this.branches = data;        this.updateAvailableRoutePoints(); // G��n+� Refresh route options      },      error: (err) => console.error(\"Error loading branches:\", err)    });}loadHubs() {  const email = localStorage.getItem('email');  this.http.get<any[]>(`http://localhost:3000/api/hubs?email=${email}`)    .subscribe({      next: (data) => {        console.log(\"Hubs loaded:\", data);        this.hubs = data;        this.updateAvailableRoutePoints(); // G��n+� Refresh route options      },      error: (err) => console.error(\"Error loading hubs:\", err)    });}updateAvailableRoutePoints() {  const branchId = String(this.branchId || '').trim();  const branchName = String(this.branch || '').trim().toLowerCase();  const excludeSelected = branchName && branchName !== 'all branches';  this.availableRoutePoints = [    ...this.branches      .filter((b) => {        if (!excludeSelected) return true;        const idMatch = branchId && branchId !== 'all' &&          this.normalizeId(b?._id) === this.normalizeId(branchId);        const nameMatch = String(b?.branchName || '').trim().toLowerCase() === branchName;        return !(idMatch || nameMatch);      })      .map(b => ({        name: b.branchName,        type: \"Branch\" as const,        vehicles: (b.vehicles || []).map((v: any) => v.vehicleNo).filter(Boolean)      })),    ...this.hubs      .filter((h) => {        if (!excludeSelected) return true;        const idMatch = branchId && branchId !== 'all' &&          this.normalizeId(h?.branchId) === this.normalizeId(branchId);        if (idMatch) return false;        const hubBranch = (this.branches || []).find((b) =>          this.normalizeId(b?._id) === this.normalizeId(h?.branchId)        );        const nameMatch = hubBranch?.branchName &&          String(hubBranch.branchName).trim().toLowerCase() === branchName;        return !nameMatch;      })      .map(h => ({        name: h.hubName,        type: \"Hub\" as const,        vehicles: (h.deliveryAddresses || [])          .flatMap((addr: any) => (addr.vehicles || []).map((v: any) => v.vehicleNo))          .filter(Boolean)      }))  ];  console.log('[manifest] route points', {    branchId,    branchName: this.branch,    points: this.availableRoutePoints.map((p) => `${p.name} (${p.type})`)  });}onRoutePointChange() {  this.selectedRouteVehicle = this.selectedRoutePoint?.vehicles?.[0] || '';}private buildRouteString(): string {  if (!this.shipmentRoute.length) return '';  const hasBaskets = (this.routeBaskets || []).length > 0;  const prefix = hasBaskets    ? `$$${this.buildBasketDescriptor()}$$ `    : '$$All$$ ';  return prefix + this.shipmentRoute    .map(p => {      const vehicle = String(p.vehicleNo || '').trim();      return vehicle        ? `${p.name} (${p.type})|${vehicle}`        : `${p.name} (${p.type})`;    })    .join(' -> ');}private buildBasketDescriptor(): string {  return (this.routeBaskets || [])    .filter(b => b && String(b.labelKey || '').trim() && Number(b.qty) > 0)    .map(b => {      const key = String(b.labelKey || '').trim();      const parts = key.split('|');      const labelType = parts.shift() || '';      const labelValue = parts.join('|');      const label = labelValue ? `${labelType}:${labelValue}` : labelType;      return `${label}-${Number(b.qty)}`;    })    .join('|');}addRouteBasket() {  const options = this.getBasketOptions();  const firstKey = options.length ? options[0].key : '';  this.routeBaskets.push({ labelKey: firstKey, qty: 0 });}removeRouteBasket(index: number) {  if (index < 0 || index >= this.routeBaskets.length) return;  this.routeBaskets.splice(index, 1);}getBasketOptions(): Array<{ key: string; text: string }> {  const consignment = (this.selectedForManifestation || [])[0];  if (!consignment) return [];  const options: Array<{ key: string; text: string }> = [];  const consNum = consignment.consignmentNumber || '';  if (consNum) {    options.push({ key: `Consignment|${consNum}`, text: `Consignment: ${consNum}` });  }  const ewaybills = consignment.ewaybills || [];  if (ewaybills.length) {    ewaybills.forEach((ewb: any, eIdx: number) => {      const eNum = ewb.number || ewb.ewaybillNumber || `EWB-${eIdx + 1}`;      options.push({ key: `Ewaybill|${eNum}`, text: `Ewaybill: ${eNum}` });      (ewb.invoices || []).forEach((inv: any, iIdx: number) => {        const invNum = inv.number || inv.invoicenum || `INV-${iIdx + 1}`;        options.push({ key: `Invoice|${invNum}`, text: `Invoice: ${invNum}` });        (inv.products || []).forEach((prod: any, pIdx: number) => {          const pType = prod.type || prod.productName || `Product-${pIdx + 1}`;          options.push({            key: `Product|${invNum}:${pType}`,            text: `Product: ${invNum} - ${pType}`          });        });      });    });    return options;  }  (consignment.invoices || []).forEach((inv: any, iIdx: number) => {    const invNum = inv.number || inv.invoicenum || `INV-${iIdx + 1}`;    options.push({ key: `Invoice|${invNum}`, text: `Invoice: ${invNum}` });    (inv.products || []).forEach((prod: any, pIdx: number) => {      const pType = prod.type || prod.productName || `Product-${pIdx + 1}`;      options.push({        key: `Product|${invNum}:${pType}`,        text: `Product: ${invNum} - ${pType}`      });    });  });  return options;}  ngOnInit() {    this.activeTab = 'stocks';    this.email = localStorage.getItem('email') || '';    this.username = localStorage.getItem('username') || '';    this.branch = this.branchService.currentBranch || localStorage.getItem('branch') || 'All Branches';    this.branchId = localStorage.getItem('branchId') || 'all';    this.branchSub = this.branchService.branch$.subscribe(branch => {      this.branch = branch;      this.branchId = localStorage.getItem('branchId') || 'all';      this.updateAvailableRoutePoints();      this.loadStocks();    });    // react to branch changes (same tab)    this.branchCheck = setInterval(() => {      const current = localStorage.getItem('branch') || 'All Branches';      const currentId = localStorage.getItem('branchId') || 'all';      if (current !== this.branch || currentId !== this.branchId) {        this.branch = current;        this.branchId = currentId;        this.updateAvailableRoutePoints();        this.loadStocks();      }    }, 1000);    // react to branch changes (other tabs)    window.addEventListener('storage', this.onStorageChange);    // Clients list    this.http.get<any[]>(`http://localhost:3000/api/clients/clientslist?emailId=${this.email}`)    .subscribe({      next: data => this.clientList = data,      error: err => console.error('Error fetching client list', err),      complete: () => console.log('Client list fetch complete')    });    // Guests list    this.http.get<any[]>(`http://localhost:3000/api/guests/guestslist?emailId=${this.email}`)    .subscribe({      next: data => this.guestList = data,      error: err => console.error('Error fetching guest list', err),      complete: () => console.log('Guest list fetch complete')    });    // Packages list    this.http.get<any[]>(`http://localhost:3000/api/pkgs/pkglist?emailId=${this.email}`)    .subscribe({      next: data => this.pkgList = data,      error: err => console.error('Error fetching package list', err),      complete: () => console.log('Package list fetch complete')    });    // Products list    this.http.get<any[]>(`http://localhost:3000/api/products/productlist?branchId=${encodeURIComponent(this.branchId)}&branch=${encodeURIComponent(this.branch)}`)    .subscribe({      next: data => this.productList = data,      error: err => console.error('Error fetching product list', err),      complete: () => console.log('Product list fetch complete')    });    this.loadBranches();    this.loadHubs();  }  ngOnDestroy(): void {    this.branchSub?.unsubscribe();    if (this.branchCheck) clearInterval(this.branchCheck);    window.removeEventListener('storage', this.onStorageChange);  }  private onStorageChange = (e: StorageEvent) => {    if (e.key === 'branch' || e.key === 'branchId') {      const current = localStorage.getItem('branch') || 'All Branches';      const currentId = localStorage.getItem('branchId') || 'all';      if (current !== this.branch || currentId !== this.branchId) {        this.branch = current;        this.branchId = currentId;        this.loadStocks();      }    }  };  showManifestAdjustmentPopup = false;  pendingManifestAdjustment: any = null;  manifestAdjustments: any[] = [];  manifestAdjustmentLines: any[] = [];  manifestEditsById: Record<string, any> = {};  showManifestationPopup = false;  selectedForManifestation: any[] = [];  manifestationNumber: string = '';  getEwaybillNumberFromDB(consignmentNumber: string): string {  const record = this.stocks.find(    shipment => shipment.consignmentNumber === consignmentNumber  );  return record?.ewaybillNumber || '';}  openManifestationPopup() {  if (this.branchId === 'all' || !this.branchId) {    alert('Please select a specific branch before manifesting consignments.');    return;  }  // Filter selected consignments  this.selectedForManifestation = this.filteredStocks.filter(s => s.selected);  // Guard clause: ensure at least one consignment is selected  if (this.selectedForManifestation.length === 0) {    alert('G��n+� Please select at least one consignment to manifest.');    return;  }  this.routeBaskets = [];  // Initialize manifestQty and eway bill fields  this.selectedForManifestation = this.selectedForManifestation.map(consignment => {    // Set eway bill fields    const updatedConsignment = {      ...consignment,      ewayBillRequired: false,      ewaybillNumber: this.getEwaybillNumberFromDB(consignment.consignmentNumber)    };    // Set manifestQty = instock for each product    updatedConsignment.invoices?.forEach((invoice: any) => {      invoice.products?.forEach((product: any) => {        const amount = Number(product.amount) || 0;        const inTransit = Number(product.intransitstock) || 0;        const delivered = Number(product.deliveredstock) || 0;        const available = Math.max(0, amount - inTransit - delivered);        const currentInstock = Number(product.instock) || 0;        if (!currentInstock && available > 0) {          product.instock = available;        }        product.manifestQty = Number(product.instock) || available;        product.manifestQtyTouched = false;      });    });    return updatedConsignment;  });  // Show the popup  this.showManifestationPopup = true;}closeManifestationPopup() {  this.showManifestationPopup = false;}  finalizeManifestation() {    if (this.selectedForManifestation.length === 0) {      alert('No consignments selected.');      return;    }    const vehicleUpdates: Array<ReturnType<typeof this.http.patch>> = [];    const completionTargets = new Map<string, { vehicleNo: string; ownerType: 'Branch' | 'Hub'; ownerId: string; locationId: string }>();    const updates = (this.selectedForManifestation || []).map((consignment) => {      const updatedEwaybills = (consignment.ewaybills || []).map((ewb: any) => ({        ...ewb      }));      const status = String(consignment?.shipmentStatus || '').trim();      const isManifestation = status === 'Manifestation' || status === 'DManifestation';      const statusDetailsBranchId = this.getLastStatusDetailBranchId(consignment?.shipmentStatusDetails || '');      const routePoint = this.getLastRoutePoint(consignment);      const resolvedCurrentBranchId =        routePoint?.id ||        statusDetailsBranchId ||        consignment?.currentLocationId ||        consignment?.currentBranchId ||        consignment?.currentBranch;      const vehicleNo = String(        consignment?.currentVehicleNo ||        routePoint?.vehicleNo ||        ''      ).trim();        const payload = {          shipmentId: consignment?._id || '',          shipmentStatus: isManifestation ? 'DPending' : 'Delivered',          currentLocationId: resolvedCurrentBranchId,          currentVehicleNo: consignment?.currentVehicleNo || '',          currentVehicleOwnerType: consignment?.currentVehicleOwnerType || '',          currentVehicleOwnerId: consignment?.currentVehicleOwnerId || null,          clearAllVehicles: true,          ewaybills: updatedEwaybills        };      const shipmentId = consignment?._id ? encodeURIComponent(consignment._id) : '';      const shipmentParam = shipmentId ? `?shipmentId=${shipmentId}` : '';      console.log('[manifest:update] payload', {        consignmentNumber: consignment.consignmentNumber,        shipmentId: payload.shipmentId,        shipmentStatus: payload.shipmentStatus,        currentLocationId: payload.currentLocationId      });      if (isManifestation && routePoint?.vehicleNo && routePoint?.id) {        const endpoint = routePoint.type === 'Hub'          ? `http://localhost:3000/api/hubs/${routePoint.id}/vehicle-status`          : `http://localhost:3000/api/branches/${routePoint.id}/vehicle-status`;        vehicleUpdates.push(          this.http.patch(endpoint, {            vehicleNo: routePoint.vehicleNo,            vehicleStatus: 'online',            currentLocationId: routePoint.id          })        );      }      if (!isManifestation && vehicleNo && resolvedCurrentBranchId) {        const currentStatus = this.findVehicleStatus(vehicleNo);        if (currentStatus === 'scheduled' || currentStatus === 'delivering') {          const owner = this.resolveVehicleOwner(            vehicleNo,            consignment?.currentVehicleOwnerType,            consignment?.currentVehicleOwnerId          );          if (owner.ownerType && owner.ownerId) {            const key = `${owner.ownerType}:${owner.ownerId}:${vehicleNo}`;            completionTargets.set(key, {              vehicleNo,              ownerType: owner.ownerType as 'Branch' | 'Hub',              ownerId: owner.ownerId,              locationId: String(resolvedCurrentBranchId || '')            });          }        }      }      return this.http.put(        `http://localhost:3000/api/newshipments/${consignment.consignmentNumber}${shipmentParam}`,        payload    );  });  completionTargets.forEach((target) => {    const endpoint = target.ownerType === 'Hub'      ? `http://localhost:3000/api/hubs/${target.ownerId}/vehicle-status`      : `http://localhost:3000/api/branches/${target.ownerId}/vehicle-status`;    vehicleUpdates.push(      this.http.patch(endpoint, {        vehicleNo: target.vehicleNo,        vehicleStatus: 'online',        currentLocationId: target.locationId      })    );  });  const calls = [...updates, ...vehicleUpdates];  if (!calls.length) return;  forkJoin(calls).subscribe({    next: (responses: any[]) => {      console.log('[manifest:update] response', responses);      this.showManifestationPopup = false;      this.selectedForManifestation = [];      this.filteredStocks.forEach(s => s.selected = false);      this.loadStocks();    },    error: (err) => {      console.error('Error updating consignment status:', err);      alert('Failed to update consignment status.');    }  });}  private getLastRoutePoint(consignment: any): { id: string; name: string; type: 'Branch' | 'Hub'; vehicleNo?: string } | null {    const routes = (consignment?.ewaybills || [])      .map((ewb: any) => String(ewb?.routes || '').trim())      .filter((route: string) => route);    if (!routes.length) return null;    const lastRoute = routes[routes.length - 1].replace(/^\\$\\$.*?\\$\\$\\s*/, '');    const parts = lastRoute.split('->')      .map((part: string) => String(part || '').trim())      .filter(Boolean);    if (!parts.length) return null;    const last = parts[parts.length - 1];    const match = last.match(/^(.*?)\\s*\\((Branch|Hub)\\)\\s*(?:\\|\\s*(.+))?$/i);    if (!match) return null;    const name = String(match[1] || '').trim();    const type = (String(match[2] || '').trim() as 'Branch' | 'Hub');    const vehicleNo = String(match[3] || '').trim() || undefined;    let id = '';    if (type === 'Branch') {      const branch = (this.branches || []).find((b) =>        String(b?.branchName || '').trim().toLowerCase() === name.toLowerCase() ||        this.normalizeId(b?._id) === this.normalizeId(name)      );      id = branch?._id ? String(branch._id) : '';    } else {      const hub = (this.hubs || []).find((h) =>        String(h?.hubName || '').trim().toLowerCase() === name.toLowerCase() ||        this.normalizeId(h?._id) === this.normalizeId(name)      );      id = hub?._id ? String(hub._id) : '';    }    return { id, name, type, vehicleNo };  }validateManifestQty(product: any) {  product.manifestQtyTouched = true;  if (product.manifestQty > product.instock) {    alert(`G��n+� Manifest quantity cannot exceed available stock (${product.instock}).`);    product.manifestQty = product.instock;  }  if (product.manifestQty < 0) {    alert('G��n+� Manifest quantity cannot be negative.');    product.manifestQty = 0;  }}printReceipts() {  const selected = this.filteredStocks?.filter(s => s.selected) || [];  if (selected.length === 0) {    alert('No consignments selected.');    return;  }  fetch('assets/receipt-template.html')    .then(res => res.text())    .then(template => {      let fullHtml = `        <html>          <head>            <style>              body { font-family: Arial, sans-serif; padding: 20px; }              h2 { margin-bottom: 0; }              table { width: 100%; border-collapse: collapse; margin-top: 10px; }              th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }              th { background-color: #f2f2f2; }              .page-break { page-break-after: always; }            </style>          </head>          <body>      `;      selected.forEach((consignment, index) => {        const rows = consignment.invoices.flatMap((inv: any) =>          inv.products.map((p: any) => `            <tr>              <td>${inv.number}</td>              <td>${p.type}</td>              <td>${p.instock}</td>              <td>${p.manifestQty}</td>              <td>${p.amount}</td>            </tr>          `)        ).join('');        const htmlContent = template          .replace('{{consignmentNumber}}', consignment.consignmentNumber)          .replace('{{consignor}}', consignment.consignor)          .replace('{{rows}}', rows);        fullHtml += htmlContent;        // Add page break after each consignment except the last one        if (index < selected.length - 1) {          fullHtml += `<div class=\"page-break\"></div>`;        }      });      fullHtml += `</body></html>`;      const printWindow = window.open('', '_blank');      if (printWindow) {        printWindow.document.open();        printWindow.document.write(fullHtml);  // use write instead of body.innerHTML        printWindow.document.close();        printWindow.print();      }    });}}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}