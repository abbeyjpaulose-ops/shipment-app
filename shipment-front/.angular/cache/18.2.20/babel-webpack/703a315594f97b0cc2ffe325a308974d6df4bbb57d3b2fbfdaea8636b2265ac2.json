{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nlet ManifestComponent = class ManifestComponent {\n  constructor(http) {\n    this.http = http;\n    this.manifest = [];\n    this.filteredManifest = [];\n    this.searchText = '';\n    this.filterDate = '';\n    this.filterConsignor = '';\n    this.selectedManifest = null;\n    this.editingManifest = null; // ✅ track which manifest is being edited\n  }\n  ngOnInit() {\n    this.loadManifest();\n  }\n  loadManifest() {\n    const email = localStorage.getItem('email');\n    this.http.get(`http://localhost:3000/api/manifest?email=${email}`).subscribe({\n      next: res => {\n        // filter only In Tansit shipments\n        this.manifest = res.filter(s => s.shipmentStatus === 'In Transit');\n        console.log(this.manifest);\n        this.filteredManifest = [...this.manifest];\n      },\n      error: err => console.error('❌ Error loading manifest:', err)\n    });\n  }\n  applyFilters() {\n    this.filteredManifest = this.manifest.filter(s => (this.searchText ? s.consignmentNumber?.includes(this.searchText) || s.consignor?.includes(this.searchText) : true) && (this.filterDate ? new Date(s.date).toISOString().split('T')[0] === this.filterDate : true) && (this.filterConsignor ? s.consignor?.toLowerCase().includes(this.filterConsignor.toLowerCase()) : true));\n  }\n  toggleAllSelection(event) {\n    const checked = event.target.checked;\n    this.filteredManifest.forEach(s => s.selected = checked);\n  }\n  manifestSelected() {\n    const selectedConsignments = this.filteredManifest.filter(s => s.selected);\n    if (selectedConsignments.length === 0) {\n      console.warn('⚠️ No consignments selected for manifestation.');\n      return;\n    }\n    selectedConsignments.forEach(manifest => {\n      const updatedManifest = {\n        ...manifest,\n        shipmentStatus: 'Delivered'\n      };\n      console.log(\"sqsqsqsqsqsqsqsqsqs\" + manifest.shipmentStatus);\n      this.http.put(`http://localhost:3000/api/manifest/${manifest.consignmentNumber}`, updatedManifest).subscribe({\n        next: () => {\n          console.log(`✅ Consignment ${manifest.consignmentNumber} updated to Delivered`);\n          this.loadManifest(); // Refresh data\n        },\n        error: err => {\n          console.error(`❌ Error updating consignment ${manifest.consignmentNumber}:`, err);\n        }\n      });\n    });\n    // Optionally clear selection after update\n    this.filteredManifest.forEach(s => s.selected = false);\n  }\n  openManifestDetails(manifest) {\n    this.selectedManifest = manifest;\n  }\n  closeManifestDetails() {\n    this.selectedManifest = null;\n  }\n  editManifest(manifest) {\n    console.log('✏️ Edit manifest:', manifest);\n    this.editingManifest = {\n      ...manifest\n    }; // ✅ copy so we don’t mutate directly\n  }\n  saveManifestEdit() {\n    if (!this.editingManifest) return;\n    console.log(\"kkkkkkkkkkklllllllllllllllll\" + this.editingManifest.consignmentNumber);\n    this.http.put(`http://localhost:3000/api/newshipments/${this.editingManifest.consignmentNumber}`, this.editingManifest).subscribe({\n      next: () => {\n        console.log('✅ Manifest updated');\n        this.loadManifest(); // reload updated data\n        this.editingManifest = null; // close modal\n      },\n      error: err => console.error('❌ Error updating manifest:', err)\n    });\n  }\n  cancelEdit() {\n    this.editingManifest = null;\n  }\n};\nManifestComponent = __decorate([Component({\n  selector: 'app-manifest',\n  standalone: true,\n  imports: [CommonModule, FormsModule],\n  templateUrl: './manifest.component.html',\n  styleUrls: ['./manifest.component.css']\n})], ManifestComponent);\nexport { ManifestComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}