{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nlet ManifestationComponent = class ManifestationComponent {\n  constructor(http) {\n    this.http = http;\n    this.consignments = [];\n    this.filteredConsignments = [];\n    this.searchText = '';\n    this.filterDate = '';\n    this.filterConsignor = '';\n    this.selectedConsignment = null;\n    this.editingConsignment = null; // ✅ track which consignment is being edited\n  }\n  ngOnInit() {\n    this.loadConsignments();\n  }\n  loadConsignments() {\n    const email = localStorage.getItem('email');\n    this.http.get(`http://localhost:3000/api/newshipments?email=${email}`).subscribe({\n      next: res => {\n        // filter only IN TRANSIT consignments\n        this.consignments = res.filter(c => c.shipmentStatus === 'In Transit');\n        console.log(this.consignments);\n        this.filteredConsignments = [...this.consignments];\n      },\n      error: err => console.error('❌ Error loading consignments:', err)\n    });\n  }\n  applyFilters() {\n    this.filteredConsignments = this.consignments.filter(c => (this.searchText ? c.consignmentNumber?.includes(this.searchText) || c.consignor?.includes(this.searchText) : true) && (this.filterDate ? new Date(c.date).toISOString().split('T')[0] === this.filterDate : true) && (this.filterConsignor ? c.consignor?.toLowerCase().includes(this.filterConsignor.toLowerCase()) : true));\n  }\n  toggleAllSelection(event) {\n    const checked = event.target.checked;\n    this.filteredConsignments.forEach(c => c.selected = checked);\n  }\n  markDelivered() {\n    const selectedConsignments = this.filteredConsignments.filter(c => c.selected);\n    if (selectedConsignments.length === 0) {\n      console.warn('⚠️ No consignments selected for delivery.');\n      return;\n    }\n    selectedConsignments.forEach(consignment => {\n      const updatedConsignment = {\n        ...consignment,\n        shipmentStatus: 'Delivered'\n      };\n      this.http.put(`http://localhost:3000/api/newshipments/${consignment.consignmentNumber}`, updatedConsignment).subscribe({\n        next: () => {\n          console.log(`✅ Consignment ${consignment.consignmentNumber} marked as Delivered`);\n          this.loadConsignments(); // Refresh data\n        },\n        error: err => {\n          console.error(`❌ Error updating consignment ${consignment.consignmentNumber}:`, err);\n        }\n      });\n    });\n    // Optionally clear selection after update\n    this.filteredConsignments.forEach(c => c.selected = false);\n  }\n  openConsignmentDetails(consignment) {\n    this.selectedConsignment = consignment;\n  }\n  closeConsignmentDetails() {\n    this.selectedConsignment = null;\n  }\n  editConsignment(consignment) {\n    console.log('✏️ Edit consignment:', consignment);\n    this.editingConsignment = {\n      ...consignment\n    }; // ✅ copy so we don’t mutate directly\n  }\n  saveConsignmentEdit() {\n    if (!this.editingConsignment) return;\n    this.http.put(`http://localhost:3000/api/newshipments/${this.editingConsignment.consignmentNumber}`, this.editingConsignment).subscribe({\n      next: () => {\n        console.log('✅ Consignment updated');\n        this.loadConsignments(); // reload updated data\n        this.editingConsignment = null; // close modal\n      },\n      error: err => console.error('❌ Error updating consignment:', err)\n    });\n  }\n  cancelEdit() {\n    this.editingConsignment = null;\n  }\n};\nManifestationComponent = __decorate([Component({\n  selector: 'app-manifestation',\n  standalone: true,\n  imports: [CommonModule, FormsModule],\n  templateUrl: './manifestation.component.html',\n  styleUrls: ['./manifestation.component.css']\n})], ManifestationComponent);\nexport { ManifestationComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}