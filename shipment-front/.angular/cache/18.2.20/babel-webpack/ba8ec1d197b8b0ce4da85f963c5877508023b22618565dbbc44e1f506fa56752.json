{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nlet StocksComponent = class StocksComponent {\n  constructor(http) {\n    this.http = http;\n    this.stocks = [];\n    this.filteredStocks = [];\n    this.searchText = '';\n    this.filterDate = '';\n    this.filterConsignor = '';\n    this.selectedStock = null;\n    this.editingStock = null; // ✅ track which stock is being edited\n  }\n  ngOnInit() {\n    this.loadStocks();\n  }\n  loadStocks() {\n    const email = localStorage.getItem('email');\n    this.http.get(`http://localhost:3000/api/newshipments?email=${email}`).subscribe({\n      next: res => {\n        // filter only INSTOCK shipments\n        this.stocks = res.filter(s => s.shipmentStatus === 'Pending');\n        console.log(this.stocks);\n        this.filteredStocks = [...this.stocks];\n      },\n      error: err => console.error('❌ Error loading stocks:', err)\n    });\n  }\n  applyFilters() {\n    this.filteredStocks = this.stocks.filter(s => (this.searchText ? s.consignmentNumber?.includes(this.searchText) || s.consignor?.includes(this.searchText) : true) && (this.filterDate ? new Date(s.date).toISOString().split('T')[0] === this.filterDate : true) && (this.filterConsignor ? s.consignor?.toLowerCase().includes(this.filterConsignor.toLowerCase()) : true));\n  }\n  toggleAllSelection(event) {\n    const checked = event.target.checked;\n    this.filteredStocks.forEach(s => s.selected = checked);\n  }\n  manifestSelected() {\n    const selectedConsignments = this.filteredStocks.filter(s => s.selected);\n    if (selectedConsignments.length === 0) {\n      console.warn('⚠️ No consignments selected for manifestation.');\n      return;\n    }\n    selectedConsignments.forEach(stock => {\n      const updatedStock = {\n        ...stock,\n        shipmentStatus: 'In Transit'\n      };\n      console.log(\"sqsqsqsqsqsqsqsqsqs\" + stock.shipmentStatus);\n      this.http.put(`http://localhost:3000/api/newshipments/${stock.consignmentNumber}`, updatedStock).subscribe({\n        next: () => {\n          console.log(`✅ Consignment ${stock.consignmentNumber} updated to In Transit`);\n          this.loadStocks(); // Refresh data\n        },\n        error: err => {\n          console.error(`❌ Error updating consignment ${stock.consignmentNumber}:`, err);\n        }\n      });\n    });\n    // Optionally clear selection after update\n    this.filteredStocks.forEach(s => s.selected = false);\n  }\n  openStockDetails(stock) {\n    this.selectedStock = stock;\n  }\n  closeStockDetails() {\n    this.selectedStock = null;\n  }\n  editStock(stock) {\n    console.log('✏️ Edit stock:', stock);\n    this.editingStock = {\n      ...stock\n    }; // ✅ copy so we don’t mutate directly\n  }\n  saveStockEdit() {\n    if (!this.editingStock) return;\n    console.log(\"kkkkkkkkkkklllllllllllllllll\" + this.editingStock.consignmentNumber);\n    this.http.put(`http://localhost:3000/api/newshipments/${this.editingStock.consignmentNumber}`, this.editingStock).subscribe({\n      next: () => {\n        console.log('✅ Stock updated');\n        this.loadStocks(); // reload updated data\n        this.editingStock = null; // close modal\n      },\n      error: err => console.error('❌ Error updating stock:', err)\n    });\n  }\n  cancelEdit() {\n    this.editingStock = null;\n  }\n};\nStocksComponent = __decorate([Component({\n  selector: 'app-stocks',\n  standalone: true,\n  imports: [CommonModule, FormsModule],\n  templateUrl: './stocks.component.html',\n  styleUrls: ['./stocks.component.css']\n})], StocksComponent);\nexport { StocksComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}