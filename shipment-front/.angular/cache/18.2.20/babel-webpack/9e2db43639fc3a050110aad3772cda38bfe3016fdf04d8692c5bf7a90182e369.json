{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { RouterModule } from '@angular/router';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nfunction BranchVehiclesComponent_tr_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const v_r1 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(v_r1.branchName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(v_r1.vehicleNo);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(v_r1.driverPhone);\n  }\n}\nfunction BranchVehiclesComponent_tr_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 5);\n    i0.ɵɵtext(2, \"No vehicles found.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport let BranchVehiclesComponent = /*#__PURE__*/(() => {\n  class BranchVehiclesComponent {\n    constructor(http) {\n      this.http = http;\n      this.branches = [];\n      this.vehicles = [];\n      this.branchId = localStorage.getItem('branchId') || 'all';\n      this.branchName = localStorage.getItem('branch') || 'All Branches';\n      this.onStorage = e => {\n        if (e.key === 'branch' || e.key === 'branchId') {\n          this.branchName = localStorage.getItem('branch') || 'All Branches';\n          this.branchId = localStorage.getItem('branchId') || 'all';\n          this.buildVehicles();\n        }\n      };\n    }\n    ngOnInit() {\n      this.loadBranches();\n      this.branchCheck = setInterval(() => {\n        const current = localStorage.getItem('branch') || 'All Branches';\n        const currentId = localStorage.getItem('branchId') || 'all';\n        if (current !== this.branchName || currentId !== this.branchId) {\n          this.branchName = current;\n          this.branchId = currentId;\n          this.buildVehicles();\n        }\n      }, 1000);\n      window.addEventListener('storage', this.onStorage);\n    }\n    ngOnDestroy() {\n      if (this.branchCheck) clearInterval(this.branchCheck);\n      window.removeEventListener('storage', this.onStorage);\n    }\n    loadBranches() {\n      this.http.get('http://localhost:3000/api/branches').subscribe({\n        next: data => {\n          this.branches = data || [];\n          this.buildVehicles();\n        },\n        error: err => console.error('Error loading branches:', err)\n      });\n    }\n    buildVehicles() {\n      const branchId = this.branchId || 'all';\n      const branchName = String(this.branchName || '').trim().toLowerCase();\n      const filtered = branchId === 'all' ? this.branches : this.branches.filter(b => {\n        const idMatch = String(b?._id || '') === String(branchId || '');\n        const nameMatch = String(b?.branchName || '').trim().toLowerCase() === branchName;\n        return idMatch || nameMatch;\n      });\n      const rows = [];\n      (filtered || []).forEach(b => {\n        const list = Array.isArray(b?.vehicles) ? b.vehicles : [];\n        list.forEach(v => {\n          const vehicleNo = String(v?.vehicleNo || '').trim();\n          const driverPhone = String(v?.driverPhone || '').trim();\n          if (!vehicleNo && !driverPhone) return;\n          rows.push({\n            branchName: b?.branchName || '',\n            vehicleNo,\n            driverPhone\n          });\n        });\n      });\n      this.vehicles = rows;\n    }\n    static {\n      this.ɵfac = function BranchVehiclesComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || BranchVehiclesComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: BranchVehiclesComponent,\n        selectors: [[\"app-branch-vehicles\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 16,\n        vars: 3,\n        consts: [[1, \"branch-vehicles-container\"], [1, \"branch-subtitle\"], [1, \"vehicles-table-wrapper\"], [4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [\"colspan\", \"3\"]],\n        template: function BranchVehiclesComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n            i0.ɵɵtext(2, \"Branch Vehicles\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(3, \"p\", 1);\n            i0.ɵɵtext(4);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(5, \"div\", 2)(6, \"table\")(7, \"tr\")(8, \"th\");\n            i0.ɵɵtext(9, \"Branch\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(10, \"th\");\n            i0.ɵɵtext(11, \"Vehicle No.\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(12, \"th\");\n            i0.ɵɵtext(13, \"Driver Phone\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(14, BranchVehiclesComponent_tr_14_Template, 7, 3, \"tr\", 3)(15, BranchVehiclesComponent_tr_15_Template, 3, 0, \"tr\", 4);\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(4);\n            i0.ɵɵtextInterpolate(ctx.branchId === \"all\" ? \"All Branches\" : ctx.branchName);\n            i0.ɵɵadvance(10);\n            i0.ɵɵproperty(\"ngForOf\", ctx.vehicles);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.vehicles.length === 0);\n          }\n        },\n        dependencies: [CommonModule, i2.NgForOf, i2.NgIf, RouterModule],\n        styles: [\".branch-vehicles-container[_ngcontent-%COMP%]{padding:20px}.branch-subtitle[_ngcontent-%COMP%]{color:#6b7280;margin-top:4px}.vehicles-table-wrapper[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:12px}.vehicles-table-wrapper[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .vehicles-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #e5e7eb;padding:8px;text-align:left}.vehicles-table-wrapper[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f8fafc}\"]\n      });\n    }\n  }\n  return BranchVehiclesComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}