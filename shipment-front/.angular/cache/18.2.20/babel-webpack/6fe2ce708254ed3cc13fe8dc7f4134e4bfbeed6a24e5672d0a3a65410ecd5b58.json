{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction ViewShipmentsComponent_tr_36_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ÉµÉµgetCurrentView();\n    i0.ÉµÉµelementStart(0, \"tr\", 13);\n    i0.ÉµÉµlistener(\"click\", function ViewShipmentsComponent_tr_36_Template_tr_click_0_listener() {\n      const s_r2 = i0.ÉµÉµrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ÉµÉµnextContext();\n      return i0.ÉµÉµresetView(ctx_r2.openShipmentDetails(s_r2));\n    });\n    i0.ÉµÉµelementStart(1, \"td\");\n    i0.ÉµÉµtext(2);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(3, \"td\");\n    i0.ÉµÉµtext(4);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(5, \"td\");\n    i0.ÉµÉµtext(6);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(7, \"td\");\n    i0.ÉµÉµtext(8);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(9, \"td\");\n    i0.ÉµÉµtext(10);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(11, \"td\");\n    i0.ÉµÉµtext(12);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(13, \"td\");\n    i0.ÉµÉµtext(14);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(15, \"td\");\n    i0.ÉµÉµtext(16);\n    i0.ÉµÉµelementEnd()();\n  }\n  if (rf & 2) {\n    const s_r2 = ctx.$implicit;\n    const ctx_r2 = i0.ÉµÉµnextContext();\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtextInterpolate(s_r2.consignmentNumber);\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtextInterpolate(s_r2.shipmentStatus);\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtextInterpolate(s_r2.consignor);\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtextInterpolate(s_r2.deliveryAddress);\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtextInterpolate(ctx_r2.getProductTotal(s_r2.invoices, \"instock\"));\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtextInterpolate(ctx_r2.getProductTotal(s_r2.invoices, \"intransitstock\"));\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtextInterpolate(ctx_r2.getProductTotal(s_r2.invoices, \"deliveredstock\"));\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtextInterpolate(ctx_r2.getProductTotal(s_r2.invoices, \"amount\"));\n  }\n}\nfunction ViewShipmentsComponent_div_37_li_43_li_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"li\");\n    i0.ÉµÉµtext(1);\n    i0.ÉµÉµelementEnd();\n  }\n  if (rf & 2) {\n    const product_r5 = ctx.$implicit;\n    i0.ÉµÉµadvance();\n    i0.ÉµÉµtextInterpolate3(\" \", product_r5.type, \" (In Stock Qty: \", product_r5.instock, \") (Total Qty: \", product_r5.amount, \") \");\n  }\n}\nfunction ViewShipmentsComponent_div_37_li_43_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"li\");\n    i0.ÉµÉµtext(1);\n    i0.ÉµÉµelementStart(2, \"ul\");\n    i0.ÉµÉµtemplate(3, ViewShipmentsComponent_div_37_li_43_li_3_Template, 2, 3, \"li\", 18);\n    i0.ÉµÉµelementEnd()();\n  }\n  if (rf & 2) {\n    const invoice_r6 = ctx.$implicit;\n    i0.ÉµÉµadvance();\n    i0.ÉµÉµtextInterpolate1(\" \", invoice_r6.number, \": \");\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµproperty(\"ngForOf\", invoice_r6.products);\n  }\n}\nfunction ViewShipmentsComponent_div_37_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ÉµÉµgetCurrentView();\n    i0.ÉµÉµelementStart(0, \"div\", 14)(1, \"div\", 15)(2, \"span\", 16);\n    i0.ÉµÉµlistener(\"click\", function ViewShipmentsComponent_div_37_Template_span_click_2_listener() {\n      i0.ÉµÉµrestoreView(_r4);\n      const ctx_r2 = i0.ÉµÉµnextContext();\n      return i0.ÉµÉµresetView(ctx_r2.closeShipmentDetails());\n    });\n    i0.ÉµÉµtext(3, \"\\u00D7\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(4, \"h2\");\n    i0.ÉµÉµtext(5, \"Shipment Details\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(6, \"div\", 17)(7, \"p\")(8, \"strong\");\n    i0.ÉµÉµtext(9, \"Consignment No.:\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtext(10);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(11, \"p\")(12, \"strong\");\n    i0.ÉµÉµtext(13, \"Status:\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtext(14);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(15, \"p\")(16, \"strong\");\n    i0.ÉµÉµtext(17, \"Consignor:\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtext(18);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(19, \"p\")(20, \"strong\");\n    i0.ÉµÉµtext(21, \"Consignee:\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtext(22);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(23, \"p\")(24, \"strong\");\n    i0.ÉµÉµtext(25, \"Delivery Address:\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtext(26);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(27, \"p\")(28, \"strong\");\n    i0.ÉµÉµtext(29, \"Date:\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtext(30);\n    i0.ÉµÉµpipe(31, \"date\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(32, \"p\")(33, \"strong\");\n    i0.ÉµÉµtext(34, \"Products in stock:\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtext(35);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(36, \"p\")(37, \"strong\");\n    i0.ÉµÉµtext(38, \"No. of Products:\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtext(39);\n    i0.ÉµÉµelementEnd()();\n    i0.ÉµÉµelementStart(40, \"h3\");\n    i0.ÉµÉµtext(41, \"Products\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(42, \"ul\");\n    i0.ÉµÉµtemplate(43, ViewShipmentsComponent_div_37_li_43_Template, 4, 2, \"li\", 18);\n    i0.ÉµÉµelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ÉµÉµnextContext();\n    i0.ÉµÉµadvance(10);\n    i0.ÉµÉµtextInterpolate1(\" \", ctx_r2.selectedShipment.consignmentNumber, \"\");\n    i0.ÉµÉµadvance(4);\n    i0.ÉµÉµtextInterpolate1(\" \", ctx_r2.selectedShipment.shipmentStatus, \"\");\n    i0.ÉµÉµadvance(4);\n    i0.ÉµÉµtextInterpolate1(\" \", ctx_r2.selectedShipment.consignor, \"\");\n    i0.ÉµÉµadvance(4);\n    i0.ÉµÉµtextInterpolate1(\" \", ctx_r2.selectedShipment.consignee, \"\");\n    i0.ÉµÉµadvance(4);\n    i0.ÉµÉµtextInterpolate1(\" \", ctx_r2.selectedShipment.deliveryAddress, \"\");\n    i0.ÉµÉµadvance(4);\n    i0.ÉµÉµtextInterpolate1(\" \", i0.ÉµÉµpipeBind2(31, 9, ctx_r2.selectedShipment.date, \"short\"), \"\");\n    i0.ÉµÉµadvance(5);\n    i0.ÉµÉµtextInterpolate1(\" \", ctx_r2.getInStockAmountTotal(ctx_r2.selectedShipment.invoices), \"\");\n    i0.ÉµÉµadvance(4);\n    i0.ÉµÉµtextInterpolate1(\" \", ctx_r2.getInvoiceAmountTotal(ctx_r2.selectedShipment.invoices), \"\");\n    i0.ÉµÉµadvance(4);\n    i0.ÉµÉµproperty(\"ngForOf\", ctx_r2.selectedShipment.invoices);\n  }\n}\nexport let ViewShipmentsComponent = /*#__PURE__*/(() => {\n  class ViewShipmentsComponent {\n    constructor(http) {\n      this.http = http;\n      this.shipments = [];\n      this.filteredShipments = [];\n      this.searchText = '';\n      this.filterDate = '';\n      this.filterStatus = '';\n      this.filterConsignor = '';\n      this.selectedShipment = null; // âœ… for modal popup\n    }\n    ngOnInit() {\n      this.loadShipments();\n    }\n    loadShipments() {\n      this.http.get('http://localhost:3000/api/newshipments', {\n        params: {\n          email: localStorage.getItem('email') || '',\n          branch: localStorage.getItem('branch') || ''\n        }\n      }).subscribe({\n        next: res => {\n          this.shipments = res;\n          this.filteredShipments = res;\n          console.log('ðŸ“¦ SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSShipments loaded:', res);\n        },\n        error: err => console.error('âŒ Error loading shipments:', err)\n      });\n    }\n    getProductTotal(invoices, key) {\n      if (!invoices) return 0;\n      return invoices.reduce((total, invoice) => {\n        const productSum = invoice.products?.reduce((sum, prod) => sum + (prod[key] || 0), 0) || 0;\n        return total + productSum;\n      }, 0);\n    }\n    applyFilters() {\n      this.filteredShipments = this.shipments.filter(s => {\n        const matchesSearch = this.searchText ? s.consignmentNumber?.toLowerCase().includes(this.searchText.toLowerCase()) || s.consignor?.toLowerCase().includes(this.searchText.toLowerCase()) : true;\n        const matchesDate = this.filterDate ? new Date(s.date).toDateString() === new Date(this.filterDate).toDateString() : true;\n        const matchesStatus = this.filterStatus ? s.shipmentStatus === this.filterStatus : true;\n        const matchesConsignor = this.filterConsignor ? s.consignor?.toLowerCase().includes(this.filterConsignor.toLowerCase()) : true;\n        return matchesSearch && matchesDate && matchesStatus && matchesConsignor;\n      });\n    }\n    // âœ… open details modal\n    openShipmentDetails(shipment) {\n      this.selectedShipment = shipment;\n    }\n    // âœ… close details modal\n    closeShipmentDetails() {\n      this.selectedShipment = null;\n    }\n    static {\n      this.Éµfac = function ViewShipmentsComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || ViewShipmentsComponent)(i0.ÉµÉµdirectiveInject(i1.HttpClient));\n      };\n    }\n    static {\n      this.Éµcmp = /*@__PURE__*/i0.ÉµÉµdefineComponent({\n        type: ViewShipmentsComponent,\n        selectors: [[\"app-view-shipments\"]],\n        standalone: true,\n        features: [i0.ÉµÉµStandaloneFeature],\n        decls: 38,\n        vars: 6,\n        consts: [[1, \"shipments-container\"], [1, \"filters\"], [\"type\", \"text\", \"placeholder\", \"Search by consignment no. or consignor\", 3, \"ngModelChange\", \"input\", \"ngModel\"], [\"type\", \"date\", 3, \"ngModelChange\", \"change\", \"ngModel\"], [3, \"ngModelChange\", \"change\", \"ngModel\"], [\"value\", \"\"], [\"value\", \"Pending\"], [\"value\", \"In Transit\"], [\"value\", \"Delivered\"], [\"type\", \"text\", \"placeholder\", \"Filter by consignor\", 3, \"ngModelChange\", \"input\", \"ngModel\"], [1, \"shipments-table\"], [3, \"click\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"modal\", 4, \"ngIf\"], [3, \"click\"], [1, \"modal\"], [1, \"modal-content\"], [1, \"close\", 3, \"click\"], [1, \"shipment-details\"], [4, \"ngFor\", \"ngForOf\"]],\n        template: function ViewShipmentsComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ÉµÉµelementStart(0, \"div\", 0)(1, \"h2\");\n            i0.ÉµÉµtext(2, \"View Shipments\");\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(3, \"div\", 1)(4, \"input\", 2);\n            i0.ÉµÉµtwoWayListener(\"ngModelChange\", function ViewShipmentsComponent_Template_input_ngModelChange_4_listener($event) {\n              i0.ÉµÉµtwoWayBindingSet(ctx.searchText, $event) || (ctx.searchText = $event);\n              return $event;\n            });\n            i0.ÉµÉµlistener(\"input\", function ViewShipmentsComponent_Template_input_input_4_listener() {\n              return ctx.applyFilters();\n            });\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(5, \"input\", 3);\n            i0.ÉµÉµtwoWayListener(\"ngModelChange\", function ViewShipmentsComponent_Template_input_ngModelChange_5_listener($event) {\n              i0.ÉµÉµtwoWayBindingSet(ctx.filterDate, $event) || (ctx.filterDate = $event);\n              return $event;\n            });\n            i0.ÉµÉµlistener(\"change\", function ViewShipmentsComponent_Template_input_change_5_listener() {\n              return ctx.applyFilters();\n            });\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(6, \"select\", 4);\n            i0.ÉµÉµtwoWayListener(\"ngModelChange\", function ViewShipmentsComponent_Template_select_ngModelChange_6_listener($event) {\n              i0.ÉµÉµtwoWayBindingSet(ctx.filterStatus, $event) || (ctx.filterStatus = $event);\n              return $event;\n            });\n            i0.ÉµÉµlistener(\"change\", function ViewShipmentsComponent_Template_select_change_6_listener() {\n              return ctx.applyFilters();\n            });\n            i0.ÉµÉµelementStart(7, \"option\", 5);\n            i0.ÉµÉµtext(8, \"All Status\");\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(9, \"option\", 6);\n            i0.ÉµÉµtext(10, \"Pending\");\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(11, \"option\", 7);\n            i0.ÉµÉµtext(12, \"In Transit\");\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(13, \"option\", 8);\n            i0.ÉµÉµtext(14, \"Delivered\");\n            i0.ÉµÉµelementEnd()();\n            i0.ÉµÉµelementStart(15, \"input\", 9);\n            i0.ÉµÉµtwoWayListener(\"ngModelChange\", function ViewShipmentsComponent_Template_input_ngModelChange_15_listener($event) {\n              i0.ÉµÉµtwoWayBindingSet(ctx.filterConsignor, $event) || (ctx.filterConsignor = $event);\n              return $event;\n            });\n            i0.ÉµÉµlistener(\"input\", function ViewShipmentsComponent_Template_input_input_15_listener() {\n              return ctx.applyFilters();\n            });\n            i0.ÉµÉµelementEnd()();\n            i0.ÉµÉµelementStart(16, \"table\", 10)(17, \"thead\")(18, \"tr\")(19, \"th\");\n            i0.ÉµÉµtext(20, \"Consignment No.\");\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(21, \"th\");\n            i0.ÉµÉµtext(22, \"Status\");\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(23, \"th\");\n            i0.ÉµÉµtext(24, \"Consignor\");\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(25, \"th\");\n            i0.ÉµÉµtext(26, \"Delivery Address\");\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(27, \"th\");\n            i0.ÉµÉµtext(28, \"Products in stock\");\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(29, \"th\");\n            i0.ÉµÉµtext(30, \"Products in Transit\");\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(31, \"th\");\n            i0.ÉµÉµtext(32, \"Products Delivered\");\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(33, \"th\");\n            i0.ÉµÉµtext(34, \"No. of Products\");\n            i0.ÉµÉµelementEnd()()();\n            i0.ÉµÉµelementStart(35, \"tbody\");\n            i0.ÉµÉµtemplate(36, ViewShipmentsComponent_tr_36_Template, 17, 8, \"tr\", 11);\n            i0.ÉµÉµelementEnd()()();\n            i0.ÉµÉµtemplate(37, ViewShipmentsComponent_div_37_Template, 44, 12, \"div\", 12);\n          }\n          if (rf & 2) {\n            i0.ÉµÉµadvance(4);\n            i0.ÉµÉµtwoWayProperty(\"ngModel\", ctx.searchText);\n            i0.ÉµÉµadvance();\n            i0.ÉµÉµtwoWayProperty(\"ngModel\", ctx.filterDate);\n            i0.ÉµÉµadvance();\n            i0.ÉµÉµtwoWayProperty(\"ngModel\", ctx.filterStatus);\n            i0.ÉµÉµadvance(9);\n            i0.ÉµÉµtwoWayProperty(\"ngModel\", ctx.filterConsignor);\n            i0.ÉµÉµadvance(21);\n            i0.ÉµÉµproperty(\"ngForOf\", ctx.filteredShipments);\n            i0.ÉµÉµadvance();\n            i0.ÉµÉµproperty(\"ngIf\", ctx.selectedShipment);\n          }\n        },\n        dependencies: [CommonModule, i2.NgForOf, i2.NgIf, i2.DatePipe, FormsModule, i3.NgSelectOption, i3.ÉµNgSelectMultipleOption, i3.DefaultValueAccessor, i3.SelectControlValueAccessor, i3.NgControlStatus, i3.NgModel],\n        styles: [\".shipments-container[_ngcontent-%COMP%]{padding:20px}.filters[_ngcontent-%COMP%]{display:flex;gap:10px;margin-bottom:15px}.shipments-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.shipments-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .shipments-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ccc;padding:8px;text-align:left}.shipments-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f1f1;cursor:pointer}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0009;display:flex;align-items:center;justify-content:center}.modal-content[_ngcontent-%COMP%]{background:#fff;padding:20px;width:500px;max-height:80vh;overflow-y:auto;border-radius:8px;position:relative}.close[_ngcontent-%COMP%]{position:absolute;right:15px;top:10px;font-size:24px;cursor:pointer}\"]\n      });\n    }\n  }\n  return ViewShipmentsComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}