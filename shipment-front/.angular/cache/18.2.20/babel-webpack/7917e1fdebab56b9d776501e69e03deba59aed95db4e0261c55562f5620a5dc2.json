{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction StocksComponent_tr_26_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.…µ…µgetCurrentView();\n    i0.…µ…µelementStart(0, \"tr\", 5);\n    i0.…µ…µlistener(\"click\", function StocksComponent_tr_26_Template_tr_click_0_listener() {\n      const s_r2 = i0.…µ…µrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.…µ…µnextContext();\n      return i0.…µ…µresetView(ctx_r2.openStockDetails(s_r2));\n    });\n    i0.…µ…µelementStart(1, \"td\")(2, \"input\", 11);\n    i0.…µ…µtwoWayListener(\"ngModelChange\", function StocksComponent_tr_26_Template_input_ngModelChange_2_listener($event) {\n      const s_r2 = i0.…µ…µrestoreView(_r1).$implicit;\n      i0.…µ…µtwoWayBindingSet(s_r2.selected, $event) || (s_r2.selected = $event);\n      return i0.…µ…µresetView($event);\n    });\n    i0.…µ…µlistener(\"click\", function StocksComponent_tr_26_Template_input_click_2_listener($event) {\n      i0.…µ…µrestoreView(_r1);\n      return i0.…µ…µresetView($event.stopPropagation());\n    });\n    i0.…µ…µelementEnd()();\n    i0.…µ…µelementStart(3, \"td\");\n    i0.…µ…µtext(4);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(5, \"td\");\n    i0.…µ…µtext(6);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(7, \"td\");\n    i0.…µ…µtext(8);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(9, \"td\");\n    i0.…µ…µtext(10);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(11, \"td\")(12, \"button\", 5);\n    i0.…µ…µlistener(\"click\", function StocksComponent_tr_26_Template_button_click_12_listener($event) {\n      const s_r2 = i0.…µ…µrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.…µ…µnextContext();\n      ctx_r2.editStock(s_r2);\n      return i0.…µ…µresetView($event.stopPropagation());\n    });\n    i0.…µ…µtext(13, \"Edit\");\n    i0.…µ…µelementEnd()()();\n  }\n  if (rf & 2) {\n    const s_r2 = ctx.$implicit;\n    i0.…µ…µadvance(2);\n    i0.…µ…µtwoWayProperty(\"ngModel\", s_r2.selected);\n    i0.…µ…µadvance(2);\n    i0.…µ…µtextInterpolate(s_r2.consignmentNumber);\n    i0.…µ…µadvance(2);\n    i0.…µ…µtextInterpolate(s_r2.consignor);\n    i0.…µ…µadvance(2);\n    i0.…µ…µtextInterpolate(s_r2.deliveryAddress);\n    i0.…µ…µadvance(2);\n    i0.…µ…µtextInterpolate((s_r2.products == null ? null : s_r2.products.length) || 0);\n  }\n}\nfunction StocksComponent_div_27_li_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementStart(0, \"li\");\n    i0.…µ…µtext(1);\n    i0.…µ…µelementEnd();\n  }\n  if (rf & 2) {\n    const p_r5 = ctx.$implicit;\n    i0.…µ…µadvance();\n    i0.…µ…µtextInterpolate2(\" \", p_r5.name, \" (Qty: \", p_r5.quantity, \") \");\n  }\n}\nfunction StocksComponent_div_27_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.…µ…µgetCurrentView();\n    i0.…µ…µelementStart(0, \"div\", 12)(1, \"div\", 13)(2, \"span\", 14);\n    i0.…µ…µlistener(\"click\", function StocksComponent_div_27_Template_span_click_2_listener() {\n      i0.…µ…µrestoreView(_r4);\n      const ctx_r2 = i0.…µ…µnextContext();\n      return i0.…µ…µresetView(ctx_r2.closeStockDetails());\n    });\n    i0.…µ…µtext(3, \"\\u00D7\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(4, \"h2\");\n    i0.…µ…µtext(5, \"Stock Details\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(6, \"div\", 15)(7, \"p\")(8, \"strong\");\n    i0.…µ…µtext(9, \"Consignment No.:\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µtext(10);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(11, \"p\")(12, \"strong\");\n    i0.…µ…µtext(13, \"Consignor:\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µtext(14);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(15, \"p\")(16, \"strong\");\n    i0.…µ…µtext(17, \"Consignee:\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µtext(18);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(19, \"p\")(20, \"strong\");\n    i0.…µ…µtext(21, \"Delivery Address:\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µtext(22);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(23, \"p\")(24, \"strong\");\n    i0.…µ…µtext(25, \"Date:\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µtext(26);\n    i0.…µ…µpipe(27, \"date\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(28, \"p\")(29, \"strong\");\n    i0.…µ…µtext(30, \"No. of Products:\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µtext(31);\n    i0.…µ…µelementEnd()();\n    i0.…µ…µelementStart(32, \"h3\");\n    i0.…µ…µtext(33, \"Products\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(34, \"ul\");\n    i0.…µ…µtemplate(35, StocksComponent_div_27_li_35_Template, 2, 2, \"li\", 16);\n    i0.…µ…µelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.…µ…µnextContext();\n    i0.…µ…µadvance(10);\n    i0.…µ…µtextInterpolate1(\" \", ctx_r2.selectedStock.consignmentNumber, \"\");\n    i0.…µ…µadvance(4);\n    i0.…µ…µtextInterpolate1(\" \", ctx_r2.selectedStock.consignor, \"\");\n    i0.…µ…µadvance(4);\n    i0.…µ…µtextInterpolate1(\" \", ctx_r2.selectedStock.consignee, \"\");\n    i0.…µ…µadvance(4);\n    i0.…µ…µtextInterpolate1(\" \", ctx_r2.selectedStock.deliveryAddress, \"\");\n    i0.…µ…µadvance(4);\n    i0.…µ…µtextInterpolate1(\" \", i0.…µ…µpipeBind2(27, 7, ctx_r2.selectedStock.date, \"short\"), \"\");\n    i0.…µ…µadvance(5);\n    i0.…µ…µtextInterpolate1(\" \", (ctx_r2.selectedStock.products == null ? null : ctx_r2.selectedStock.products.length) || 0, \"\");\n    i0.…µ…µadvance(4);\n    i0.…µ…µproperty(\"ngForOf\", ctx_r2.selectedStock.products);\n  }\n}\nfunction StocksComponent_div_28_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.…µ…µgetCurrentView();\n    i0.…µ…µelementStart(0, \"div\", 12)(1, \"div\", 13)(2, \"h3\");\n    i0.…µ…µtext(3, \"Edit Stock\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(4, \"label\");\n    i0.…µ…µtext(5, \"Consignment No:\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(6, \"p\");\n    i0.…µ…µtext(7, \"editingStock.consignmentNumber\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(8, \"label\");\n    i0.…µ…µtext(9, \"Status:\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(10, \"input\", 17);\n    i0.…µ…µtwoWayListener(\"ngModelChange\", function StocksComponent_div_28_Template_input_ngModelChange_10_listener($event) {\n      i0.…µ…µrestoreView(_r6);\n      const ctx_r2 = i0.…µ…µnextContext();\n      i0.…µ…µtwoWayBindingSet(ctx_r2.editingStock.shipmentStatus, $event) || (ctx_r2.editingStock.shipmentStatus = $event);\n      return i0.…µ…µresetView($event);\n    });\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(11, \"label\");\n    i0.…µ…µtext(12, \"Consignor:\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(13, \"input\", 17);\n    i0.…µ…µtwoWayListener(\"ngModelChange\", function StocksComponent_div_28_Template_input_ngModelChange_13_listener($event) {\n      i0.…µ…µrestoreView(_r6);\n      const ctx_r2 = i0.…µ…µnextContext();\n      i0.…µ…µtwoWayBindingSet(ctx_r2.editingStock.consignor, $event) || (ctx_r2.editingStock.consignor = $event);\n      return i0.…µ…µresetView($event);\n    });\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(14, \"label\");\n    i0.…µ…µtext(15, \"Delivery Address:\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(16, \"input\", 17);\n    i0.…µ…µtwoWayListener(\"ngModelChange\", function StocksComponent_div_28_Template_input_ngModelChange_16_listener($event) {\n      i0.…µ…µrestoreView(_r6);\n      const ctx_r2 = i0.…µ…µnextContext();\n      i0.…µ…µtwoWayBindingSet(ctx_r2.editingStock.deliveryAddress, $event) || (ctx_r2.editingStock.deliveryAddress = $event);\n      return i0.…µ…µresetView($event);\n    });\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(17, \"button\", 5);\n    i0.…µ…µlistener(\"click\", function StocksComponent_div_28_Template_button_click_17_listener() {\n      i0.…µ…µrestoreView(_r6);\n      const ctx_r2 = i0.…µ…µnextContext();\n      return i0.…µ…µresetView(ctx_r2.saveStockEdit());\n    });\n    i0.…µ…µtext(18, \"Save\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(19, \"button\", 5);\n    i0.…µ…µlistener(\"click\", function StocksComponent_div_28_Template_button_click_19_listener() {\n      i0.…µ…µrestoreView(_r6);\n      const ctx_r2 = i0.…µ…µnextContext();\n      return i0.…µ…µresetView(ctx_r2.cancelEdit());\n    });\n    i0.…µ…µtext(20, \"Cancel\");\n    i0.…µ…µelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.…µ…µnextContext();\n    i0.…µ…µadvance(10);\n    i0.…µ…µtwoWayProperty(\"ngModel\", ctx_r2.editingStock.shipmentStatus);\n    i0.…µ…µadvance(3);\n    i0.…µ…µtwoWayProperty(\"ngModel\", ctx_r2.editingStock.consignor);\n    i0.…µ…µadvance(3);\n    i0.…µ…µtwoWayProperty(\"ngModel\", ctx_r2.editingStock.deliveryAddress);\n  }\n}\nexport let StocksComponent = /*#__PURE__*/(() => {\n  class StocksComponent {\n    constructor(http) {\n      this.http = http;\n      this.stocks = [];\n      this.filteredStocks = [];\n      this.searchText = '';\n      this.filterDate = '';\n      this.filterConsignor = '';\n      this.selectedStock = null;\n      this.editingStock = null; // ‚úÖ track which stock is being edited\n    }\n    ngOnInit() {\n      this.loadStocks();\n    }\n    loadStocks() {\n      const email = localStorage.getItem('email');\n      this.http.get(`http://localhost:3000/api/newshipments?email=${email}`).subscribe({\n        next: res => {\n          // filter only INSTOCK shipments\n          this.stocks = res.filter(s => s.shipmentStatus === 'INSTOCK');\n          console.log(this.stocks);\n          this.filteredStocks = [...this.stocks];\n        },\n        error: err => console.error('‚ùå Error loading stocks:', err)\n      });\n    }\n    applyFilters() {\n      this.filteredStocks = this.stocks.filter(s => (this.searchText ? s.consignmentNumber?.includes(this.searchText) || s.consignor?.includes(this.searchText) : true) && (this.filterDate ? new Date(s.date).toISOString().split('T')[0] === this.filterDate : true) && (this.filterConsignor ? s.consignor?.toLowerCase().includes(this.filterConsignor.toLowerCase()) : true));\n    }\n    toggleAllSelection(event) {\n      const checked = event.target.checked;\n      this.filteredStocks.forEach(s => s.selected = checked);\n    }\n    manifestSelected() {\n      const selected = this.filteredStocks.filter(s => s.selected);\n      console.log('üöÄ Manifest selected stocks:', selected);\n      // later implement API call\n    }\n    openStockDetails(stock) {\n      this.selectedStock = stock;\n    }\n    closeStockDetails() {\n      this.selectedStock = null;\n    }\n    editStock(stock) {\n      console.log('‚úèÔ∏è Edit stock:', stock);\n      this.editingStock = {\n        ...stock\n      }; // ‚úÖ copy so we don‚Äôt mutate directly\n    }\n    saveStockEdit() {\n      if (!this.editingStock) return;\n      this.http.put(`http://localhost:3000/api/newshipments/${this.editingStock._id}`, this.editingStock).subscribe({\n        next: () => {\n          console.log('‚úÖ Stock updated');\n          this.loadStocks(); // reload updated data\n          this.editingStock = null; // close modal\n        },\n        error: err => console.error('‚ùå Error updating stock:', err)\n      });\n    }\n    cancelEdit() {\n      this.editingStock = null;\n    }\n    static {\n      this.…µfac = function StocksComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || StocksComponent)(i0.…µ…µdirectiveInject(i1.HttpClient));\n      };\n    }\n    static {\n      this.…µcmp = /*@__PURE__*/i0.…µ…µdefineComponent({\n        type: StocksComponent,\n        selectors: [[\"app-stocks\"]],\n        standalone: true,\n        features: [i0.…µ…µStandaloneFeature],\n        decls: 29,\n        vars: 6,\n        consts: [[1, \"stocks-container\"], [1, \"filters\"], [\"type\", \"text\", \"placeholder\", \"Search by consignment no. or consignor\", 3, \"ngModelChange\", \"input\", \"ngModel\"], [\"type\", \"date\", 3, \"ngModelChange\", \"change\", \"ngModel\"], [\"type\", \"text\", \"placeholder\", \"Filter by consignor\", 3, \"ngModelChange\", \"input\", \"ngModel\"], [3, \"click\"], [1, \"actions\"], [1, \"stocks-table\"], [\"type\", \"checkbox\", 3, \"change\"], [3, \"click\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"modal\", 4, \"ngIf\"], [\"type\", \"checkbox\", 3, \"ngModelChange\", \"click\", \"ngModel\"], [1, \"modal\"], [1, \"modal-content\"], [1, \"close\", 3, \"click\"], [1, \"stock-details\"], [4, \"ngFor\", \"ngForOf\"], [3, \"ngModelChange\", \"ngModel\"]],\n        template: function StocksComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.…µ…µelementStart(0, \"div\", 0)(1, \"h2\");\n            i0.…µ…µtext(2, \"Stocks\");\n            i0.…µ…µelementEnd();\n            i0.…µ…µelementStart(3, \"div\", 1)(4, \"input\", 2);\n            i0.…µ…µtwoWayListener(\"ngModelChange\", function StocksComponent_Template_input_ngModelChange_4_listener($event) {\n              i0.…µ…µtwoWayBindingSet(ctx.searchText, $event) || (ctx.searchText = $event);\n              return $event;\n            });\n            i0.…µ…µlistener(\"input\", function StocksComponent_Template_input_input_4_listener() {\n              return ctx.applyFilters();\n            });\n            i0.…µ…µelementEnd();\n            i0.…µ…µelementStart(5, \"input\", 3);\n            i0.…µ…µtwoWayListener(\"ngModelChange\", function StocksComponent_Template_input_ngModelChange_5_listener($event) {\n              i0.…µ…µtwoWayBindingSet(ctx.filterDate, $event) || (ctx.filterDate = $event);\n              return $event;\n            });\n            i0.…µ…µlistener(\"change\", function StocksComponent_Template_input_change_5_listener() {\n              return ctx.applyFilters();\n            });\n            i0.…µ…µelementEnd();\n            i0.…µ…µelementStart(6, \"input\", 4);\n            i0.…µ…µtwoWayListener(\"ngModelChange\", function StocksComponent_Template_input_ngModelChange_6_listener($event) {\n              i0.…µ…µtwoWayBindingSet(ctx.filterConsignor, $event) || (ctx.filterConsignor = $event);\n              return $event;\n            });\n            i0.…µ…µlistener(\"input\", function StocksComponent_Template_input_input_6_listener() {\n              return ctx.applyFilters();\n            });\n            i0.…µ…µelementEnd();\n            i0.…µ…µelementStart(7, \"button\", 5);\n            i0.…µ…µlistener(\"click\", function StocksComponent_Template_button_click_7_listener() {\n              return ctx.manifestSelected();\n            });\n            i0.…µ…µtext(8, \"Manifestation\");\n            i0.…µ…µelementEnd()();\n            i0.…µ…µelement(9, \"div\", 6);\n            i0.…µ…µelementStart(10, \"table\", 7)(11, \"thead\")(12, \"tr\")(13, \"th\")(14, \"input\", 8);\n            i0.…µ…µlistener(\"change\", function StocksComponent_Template_input_change_14_listener($event) {\n              return ctx.toggleAllSelection($event);\n            });\n            i0.…µ…µelementEnd()();\n            i0.…µ…µelementStart(15, \"th\");\n            i0.…µ…µtext(16, \"Consignment No.\");\n            i0.…µ…µelementEnd();\n            i0.…µ…µelementStart(17, \"th\");\n            i0.…µ…µtext(18, \"Consignor\");\n            i0.…µ…µelementEnd();\n            i0.…µ…µelementStart(19, \"th\");\n            i0.…µ…µtext(20, \"Delivery Address\");\n            i0.…µ…µelementEnd();\n            i0.…µ…µelementStart(21, \"th\");\n            i0.…µ…µtext(22, \"No. of Products\");\n            i0.…µ…µelementEnd();\n            i0.…µ…µelementStart(23, \"th\");\n            i0.…µ…µtext(24, \"Actions\");\n            i0.…µ…µelementEnd()()();\n            i0.…µ…µelementStart(25, \"tbody\");\n            i0.…µ…µtemplate(26, StocksComponent_tr_26_Template, 14, 5, \"tr\", 9);\n            i0.…µ…µelementEnd()()();\n            i0.…µ…µtemplate(27, StocksComponent_div_27_Template, 36, 10, \"div\", 10)(28, StocksComponent_div_28_Template, 21, 3, \"div\", 10);\n          }\n          if (rf & 2) {\n            i0.…µ…µadvance(4);\n            i0.…µ…µtwoWayProperty(\"ngModel\", ctx.searchText);\n            i0.…µ…µadvance();\n            i0.…µ…µtwoWayProperty(\"ngModel\", ctx.filterDate);\n            i0.…µ…µadvance();\n            i0.…µ…µtwoWayProperty(\"ngModel\", ctx.filterConsignor);\n            i0.…µ…µadvance(20);\n            i0.…µ…µproperty(\"ngForOf\", ctx.filteredStocks);\n            i0.…µ…µadvance();\n            i0.…µ…µproperty(\"ngIf\", ctx.selectedStock);\n            i0.…µ…µadvance();\n            i0.…µ…µproperty(\"ngIf\", ctx.editingStock);\n          }\n        },\n        dependencies: [CommonModule, i2.NgForOf, i2.NgIf, i2.DatePipe, FormsModule, i3.DefaultValueAccessor, i3.CheckboxControlValueAccessor, i3.NgControlStatus, i3.NgModel],\n        styles: [\".stocks-container[_ngcontent-%COMP%]{padding:20px}.filters[_ngcontent-%COMP%]{display:flex;gap:10px;margin-bottom:15px}.stocks-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.stocks-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .stocks-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ccc;padding:8px;text-align:left}.stocks-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9f9f9;cursor:pointer}.actions[_ngcontent-%COMP%]{margin-top:15px}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0009;display:flex;align-items:center;justify-content:center}.modal-content[_ngcontent-%COMP%]{background:#fff;padding:20px;width:500px;max-height:80vh;overflow-y:auto;border-radius:8px;position:relative}.close[_ngcontent-%COMP%]{position:absolute;right:15px;top:10px;font-size:24px;cursor:pointer}\"]\n      });\n    }\n  }\n  return StocksComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}