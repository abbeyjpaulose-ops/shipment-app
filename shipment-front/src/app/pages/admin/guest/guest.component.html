<div class="guests-container">
  <h2>Manage Guests</h2>

  <!-- Add Guest Button -->
  <button class="add-guest-btn" type="button" (click)="openAddGuestPopup()">+ Add Guest</button>

  <!-- Add Guest Popup -->
  <div class="modal" *ngIf="showAddGuestPopup">
    <div class="modal-content">
      <span class="close" (click)="closeAddGuestPopup()">&times;</span>
      <h3>Add Guest</h3>
      <div class="add-guest-form">
        <input [(ngModel)]="newGuest.guestName" placeholder="Guest Name" required>
        <input [(ngModel)]="newGuest.address" placeholder="Address" required>
        <input [(ngModel)]="newGuest.city" placeholder="City">
        <input [(ngModel)]="newGuest.state" placeholder="State">
        <input [(ngModel)]="newGuest.pinCode" placeholder="Pin Code">
        <input [(ngModel)]="newGuest.phoneNum" placeholder="Contact Number" required>
        <input [(ngModel)]="newGuest.perDis" placeholder="% of Discount" required>
        <button type="button" (click)="addGuest()">+ Add Guest</button>
      </div>
    </div>
  </div>

  <!-- Guests List -->
  <div class="guests-table-wrapper">
    <table>
      <tr>
        <th>Guest Name</th>
        <th>Address</th>
        <th>City</th>
        <th>State</th>
        <th>Pin</th>
        <th>Contact Number</th>
        <th>% of Discount</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
      <tr *ngFor="let b of guests">
        <!-- Guest Name -->
        <td>
          <span *ngIf="editingGuest?._id !== b._id">{{ b.guestName }}</span>
          <div *ngIf="editingGuest?._id === b._id" class="edit-field">
            <input [(ngModel)]="editingGuest.guestName">
          </div>
        </td>

        <!-- Address -->
        <td>
          <span *ngIf="editingGuest?._id !== b._id">{{ b.address }}</span>
          <div *ngIf="editingGuest?._id === b._id" class="edit-field">
            <input [(ngModel)]="editingGuest.address">
          </div>
        </td>

        <!-- City -->
        <td>
          <span *ngIf="editingGuest?._id !== b._id">{{ b.city }}</span>
          <div *ngIf="editingGuest?._id === b._id" class="edit-field">
            <input [(ngModel)]="editingGuest.city">
          </div>
        </td>

        <!-- State -->
        <td>
          <span *ngIf="editingGuest?._id !== b._id">{{ b.state }}</span>
          <div *ngIf="editingGuest?._id === b._id" class="edit-field">
            <input [(ngModel)]="editingGuest.state">
          </div>
        </td>

        <!-- Pin Code -->
        <td>
          <span *ngIf="editingGuest?._id !== b._id">{{ b.pinCode }}</span>
          <div *ngIf="editingGuest?._id === b._id" class="edit-field">
            <input [(ngModel)]="editingGuest.pinCode">
          </div>
        </td>

        <!-- phoneNum -->
        <td>
          <span *ngIf="editingGuest?._id !== b._id">{{ b.phoneNum }}</span>
          <div *ngIf="editingGuest?._id === b._id" class="edit-field">
            <input [(ngModel)]="editingGuest.phoneNum">
          </div>
        </td>

        <!-- % of Discount -->
        <td>
          <span *ngIf="editingGuest?._id !== b._id">{{ b.perDis }}</span>
          <div *ngIf="editingGuest?._id === b._id" class="edit-field">
            <input [(ngModel)]="editingGuest.perDis">
          </div>
        </td>

        <!-- Status -->
        <td>
          <button (click)="toggleStatus(b)">
            {{ b.status === 'active' ? 'Deactivate' : 'Activate' }}
          </button>
        </td>

        <!-- Actions -->
        <td>
          <button *ngIf="editingGuest?._id !== b._id" (click)="editGuest(b)">Edit</button>
          <button *ngIf="editingGuest?._id === b._id" (click)="saveEdit()">Save</button>
        </td>
      </tr>
    </table>
  </div>
</div>
