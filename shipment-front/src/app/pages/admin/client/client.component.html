<div class="clients-container">
  <h2>Manage Clients</h2>

  <!-- Add Client Form -->
  <div class="add-client-form">
    <input [(ngModel)]="newClient.clientName" placeholder="Client Name" required>
    <input [(ngModel)]="newClient.address" placeholder="Address" required>
    <input [(ngModel)]="newClient.city" placeholder="City">
    <input [(ngModel)]="newClient.state" placeholder="State">
    <input [(ngModel)]="newClient.pinCode" placeholder="Pin Code">
    <input [(ngModel)]="newClient.GSTIN" placeholder="GSTIN" required>
    <input [(ngModel)]="newClient.phoneNum" placeholder="Contact Number" required>
    <input [(ngModel)]="newClient.perDis" placeholder="% of Discount" required>

    <!-- NEW Credit Type Field -->
    <select [(ngModel)]="newClient.creditType" class="small-select">
      <option value="no-credit">No Credit</option>
      <option value="credit">Credit Allowed</option>
    </select>


    <button (click)="addClient()">+ Add Client</button>
  </div>

  <!-- Clients List -->
  <div class="clients-table-wrapper">
    <table>
      <tr>
        <th>Client Name</th>
        <th>Address</th>
        <th>City</th>
        <th>State</th>
        <th>Pin</th>
        <th>GSTIN</th>
        <th>Contact Number</th>
        <th>% Discount</th>
        <th>Credit Type</th> <!-- ðŸ”¹ New Column -->
        <th>Status</th>
        <th>Actions</th>
      </tr>

      <tr *ngFor="let b of clients">

        <!-- Client Name -->
        <td>
          <span *ngIf="editingClient?._id !== b._id">{{ b.clientName }}</span>
          <div *ngIf="editingClient?._id === b._id" class="edit-field">
            <input [(ngModel)]="editingClient.clientName">
          </div>
        </td>

        <!-- Address -->
        <td>
          <span *ngIf="editingClient?._id !== b._id">{{ b.address }}</span>
          <div *ngIf="editingClient?._id === b._id" class="edit-field">
            <input [(ngModel)]="editingClient.address">
          </div>
        </td>

        <!-- City -->
        <td>
          <span *ngIf="editingClient?._id !== b._id">{{ b.city }}</span>
          <div *ngIf="editingClient?._id === b._id" class="edit-field">
            <input [(ngModel)]="editingClient.city">
          </div>
        </td>

        <!-- State -->
        <td>
          <span *ngIf="editingClient?._id !== b._id">{{ b.state }}</span>
          <div *ngIf="editingClient?._id === b._id" class="edit-field">
            <input [(ngModel)]="editingClient.state">
          </div>
        </td>

        <!-- Pin Code -->
        <td>
          <span *ngIf="editingClient?._id !== b._id">{{ b.pinCode }}</span>
          <div *ngIf="editingClient?._id === b._id" class="edit-field">
            <input [(ngModel)]="editingClient.pinCode">
          </div>
        </td>

        <!-- GSTIN -->
        <td>
          <span *ngIf="editingClient?._id !== b._id">{{ b.GSTIN }}</span>
          <div *ngIf="editingClient?._id === b._id" class="edit-field">
            <input [(ngModel)]="editingClient.GSTIN">
          </div>
        </td>

        <!-- Contact Number -->
        <td>
          <span *ngIf="editingClient?._id !== b._id">{{ b.phoneNum }}</span>
          <div *ngIf="editingClient?._id === b._id" class="edit-field">
            <input [(ngModel)]="editingClient.phoneNum">
          </div>
        </td>

        <!-- % of Discount -->
        <td>
          <span *ngIf="editingClient?._id !== b._id">{{ b.perDis }}</span>
          <div *ngIf="editingClient?._id === b._id" class="edit-field">
            <input [(ngModel)]="editingClient.perDis">
          </div>
        </td>

        <!-- CREDIT TOGGLE BUTTON -->
        <td>
          <button 
          (click)="toggleCreditType(b)"
          [ngClass]="b.creditType === 'credit' ? 'credit-active' : 'credit-inactive'">
          {{ b.creditType === 'credit' ? 'Credit âœ”' : 'No Credit' }}
        </button>
      </td>


      <!-- STATUS TOGGLE BUTTON -->
      <td>
        <button 
        (click)="toggleStatus(b)"
        [ngClass]="b.status === 'active' ? 'status-active' : 'status-inactive'">
        {{ b.status === 'active' ? 'Active' : 'Deactivated' }}
      </button>
    </td>


        <!-- Actions -->
        <td>
          <button *ngIf="editingClient?._id !== b._id" (click)="editClient(b)">Edit</button>
          <button *ngIf="editingClient?._id === b._id" (click)="saveEdit()">Save</button>
        </td>

      </tr>
    </table>
  </div>
</div>
