<div class="form-container">
  <h2>New Shipment</h2>

  <!-- 1. Basic Details -->
  <section>
    <h3>1. Basic Details</h3>
    <div class="grid-2">
      <label>E-Waybill Number <input [(ngModel)]="ewaybillNumber"></label>
      <label>Consignment Number* <input [(ngModel)]="consignmentNumber" readonly></label>
      <label>Date* <input type="date" [(ngModel)]="date"></label>
    </div>
  </section>


  <!-- 2. Consignment & Payment Mode -->
  <section>
  <h3>2. Consignment & Payment Mode</h3>
  <div class="grid-2">

    <!-- Consignor Tabs -->
    <div class="tab-container">
      <div class="tabs">
        <button (click)="consignorTab = 'consignor'" [class.active]="consignorTab === 'consignor'">Consignor</button>
        <button (click)="consignorTab = 'guest'" [class.active]="consignorTab === 'guest'">Guest</button>
      </div>

      <div class="tab-content">
        <div *ngIf="consignorTab === 'consignor'">        
          <label>Consignor 
            <select [(ngModel)]="consignor" (change)="onConsignorSelect(consignor)">
              <option *ngFor="let client of clientList" [value]="client.clientName">{{ client.clientName }}, {{ client.address }}</option>
            </select>
          </label>
          <label>Consignor GSTIN <input [(ngModel)]="consignorGST" readonly></label>
          <label>Consignor Address <input [(ngModel)]="consignorAddress" readonly></label>
          <label>Consignor Phone <input [(ngModel)]="consignorPhone" readonly></label>
        </div>
        <div *ngIf="consignorTab === 'guest'">
          <label>Guest Sender Name
            <select [(ngModel)]="consignor" (change)="onConsignorGuestSelect(consignor)">
              <option *ngFor="let guest of guestList" [value]="guest.guestName">{{ guest.guestName }}, {{ guest.address }}</option>
            </select>
          </label>
          <label>Sender Address <input [(ngModel)]="consignorAddress" readonly></label>
          <label>Sender Phone Number <input [(ngModel)]="consignorPhone" readonly></label>
          
        </div>
      </div>
    </div>

    <!-- Consignee Tabs -->
    <div class="tab-container">
      <div class="tabs">
        <button (click)="consigneeTab = 'consignee'" [class.active]="consigneeTab === 'consignee'">Consignee</button>
        <button (click)="consigneeTab = 'guest'" [class.active]="consigneeTab === 'guest'">Guest</button>
      </div>

      <div class="tab-content">
        <div *ngIf="consigneeTab === 'consignee'">
          <label>Consignee 
            <select [(ngModel)]="consignee" (change)="onConsigneeSelect(consignee)">
              <option *ngFor="let client of clientList" [value]="client.clientName">{{ client.clientName }}, {{ client.address }}</option>
            </select>
          </label>
          <label>Consignee GSTIN <input [(ngModel)]="consigneeGST" readonly></label>
          <label>Consignee Address <input [(ngModel)]="consigneeAddress" readonly></label>
          <label>Consignee Phone <input [(ngModel)]="consigneePhone" readonly></label>
        </div>
        <div *ngIf="consigneeTab === 'guest'">
          <label>Guest Reciever Name
            <select [(ngModel)]="consignee" (change)="onConsigneeGuestSelect(consignee)">
              <option *ngFor="let guest of guestList" [value]="guest.guestName">{{ guest.guestName }}, {{ guest.address }}</option>
            </select>
          </label>
          <label>Reciever Address <input [(ngModel)]="consigneeAddress" readonly></label>
          <label>Reciever Phone <input [(ngModel)]="consigneePhone" readonly></label>
        </div>
      </div>
    </div>

    <!-- Payment Mode -->
    <label>Payment Mode
      <select [(ngModel)]="paymentMode">
        <option>Account Credit</option>
        <option>Paid</option>
        <option>To Pay</option>
      </select>
    </label>

    <label>External Ref Id <input [(ngModel)]="externalRefId"></label>
  </div>
  
</section>
<section>
  <h3>3. Address Details</h3>
  <div class="grid-1">

    <!-- Billing Address -->
    <div class="address-section">
      <h4>Billing Address</h4>
      <label>
        <input type="radio" name="billing" value="consignor" [(ngModel)]="billingType">
        Consignor's GST Address
      </label>
      <label>
        <input type="radio" name="billing" value="different" [(ngModel)]="billingType">
        Assigner / Different Address
      </label>

      <!-- Autofill if Consignor GST Address -->
      <div *ngIf="billingType === 'consignor'">
        <p><strong>Consignor Address:</strong><br>Name:{{ consignor }}<br>Address:{{ consignorAddress }}</p>
      </div>

      <!-- Manual Entry if Different Address -->
      <div *ngIf="billingType === 'different'">
        <label>Billing Name <input [(ngModel)]="billingName"></label>
        <label>Billing GSTIN <input [(ngModel)]="billingGSTIN"></label>
        <label>Billing Address <textarea [(ngModel)]="billingAddress"></textarea></label>
      </div>
    </div>

    <!-- Pickup Address -->
    <div class="address-section">
      <h4>Pickup Address</h4>
      <label>
        <input type="radio" name="pickup" value="consignor" [(ngModel)]="pickupType">
        Consignor Address
      </label>
      <label>
        <input type="radio" name="pickup" value="different" [(ngModel)]="pickupType">
        Different Address
      </label>

      <div *ngIf="pickupType === 'consignor'">
        <p><strong>Consignor Address:</strong><br>Name:{{ consignor }}<br>Address:{{ consignorAddress }}</p>
      </div>

      <div *ngIf="pickupType === 'different'">
        <label>Pickup Name <input [(ngModel)]="pickupName"></label>
        <label>Pickup Address <textarea [(ngModel)]="pickupAddress"></textarea></label>
      </div>
    </div>

    <!-- Delivery Address -->
    <div class="address-section">
      <h4>Delivery Address</h4>
      <label>
        <input type="radio" name="delivery" value="consignee" [(ngModel)]="deliveryType">
        Consignee Address
      </label>
      <label>
        <input type="radio" name="delivery" value="different" [(ngModel)]="deliveryType">
        Different Address
      </label>

      <div *ngIf="deliveryType === 'consignee'">
        <p><strong>Consignee Address:</strong><br>Name:{{ consignee }}<br>Address:{{ consigneeAddress }}</p>
      </div>

      <div *ngIf="deliveryType === 'different'">
        <label>Delivery Name <input [(ngModel)]="deliveryName"></label>
        <label>Delivery Address <textarea [(ngModel)]="deliveryAddress"></textarea></label>
      </div>
    </div>

  </div>
</section>

  <!-- 4. Invoice Details -->
  <section>
    <h3>4. Invoice Details</h3>
    <div *ngFor="let invoice of invoices; let i=index" class="grid-3">
      <input placeholder="Invoice Number" [(ngModel)]="invoice.number">
      <input placeholder="Invoice Value" type="number" [(ngModel)]="invoice.value">
      <button type="button" (click)="deleteInvoice(i)">üóëÔ∏è Delete</button>
    </div>
    <button type="button" (click)="addInvoice()">+ Add Invoice</button>
  </section>

  <!-- 5. Package Details -->
<section>
  <h3>5. Package Details</h3>
  <div *ngFor="let pkg of packages; let i = index" class="grid-4">
    <select [(ngModel)]="pkg.pkgName" (change)="onPackageList(pkg.pkgName)">
      <option *ngFor="let pkgItem of pkgList" [value]="pkgItem.pkgName">{{ pkgItem.pkgName }}</option>
    </select>
    <input placeholder="Amount*" type="number" [(ngModel)]="pkg.amount">
    <button type="button" (click)="deletePackage(i)">üóëÔ∏è Delete</button>
  </div>
  <button type="button" (click)="addPackage()">+ Add Package</button>
</section>

<!-- 6. Product Details -->
<section>
  <h3>5. Product Details</h3>
  <div *ngFor="let product of products; let i = index" class="grid-4">
    <select [(ngModel)]="product.productName" (change)="onPackageList(product.productName)">
      <option *ngFor="let productItem of productList" [value]="productItem.productName">{{ productItem.hsnNum }}-{{ productItem.productName }}</option>
    </select>
    <input placeholder="Amount*" type="number" [(ngModel)]="product.amount">
    <button type="button" (click)="deleteProduct(i)">üóëÔ∏è Delete</button>
  </div>
  <button type="button" (click)="addProduct()">+ Add Product</button>
</section>

  <!-- 6. Charges -->
  <section>
    <h3>6. Charges</h3>
    <div class="grid-3">
      <label>ODC<input placeholder="ODC" type="number" [(ngModel)]="charges.odc"></label>
      <label>Unloading Charges<input placeholder="Unloading" type="number" [(ngModel)]="charges.unloading"></label>
      <label>Docket Charges<input placeholder="Docket" type="number" [(ngModel)]="charges.docket"></label>
      <label>Other Expenses<input placeholder="Other Expenses" type="number" [(ngModel)]="charges.other"></label>
      <label>CCC<input placeholder="CCC" type="number" [(ngModel)]="charges.ccc"></label>
      <label>Final Amount <input type="number" [(ngModel)]="finalAmount"></label>
    </div>
  </section>

  <!-- Buttons -->
  <div class="actions">
    <button type="button" (click)="calculateFinalAmount()">Calculate</button>
    <button type="button" (click)="resetForm()">Reset</button>
    <button type="button" (click)="saveShipment()">Save</button>
  </div>
</div>
